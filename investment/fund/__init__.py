# encoding: utf-8
import logging
from datetime import date, timedelta
from fundrank import get_fund_detail_list, fund_ranking_summary
from monitor import Linear_Regression

finally_funds = [{'code': '001704', 'name': '国投瑞银进宝灵活配置混合', 2016: -0.69, 2017: 5.88, 2018: -24.41, 2019: 85.51, 2020: 92.43, 2021: 95.13, '3y': 548.27, '5y': 436.41, 'fundScale': '4.10亿'}, {'code': '000828', 'name': '泰达转型机遇股票A', 2016: -13.72, 2017: 12.1, 2018: -24.1, 2019: 71.23, 2020: 104.9, 2021: 66.13, '3y': 455.26, '5y': 341.98, 'fundScale': '15.54亿'}, {'code': '000209', 'name': '信诚新兴产业混合A', 2016: -28.06, 2017: -12.7, 2018: -30.47, 2019: 42.03, 2020: 102.88, 2021: 102.33, '3y': 422.17, '5y': 237.96, 'fundScale': '15.18亿'}, {'code': '002190', 'name': '农银新能源主题', 2016: -1.81, 2017: 22.07, 2018: -34.41, 2019: 34.63, 2020: 163.49, 2021: 54.13, '3y': 413.88, '5y': 334.29, 'fundScale': '199.01亿'}, {'code': '001298', 'name': '金鹰民族新兴混合', 2016: -1.76, 2017: 7.76, 2018: -22.71, 2019: 44.92, 2020: 88.62, 2021: 89.69, '3y': 408.2, '5y': 333.57, 'fundScale': '3.95亿'}, {'code': '001245', 'name': '工银生态环境股票', 2016: -14.33, 2017: -12.23, 2018: -30.56, 2019: 48.07, 2020: 122.51, 2021: 64.45, '3y': 404.63, '5y': 226.16, 'fundScale': '18.00亿'}, {'code': '001643', 'name': '汇丰晋信智造先锋股票A', 2016: -5.9, 2017: 7.45, 2018: -27.16, 2019: 73.88, 2020: 128.65, 2021: 43.13, '3y': 401.91, '5y': 344.98, 'fundScale': '20.97亿'}, {'code': '001644', 'name': '汇丰晋信智造先锋股票C', 2016: -6.44, 2017: 7.06, 2018: -27.52, 2019: 73.12, 2020: 127.52, 2021: 42.62, '3y': 394.84, '5y': 334.81, 'fundScale': '12.35亿'}, {'code': '090018', 'name': '大成新锐产业混合', 2016: 8.9, 2017: -0.82, 2018: -14.65, 2019: 47.43, 2020: 79.41, 2021: 88.25, '3y': 367.45, '5y': 243.2, 'fundScale': '42.13亿'}, {'code': '002669', 'name': '华商万众创新混合', 2016: -2.4, 2017: -19.06, 2018: -21.27, 2019: 68.81, 2020: 116.67, 2021: 36.13, '3y': 361.55, '5y': 215.06, 'fundScale': '19.76亿'}, {'code': '001606', 'name': '农银工业4.0混合', 2016: -22.29, 2017: 48.2, 2018: -35.74, 2019: 37.6, 2020: 166.56, 2021: 37.59, '3y': 360.98, '5y': 373.41, 'fundScale': '55.75亿'}, {'code': '540008', 'name': '汇丰晋信低碳先锋股票A', 2016: -22.82, 2017: -3.64, 2018: -36.68, 2019: 45.87, 2020: 134.41, 2021: 52.62, '3y': 357.55, '5y': 187.86, 'fundScale': '86.69亿'}, {'code': '002083', 'name': '新华鑫动力灵活配置混合A', 2016: 0.3, 2017: 0.1, 2018: -30.98, 2019: 51.52, 2020: 121.43, 2021: 48.07, '3y': 354.17, '5y': 243.57, 'fundScale': '23.12亿'}, {'code': '002084', 'name': '新华鑫动力灵活配置混合C', 2016: 0.1, 2017: 0.1, 2018: -31.14, 2019: 51.59, 2020: 121.13, 2021: 47.96, '3y': 352.7, '5y': 242.24, 'fundScale': '14.04亿'}, {'code': '610004', 'name': '信达澳银中小盘混合', 2016: -13.13, 2017: 5.35, 2018: -15.15, 2019: 62.06, 2020: 61.94, 2021: 74.39, '3y': 346.4, '5y': 315.35, 'fundScale': '1.22亿'}, {'code': '400015', 'name': '东方新能源汽车混合', 2016: -21.17, 2017: -4.21, 2018: -20.21, 2019: 27.42, 2020: 116.3, 2021: 71.89, '3y': 344.71, '5y': 162.28, 'fundScale': '102.17亿'}, {'code': '001300', 'name': '大成睿景灵活配置混合A', 2016: -14.17, 2017: 9.08, 2018: -28.88, 2019: 43.97, 2020: 77.59, 2021: 82.52, '3y': 344.59, '5y': 249.54, 'fundScale': '12.63亿'}, {'code': '000336', 'name': '农银研究精选混合', 2016: -20.68, 2017: 3.19, 2018: -36.61, 2019: 55.94, 2020: 154.88, 2021: 39.38, '3y': 338.65, '5y': 244.54, 'fundScale': '37.45亿'}, {'code': '001156', 'name': '申万菱信新能源汽车混合', 2016: -5.88, 2017: 13.36, 2018: -25.41, 2019: 48.06, 2020: 110.76, 2021: 44.38, '3y': 335.84, '5y': 273.58, 'fundScale': '45.76亿'}, {'code': '165516', 'name': '信诚周期轮动混合(LOF)', 2016: -13.93, 2017: 13.45, 2018: -23.3, 2019: 64.45, 2020: 90.66, 2021: 54.74, '3y': 335.66, '5y': 248.5, 'fundScale': '17.62亿'}, {'code': '001301', 'name': '大成睿景灵活配置混合C', 2016: -14.85, 2017: 8.09, 2018: -29.42, 2019: 42.78, 2020: 76.31, 2021: 81.55, '3y': 334.03, '5y': 236.02, 'fundScale': '9.77亿'}, {'code': '001410', 'name': '信达澳银新能源产业股票', 2016: -5.91, 2017: 39.27, 2018: -15.81, 2019: 94.11, 2020: 59.88, 2021: 50.89, '3y': 331.96, '5y': 432.14, 'fundScale': '115.54亿'}, {'code': '481010', 'name': '工银中小盘混合', 2016: -21.86, 2017: -11.49, 2018: -25.89, 2019: 61.21, 2020: 134.73, 2021: 29.13, '3y': 331.49, '5y': 210.33, 'fundScale': '27.06亿'}, {'code': '700003', 'name': '平安策略先锋混合', 2016: -28.91, 2017: 10.72, 2018: -28.79, 2019: 75.33, 2020: 67.25, 2021: 64.8, '3y': 331.42, '5y': 248.16, 'fundScale': '1.22亿'}, {'code': '550009', 'name': '信诚中小盘混合', 2016: -27.04, 2017: 7.75, 2018: -28.61, 2019: 75.48, 2020: 86.24, 2021: 56.74, '3y': 328.86, '5y': 264.7, 'fundScale': '2.86亿'}, {'code': '166301', 'name': '华商新趋势优选灵活配置混合', 2016: -7.87, 2017: 14.63, 2018: -14.83, 2019: 69.6, 2020: 77.42, 2021: 56.71, '3y': 328.16, '5y': 366.23, 'fundScale': '12.83亿'}, {'code': '001959', 'name': '华商乐享互联灵活配置混合A', 2016: -13.29, 2017: -2.52, 2018: -39.91, 2019: 84.18, 2020: 79.96, 2021: 46.43, '3y': 325.51, '5y': 168.07, 'fundScale': '4.25亿'}, {'code': '610006', 'name': '信达澳银产业升级混合', 2016: -18.72, 2017: -5.28, 2018: -22.24, 2019: 53.23, 2020: 72.65, 2021: 78.08, '3y': 316.42, '5y': 206.56, 'fundScale': '1.87亿'}, {'code': '001702', 'name': '东方创新科技混合', 2016: -18.37, 2017: 4.76, 2018: -29.94, 2019: 56.03, 2020: 112.38, 2021: 36.08, '3y': 313.62, '5y': 206.96, 'fundScale': '17.35亿'}, {'code': '167001', 'name': '平安鼎泰混合(LOF)', 2016: -0.03, 2017: -20.12, 2018: -26.07, 2019: 41.97, 2020: 60.45, 2021: 95.33, '3y': 308.87, '5y': 162.65, 'fundScale': '0.84亿'}, {'code': '720001', 'name': '财通价值动量混合', 2016: -18.59, 2017: 15.39, 2018: -16.63, 2019: 70.96, 2020: 51.29, 2021: 61.82, '3y': 307.7, '5y': 207.97, 'fundScale': '19.34亿'}, {'code': '002168', 'name': '嘉实智能汽车股票', 2016: 24.0, 2017: 20.16, 2018: -24.83, 2019: 65.62, 2020: 93.91, 2021: 23.88, '3y': 307.69, '5y': 268.57, 'fundScale': '48.23亿'}, {'code': '000541', 'name': '华商创新成长混合发起式', 2016: -25.71, 2017: -7.38, 2018: -29.02, 2019: 66.32, 2020: 101.4, 2021: 31.8, '3y': 306.87, '5y': 122.26, 'fundScale': '10.49亿'}, {'code': '210003', 'name': '金鹰行业优势混合', 2016: -17.72, 2017: 18.98, 2018: -18.4, 2019: 42.83, 2020: 80.37, 2021: 75.12, '3y': 305.53, '5y': 286.06, 'fundScale': '3.91亿'}, {'code': '001616', 'name': '嘉实环保低碳股票', 2016: 16.5, 2017: 33.13, 2018: -32.95, 2019: 53.37, 2020: 113.67, 2021: 19.4, '3y': 302.47, '5y': 238.52, 'fundScale': '53.17亿'}, {'code': '001480', 'name': '财通成长优选混合', 2016: -25.46, 2017: 15.18, 2018: -23.06, 2019: 72.93, 2020: 48.96, 2021: 59.41, '3y': 299.6, '5y': 241.72, 'fundScale': '13.03亿'}, {'code': '001951', 'name': '金鹰改革红利混合', 2016: 7.68, 2017: 4.91, 2018: -25.44, 2019: 30.81, 2020: 99.28, 2021: 67.14, '3y': 299.24, '5y': 241.09, 'fundScale': '32.36亿'}, {'code': '000126', 'name': '招商安润混合', 2016: -4.92, 2017: 1.59, 2018: 0.59, 2019: 33.9, 2020: 97.9, 2021: 50.34, '3y': 298.78, '5y': 305.07, 'fundScale': '7.61亿'}, {'code': '001569', 'name': '泰信国策驱动灵活配置混合', 2016: -18.92, 2017: -9.36, 2018: -31.77, 2019: 63.26, 2020: 89.53, 2021: 57.27, '3y': 298.23, '5y': 200.97, 'fundScale': '1.30亿'}, {'code': '000409', 'name': '鹏华环保产业股票', 2016: -5.84, 2017: 17.36, 2018: -19.57, 2019: 34.55, 2020: 116.68, 2021: 39.7, '3y': 297.81, '5y': 278.18, 'fundScale': '17.12亿'}, {'code': '001487', 'name': '宝盈优势产业混合A', 2016: -13.08, 2017: 29.57, 2018: -22.13, 2019: 63.06, 2020: 33.84, 2021: 87.59, '3y': 296.01, '5y': 273.24, 'fundScale': '10.49亿'}, {'code': '519126', 'name': '浦银安盛新经济结构混合A', 2016: -16.73, 2017: -0.43, 2018: -35.0, 2019: 62.63, 2020: 87.55, 2021: 49.6, '3y': 295.56, '5y': 199.42, 'fundScale': '11.95亿'}, {'code': '398051', 'name': '中海环保新能源混合', 2016: -27.81, 2017: 18.78, 2018: -21.35, 2019: 29.83, 2020: 109.07, 2021: 47.97, '3y': 292.62, '5y': 263.08, 'fundScale': '16.99亿'}, {'code': '001476', 'name': '中银智能制造股票A', 2016: -28.16, 2017: 13.71, 2018: -38.98, 2019: 53.69, 2020: 109.09, 2021: 37.2, '3y': 289.59, '5y': 198.11, 'fundScale': '14.75亿'}, {'code': '001279', 'name': '中海积极增利混合', 2016: -12.41, 2017: 17.58, 2018: -30.01, 2019: 66.91, 2020: 64.18, 2021: 55.6, '3y': 285.77, '5y': 219.33, 'fundScale': '1.09亿'}, {'code': '519642', 'name': '银河智造混合', 2016: -2.0, 2017: 33.98, 2018: -27.34, 2019: 60.06, 2020: 108.84, 2021: 27.38, '3y': 281.77, '5y': 308.65, 'fundScale': '2.85亿'}, {'code': '673060', 'name': '西部利得景瑞灵活配置混合A', 2016: -0.6, 2017: -2.72, 2018: -18.72, 2019: 72.26, 2020: 63.38, 2021: 44.19, '3y': 281.67, '5y': 206.1, 'fundScale': '2.97亿'}, {'code': '160421', 'name': '华安智增精选混合', 2016: -3.23, 2017: -1.35, 2018: -21.15, 2019: 75.75, 2020: 54.97, 2021: 51.75, '3y': 281.25, '5y': 211.1, 'fundScale': '1.08亿'}, {'code': '377240', 'name': '上投摩根新兴动力混合A', 2016: -19.81, 2017: 42.21, 2018: -35.65, 2019: 70.27, 2020: 78.24, 2021: 42.92, '3y': 280.22, '5y': 274.0, 'fundScale': '63.35亿'}, {'code': '000592', 'name': '建信改革红利股票', 2016: -17.3, 2017: 26.84, 2018: -33.64, 2019: 60.75, 2020: 101.88, 2021: 34.1, '3y': 278.23, '5y': 254.34, 'fundScale': '5.90亿'}, {'code': '001716', 'name': '工银新趋势灵活配置混合A', 2016: 1.9, 2017: 17.88, 2018: -9.25, 2019: 25.8, 2020: 121.31, 2021: 34.14, '3y': 276.23, '5y': 307.11, 'fundScale': '2.74亿'}, {'code': '481015', 'name': '工银主题策略混合A', 2016: -30.42, 2017: 13.51, 2018: -37.54, 2019: 57.7, 2020: 129.57, 2021: 20.62, '3y': 272.4, '5y': 182.54, 'fundScale': '14.57亿'}, {'code': '040035', 'name': '华安逆向策略混合', 2016: -3.84, 2017: 1.1, 2018: -20.33, 2019: 65.53, 2020: 81.0, 2021: 26.86, '3y': 270.88, '5y': 205.2, 'fundScale': '41.94亿'}, {'code': '519702', 'name': '交银趋势混合A', 2016: 2.67, 2017: 21.76, 2018: -16.47, 2019: 46.16, 2020: 61.53, 2021: 63.81, '3y': 270.73, '5y': 290.2, 'fundScale': '38.75亿'}, {'code': '040015', 'name': '华安动态灵活配置混合', 2016: -5.43, 2017: 13.2, 2018: -18.89, 2019: 68.59, 2020: 53.02, 2021: 69.46, '3y': 269.71, '5y': 196.76, 'fundScale': '3.29亿'}, {'code': '206012', 'name': '鹏华价值精选股票', 2016: -11.35, 2017: 7.22, 2018: -32.48, 2019: 60.12, 2020: 87.68, 2021: 33.38, '3y': 269.67, '5y': 191.04, 'fundScale': '3.59亿'}, {'code': '400032', 'name': '东方主题精选混合', 2016: -22.0, 2017: -1.7, 2018: -34.74, 2019: 35.68, 2020: 108.42, 2021: 48.75, '3y': 269.56, '5y': 152.83, 'fundScale': '2.27亿'}, {'code': '001997', 'name': '工银新趋势灵活配置混合C', 2016: 1.1, 2017: 13.37, 2018: -9.96, 2019: 25.12, 2020: 119.84, 2021: 33.57, '3y': 269.2, '5y': 281.09, 'fundScale': '1.36亿'}, {'code': '162202', 'name': '泰达宏利周期混合', 2016: -4.49, 2017: 10.41, 2018: -11.6, 2019: 47.81, 2020: 68.76, 2021: 55.38, '3y': 266.63, '5y': 209.17, 'fundScale': '3.18亿'}, {'code': '001808', 'name': '银华互联网主题灵活配置混合', 2016: -22.21, 2017: 17.31, 2018: -30.95, 2019: 60.93, 2020: 96.63, 2021: 25.6, '3y': 264.86, '5y': 198.44, 'fundScale': '1.16亿'}, {'code': '210008', 'name': '金鹰策略配置混合', 2016: -15.29, 2017: 10.65, 2018: -16.39, 2019: 26.22, 2020: 99.83, 2021: 61.54, '3y': 262.08, '5y': 229.35, 'fundScale': '7.93亿'}, {'code': '000547', 'name': '建信健康民生混合', 2016: -5.38, 2017: 9.52, 2018: -23.89, 2019: 68.27, 2020: 65.8, 2021: 40.02, '3y': 261.99, '5y': 228.14, 'fundScale': '2.06亿'}, {'code': '001070', 'name': '建信信息产业股票', 2016: -13.71, 2017: 18.59, 2018: -30.14, 2019: 63.83, 2020: 70.55, 2021: 35.75, '3y': 261.58, '5y': 208.14, 'fundScale': '5.69亿'}, {'code': '310368', 'name': '申万菱信竞争优势混合', 2016: -16.96, 2017: 21.78, 2018: -16.83, 2019: 43.0, 2020: 57.2, 2021: 68.72, '3y': 260.19, '5y': 145.56, 'fundScale': '0.41亿'}, {'code': '020023', 'name': '国泰事件驱动策略混合', 2016: -5.0, 2017: 33.71, 2018: -34.13, 2019: 65.98, 2020: 97.83, 2021: 23.99, '3y': 259.95, '5y': 251.03, 'fundScale': '3.37亿'}, {'code': '000689', 'name': '前海开源新经济混合A', 2016: -12.74, 2017: 11.65, 2018: -18.63, 2019: 20.73, 2020: 60.15, 2021: 93.71, '3y': 259.72, '5y': 206.15, 'fundScale': '14.02亿'}, {'code': '001809', 'name': '中信建投智信物联网A', 2016: -1.2, 2017: 13.76, 2018: -30.34, 2019: 71.39, 2020: 54.97, 2021: 51.73, '3y': 259.63, '5y': 216.77, 'fundScale': '2.87亿'}, {'code': '519095', 'name': '新华行业周期轮换混合', 2016: -9.21, 2017: 0.64, 2018: -16.35, 2019: 49.72, 2020: 84.12, 2021: 35.84, '3y': 258.57, '5y': 208.68, 'fundScale': '3.39亿'}, {'code': '202027', 'name': '南方高端装备灵活配置混合A', 2016: -11.18, 2017: 22.83, 2018: -19.56, 2019: 54.37, 2020: 72.42, 2021: 47.27, '3y': 255.88, '5y': 251.67, 'fundScale': '7.56亿'}, {'code': '001822', 'name': '华商智能生活灵活配置混合', 2016: -12.14, 2017: -7.64, 2018: -5.72, 2019: 34.97, 2020: 75.53, 2021: 55.01, '3y': 255.31, '5y': 209.35, 'fundScale': '1.78亿'}, {'code': '377530', 'name': '上投摩根行业轮动混合A', 2016: -25.2, 2017: 31.96, 2018: -27.25, 2019: 56.89, 2020: 72.47, 2021: 47.11, '3y': 253.57, '5y': 206.65, 'fundScale': '10.60亿'}, {'code': '240022', 'name': '华宝资源优选混合A', 2016: 16.34, 2017: 24.56, 2018: -17.14, 2019: 31.18, 2020: 60.23, 2021: 73.2, '3y': 248.94, '5y': 270.49, 'fundScale': '16.48亿'}, {'code': '540003', 'name': '汇丰晋信动态策略混合A', 2016: -9.24, 2017: 19.18, 2018: -17.32, 2019: 44.65, 2020: 71.75, 2021: 47.23, '3y': 248.55, '5y': 233.94, 'fundScale': '42.83亿'}, {'code': '001858', 'name': '建信鑫利灵活配置混合', 2016: -0.59, 2017: 2.38, 2018: -21.24, 2019: 34.92, 2020: 104.45, 2021: 35.76, '3y': 245.52, '5y': 202.57, 'fundScale': '2.63亿'}, {'code': '000739', 'name': '平安新鑫先锋A', 2016: -42.49, 2017: 17.58, 2018: -34.21, 2019: 46.9, 2020: 68.16, 2021: 59.71, '3y': 243.6, '5y': 181.86, 'fundScale': '0.73亿'}, {'code': '000308', 'name': '建信创新中国混合', 2016: -0.95, 2017: 13.6, 2018: -20.98, 2019: 49.44, 2020: 64.07, 2021: 38.82, '3y': 242.81, '5y': 198.76, 'fundScale': '1.45亿'}, {'code': '000793', 'name': '工银高端制造股票', 2016: -26.28, 2017: 1.45, 2018: -41.81, 2019: 48.28, 2020: 128.81, 2021: 19.63, '3y': 240.19, '5y': 147.75, 'fundScale': '18.56亿'}, {'code': '001515', 'name': '平安新鑫先锋C', 2016: -42.41, 2017: 17.13, 2018: -34.44, 2019: 46.34, 2020: 67.57, 2021: 59.27, '3y': 240.02, '5y': 176.49, 'fundScale': '0.55亿'}, {'code': '000924', 'name': '宝盈先进制造混合A', 2016: -18.95, 2017: -2.01, 2018: -12.02, 2019: 71.05, 2020: 77.34, 2021: 31.77, '3y': 238.67, '5y': 207.72, 'fundScale': '13.82亿'}, {'code': '000242', 'name': '景顺长城策略精选灵活配置混合', 2016: 0.36, 2017: 6.18, 2018: -13.61, 2019: 44.03, 2020: 63.21, 2021: 51.48, '3y': 238.49, '5y': 139.45, 'fundScale': '3.87亿'}, {'code': '001471', 'name': '融通新能源灵活配置混合', 2016: 3.59, 2017: 5.75, 2018: -15.79, 2019: 57.36, 2020: 60.58, 2021: 44.75, '3y': 238.12, '5y': 213.8, 'fundScale': '5.52亿'}, {'code': '370024', 'name': '上投摩根核心优选混合', 2016: -28.67, 2017: 38.9, 2018: -32.18, 2019: 61.25, 2020: 78.26, 2021: 40.48, '3y': 237.9, '5y': 235.2, 'fundScale': '12.55亿'}, {'code': '001811', 'name': '中欧明睿新常态混合A', 2016: -8.0, 2017: 35.98, 2018: -11.03, 2019: 56.51, 2020: 57.08, 2021: 50.55, '3y': 236.43, '5y': 297.14, 'fundScale': '63.28亿'}, {'code': '001677', 'name': '中银战略新兴产业股票A', 2016: 4.4, 2017: 27.49, 2018: -24.34, 2019: 57.6, 2020: 66.16, 2021: 40.01, '3y': 235.33, '5y': 257.06, 'fundScale': '4.54亿'}, {'code': '001009', 'name': '上投摩根安全战略股票', 2016: -19.27, 2017: 15.34, 2018: -30.34, 2019: 72.28, 2020: 79.43, 2021: 21.25, '3y': 233.43, '5y': 184.8, 'fundScale': '7.10亿'}, {'code': '000729', 'name': '建信中小盘先锋股票', 2016: -19.68, 2017: 7.14, 2018: -28.07, 2019: 29.19, 2020: 81.21, 2021: 59.42, '3y': 231.99, '5y': 167.57, 'fundScale': '3.44亿'}, {'code': '000584', 'name': '新华鑫益灵活配置混合', 2016: -5.47, 2017: 13.75, 2018: -6.43, 2019: 47.19, 2020: 72.68, 2021: 34.42, '3y': 229.26, '5y': 276.3, 'fundScale': '2.65亿'}, {'code': '519115', 'name': '浦银安盛红利精选混合', 2016: -19.65, 2017: 11.29, 2018: -25.09, 2019: 65.54, 2020: 50.97, 2021: 45.46, '3y': 227.82, '5y': 194.42, 'fundScale': '0.92亿'}, {'code': '519918', 'name': '华夏兴和混合', 2016: -10.42, 2017: 6.12, 2018: -8.46, 2019: 43.78, 2020: 65.47, 2021: 48.57, '3y': 224.33, '5y': 181.5, 'fundScale': '8.81亿'}, {'code': '001158', 'name': '工银新材料新能源股票', 2016: -24.01, 2017: 6.96, 2018: -28.32, 2019: 42.72, 2020: 83.58, 2021: 37.88, '3y': 222.26, '5y': 158.24, 'fundScale': '24.59亿'}, {'code': '519909', 'name': '华安安顺混合', 2016: -4.16, 2017: 12.38, 2018: -11.12, 2019: 28.08, 2020: 83.93, 2021: 39.37, '3y': 215.44, '5y': 242.87, 'fundScale': '10.94亿'}, {'code': '165313', 'name': '建信优势动力混合(LOF)', 2016: -8.76, 2017: 4.8, 2018: -22.08, 2019: 52.67, 2020: 74.72, 2021: 23.89, '3y': 214.5, '5y': 171.85, 'fundScale': '5.46亿'}, {'code': '375010', 'name': '上投摩根中国优势混合', 2016: -10.93, 2017: 26.18, 2018: -8.78, 2019: 57.81, 2020: 57.79, 2021: 41.82, '3y': 213.58, '5y': 167.56, 'fundScale': '24.56亿'}, {'code': '200015', 'name': '长城优化升级混合A', 2016: -12.66, 2017: 19.41, 2018: -18.16, 2019: 45.38, 2020: 58.58, 2021: 43.77, '3y': 212.49, '5y': 212.22, 'fundScale': '1.04亿'}, {'code': '001933', 'name': '华商新兴活力混合', 2016: 1.1, 2017: 6.73, 2018: -29.66, 2019: 34.78, 2020: 71.36, 2021: 56.82, '3y': 211.68, '5y': 168.72, 'fundScale': '1.08亿'}, {'code': '690011', 'name': '民生加银积极成长混合发起式', 2016: -18.04, 2017: 9.04, 2018: -16.15, 2019: 48.75, 2020: 69.77, 2021: 28.12, '3y': 211.51, '5y': 194.21, 'fundScale': '1.90亿'}, {'code': '002213', 'name': '中海顺鑫灵活配置混合', 2016: 0.0, 2017: 3.3, 2018: -20.86, 2019: 52.68, 2020: 77.23, 2021: 28.46, '3y': 208.6, '5y': 175.46, 'fundScale': '0.90亿'}, {'code': '002844', 'name': '金鹰多元策略混合', 2016: -4.81, 2017: 9.89, 2018: -16.64, 2019: 48.51, 2020: 49.29, 2021: 41.48, '3y': 206.58, '5y': 173.47, 'fundScale': '0.73亿'}, {'code': '001366', 'name': '金鹰产业整合混合', 2016: -26.14, 2017: 4.29, 2018: -29.69, 2019: 48.08, 2020: 91.73, 2021: 23.95, '3y': 200.78, '5y': 144.6, 'fundScale': '2.32亿'}, {'code': '290008', 'name': '泰信发展主题混合', 2016: -13.95, 2017: 7.31, 2018: -14.98, 2019: 48.38, 2020: 54.79, 2021: 40.35, '3y': 200.68, '5y': 176.43, 'fundScale': '0.67亿'}, {'code': '161611', 'name': '融通内需驱动混合', 2016: -25.98, 2017: 7.25, 2018: -13.96, 2019: 61.16, 2020: 48.97, 2021: 34.93, '3y': 200.57, '5y': 172.23}, {'code': '519196', 'name': '万家新兴蓝筹灵活配置混合', 2016: 12.66, 2017: 31.15, 2018: -14.06, 2019: 41.91, 2020: 82.3, 2021: 34.73, '3y': 198.81, '5y': 196.24}, {'code': '000756', 'name': '建信潜力新蓝筹股票', 2016: -7.21, 2017: 15.17, 2018: -26.8, 2019: 32.28, 2020: 65.21, 2021: 47.7, '3y': 197.5, '5y': 171.69}, {'code': '001267', 'name': '泰达宏利蓝筹混合', 2016: -26.64, 2017: 28.49, 2018: -25.65, 2019: 52.63, 2020: 56.58, 2021: 35.32, '3y': 197.31, '5y': 201.09}, {'code': '002537', 'name': '平安安盈灵活配置混合', 2016: 0.3, 2017: 1.79, 2018: 1.18, 2019: 22.81, 2020: 70.87, 2021: 39.89, '3y': 196.43, '5y': 199.95}, {'code': '519091', 'name': '新华泛资源优势混合', 2016: 6.67, 2017: 18.57, 2018: -9.95, 2019: 40.26, 2020: 67.65, 2021: 29.97, '3y': 192.57, '5y': 270.13}, {'code': '519181', 'name': '万家和谐增长混合', 2016: -6.79, 2017: 16.92, 2018: -16.31, 2019: 52.14, 2020: 69.82, 2021: 31.41, '3y': 189.5, '5y': 141.01}, {'code': '001339', 'name': '兴银鼎新灵活配置混合', 2016: -8.91, 2017: 6.69, 2018: -20.92, 2019: 22.2, 2020: 60.88, 2021: 59.06, '3y': 189.06, '5y': 162.97}, {'code': '288001', 'name': '华夏经典混合', 2016: -9.19, 2017: 2.15, 2018: -4.22, 2019: 26.17, 2020: 66.57, 2021: 42.91, '3y': 188.88, '5y': 152.31}, {'code': '001753', 'name': '红土创新新兴产业混合', 2016: -16.67, 2017: 10.85, 2018: -26.6, 2019: 27.1, 2020: 71.49, 2021: 47.01, '3y': 186.77, '5y': 152.4}, {'code': '530001', 'name': '建信恒久价值混合', 2016: -11.05, 2017: 5.24, 2018: -16.03, 2019: 48.98, 2020: 92.86, 2021: 19.37, '3y': 183.94, '5y': 118.59}, {'code': '582003', 'name': '东吴配置优化混合A', 2016: -0.43, 2017: 20.33, 2018: -24.87, 2019: 45.58, 2020: 38.35, 2021: 65.62, '3y': 182.51, '5y': 157.06}, {'code': '002296', 'name': '长城行业轮动混合A', 2016: 2.0, 2017: 4.31, 2018: 0.68, 2019: 13.38, 2020: 19.34, 2021: 107.18, '3y': 181.61, '5y': 193.82}, {'code': '001924', 'name': '华夏国企改革混合', 2016: -13.45, 2017: 13.23, 2018: -29.1, 2019: 49.71, 2020: 71.43, 2021: 21.96, '3y': 178.76, '5y': 142.01}, {'code': '165520', 'name': '信诚中证800有色指数(LOF)A', 2016: -2.99, 2017: 24.49, 2018: -20.9, 2019: 24.2, 2020: 39.61, 2021: 77.99, '3y': 171.59, '5y': 132.48}, {'code': '519195', 'name': '万家品质', 2016: -5.64, 2017: 31.55, 2018: -16.62, 2019: 47.74, 2020: 70.71, 2021: 33.23, '3y': 166.4, '5y': 197.4}, {'code': '519089', 'name': '新华优选成长混合', 2016: -13.82, 2017: -3.76, 2018: -3.32, 2019: 43.77, 2020: 66.04, 2021: 31.66, '3y': 164.36, '5y': 123.02}, {'code': '161028', 'name': '富国中证新能源汽车指数(LOF)A', 2016: -18.82, 2017: 3.69, 2018: 4.47, 2019: 39.42, 2020: 62.0, 2021: 44.86, '3y': 151.77, '5y': 76.84}, {'code': '163807', 'name': '中银优选灵活配置混合A', 2016: -18.07, 2017: 28.58, 2018: -11.14, 2019: 55.4, 2020: 48.13, 2021: 16.74, '3y': 116.52, '5y': 114.35}, {'code': '519997', 'name': '长信银利精选混合', 2016: -3.16, 2017: 7.2, 2018: -4.93, 2019: 24.96, 2020: 45.57, 2021: 19.25, '3y': 90.51, '5y': 84.71}, {'code': '000390', 'name': '华商优势行业混合', 2016: -0.95, 2017: 6.28, 2018: -7.94, 2019: 39.26, 2020: 22.3, 2021: 27.29, '3y': 88.91, '5y': 78.43}]


def linear_regression_fund_filter(pool, days=120):
    data = get_fund_detail_list(pool, start_date=date.today()-timedelta(days=days))
    for i in data:
        networthdata = [{'day': i[0], 'close': float(i[1]), 'applies': float(i[2])} for i in i['networthdata']]
        r = Linear_Regression(networthdata)
        i['R_Square'] = r['R_Square']
        i['slope'] = r['slope']
        i['intercept'] = r['intercept']
        del i['networthdata']
    logging.warning(sorted(data, key=lambda x: x['3y'], reverse=True))
    return sorted(data, key=lambda x: x['3y'], reverse=True)


# pool = fund_ranking_summary()
# pool_include_qdii = [{'code': '001704', 'name': '国投瑞银进宝灵活配置混合'}, {'code': '002190', 'name': '农银新能源主题'}, {'code': '210003', 'name': '金鹰行业优势混合'}, {'code': '002083', 'name': '新华鑫动力灵活配置混合A'}, {'code': '002084', 'name': '新华鑫动力灵活配置混合C'}, {'code': '162202', 'name': '泰达宏利周期混合'}, {'code': '550009', 'name': '信诚中小盘混合'}, {'code': '398051', 'name': '中海环保新能源混合'}, {'code': '001279', 'name': '中海积极增利混合'}, {'code': '519918', 'name': '华夏兴和混合'}, {'code': '000739', 'name': '平安新鑫先锋A'}, {'code': '519702', 'name': '交银趋势混合A'}, {'code': '001515', 'name': '平安新鑫先锋C'}, {'code': '240022', 'name': '华宝资源优选混合A'}, {'code': '090018', 'name': '大成新锐产业混合'}, {'code': '001811', 'name': '中欧明睿新常态混合A'}, {'code': '001809', 'name': '中信建投智信物联网A'}, {'code': '000584', 'name': '新华鑫益灵活配置混合'}, {'code': '000462', 'name': '农银主题轮动混合'}, {'code': '000756', 'name': '建信潜力新蓝筹股票'}, {'code': '519115', 'name': '浦银安盛红利精选混合'}, {'code': '377530', 'name': '上投摩根行业轮动混合A'}, {'code': '000592', 'name': '建信改革红利股票'}, {'code': '200015', 'name': '长城优化升级混合A'}, {'code': '001978', 'name': '泰信互联网+混合'}, {'code': '290008', 'name': '泰信发展主题混合'}, {'code': '519002', 'name': '华安安信消费混合'}, {'code': '540003', 'name': '汇丰晋信动态策略混合A'}, {'code': '519195', 'name': '万家品质'}, {'code': '001039', 'name': '嘉实先进制造股票'}, {'code': '002213', 'name': '中海顺鑫灵活配置混合'}]
pool_without_qdii = [{'code': '001704', 'name': '国投瑞银进宝灵活配置混合'}, {'code': '000689', 'name': '前海开源新经济混合A'}, {'code': '000209', 'name': '信诚新兴产业混合A'}, {'code': '000828', 'name': '泰达转型机遇股票A'}, {'code': '167002', 'name': '平安鼎越混合(LOF)'}, {'code': '400015', 'name': '东方新能源汽车混合'}, {'code': '001245', 'name': '工银生态环境股票'}, {'code': '001298', 'name': '金鹰民族新兴混合'}, {'code': '002190', 'name': '农银新能源主题'}, {'code': '001933', 'name': '华商新兴活力混合'}, {'code': '001822', 'name': '华商智能生活灵活配置混合'}, {'code': '040015', 'name': '华安动态灵活配置混合'}, {'code': '610004', 'name': '信达澳银中小盘混合'}, {'code': '700003', 'name': '平安策略先锋混合'}, {'code': '610006', 'name': '信达澳银产业升级混合'}, {'code': '310368', 'name': '申万菱信竞争优势混合'}, {'code': '210003', 'name': '金鹰行业优势混合'}, {'code': '002083', 'name': '新华鑫动力灵活配置混合A'}, {'code': '002084', 'name': '新华鑫动力灵活配置混合C'}, {'code': '001569', 'name': '泰信国策驱动灵活配置混合'}, {'code': '162202', 'name': '泰达宏利周期混合'}, {'code': '001156', 'name': '申万菱信新能源汽车混合'}, {'code': '550009', 'name': '信诚中小盘混合'}, {'code': '398051', 'name': '中海环保新能源混合'}, {'code': '001279', 'name': '中海积极增利混合'}, {'code': '210008', 'name': '金鹰策略配置混合'}, {'code': '519918', 'name': '华夏兴和混合'}, {'code': '001471', 'name': '融通新能源灵活配置混合'}, {'code': '000409', 'name': '鹏华环保产业股票'}, {'code': '161028', 'name': '富国中证新能源汽车指数(LOF)A'}, {'code': '000729', 'name': '建信中小盘先锋股票'}, {'code': '001606', 'name': '农银工业4.0混合'}, {'code': '000603', 'name': '易方达创新驱动灵活配置混合'}, {'code': '001410', 'name': '信达澳银新能源产业股票'}, {'code': '001951', 'name': '金鹰改革红利混合'}, {'code': '000126', 'name': '招商安润混合'}, {'code': '000739', 'name': '平安新鑫先锋A'}, {'code': '519702', 'name': '交银趋势混合A'}, {'code': '001515', 'name': '平安新鑫先锋C'}, {'code': '001300', 'name': '大成睿景灵活配置混合A'}, {'code': '240022', 'name': '华宝资源优选混合A'}, {'code': '000336', 'name': '农银研究精选混合'}, {'code': '090018', 'name': '大成新锐产业混合'}, {'code': '001301', 'name': '大成睿景灵活配置混合C'}, {'code': '540008', 'name': '汇丰晋信低碳先锋股票A'}, {'code': '001487', 'name': '宝盈优势产业混合A'}, {'code': '001811', 'name': '中欧明睿新常态混合A'}, {'code': '001809', 'name': '中信建投智信物联网A'}, {'code': '165516', 'name': '信诚周期轮动混合(LOF)'}, {'code': '673060', 'name': '西部利得景瑞灵活配置混合A'}, {'code': '000584', 'name': '新华鑫益灵活配置混合'}, {'code': '000462', 'name': '农银主题轮动混合'}, {'code': '000756', 'name': '建信潜力新蓝筹股票'}, {'code': '001476', 'name': '中银智能制造股票A'}, {'code': '002669', 'name': '华商万众创新混合'}, {'code': '519115', 'name': '浦银安盛红利精选混合'}, {'code': '000308', 'name': '建信创新中国混合'}, {'code': '481010', 'name': '工银中小盘混合'}, {'code': '519126', 'name': '浦银安盛新经济结构混合A'}, {'code': '519089', 'name': '新华优选成长混合'}, {'code': '377530', 'name': '上投摩根行业轮动混合A'}, {'code': '001702', 'name': '东方创新科技混合'}, {'code': '000592', 'name': '建信改革红利股票'}, {'code': '000541', 'name': '华商创新成长混合发起式'}, {'code': '001858', 'name': '建信鑫利灵活配置混合'}, {'code': '000242', 'name': '景顺长城策略精选灵活配置混合'}, {'code': '202027', 'name': '南方高端装备灵活配置混合A'}, {'code': '519091', 'name': '新华泛资源优势混合'}, {'code': '160421', 'name': '华安智增精选混合'}, {'code': '002168', 'name': '嘉实智能汽车股票'}, {'code': '001643', 'name': '汇丰晋信智造先锋股票A'}, {'code': '200015', 'name': '长城优化升级混合A'}, {'code': '166301', 'name': '华商新趋势优选灵活配置混合'}, {'code': '000924', 'name': '宝盈先进制造混合A'}, {'code': '001070', 'name': '建信信息产业股票'}, {'code': '001644', 'name': '汇丰晋信智造先锋股票C'}, {'code': '519909', 'name': '华安安顺混合'}, {'code': '530001', 'name': '建信恒久价值混合'}, {'code': '001978', 'name': '泰信互联网+混合'}, {'code': '400032', 'name': '东方主题精选混合'}, {'code': '001808', 'name': '银华互联网主题灵活配置混合'}, {'code': '290008', 'name': '泰信发展主题混合'}, {'code': '519002', 'name': '华安安信消费混合'}, {'code': '540003', 'name': '汇丰晋信动态策略混合A'}, {'code': '519196', 'name': '万家新兴蓝筹灵活配置混合'}, {'code': '001158', 'name': '工银新材料新能源股票'}, {'code': '002537', 'name': '平安安盈灵活配置混合'}, {'code': '377240', 'name': '上投摩根新兴动力混合A'}, {'code': '660015', 'name': '农银行业轮动混合'}, {'code': '163807', 'name': '中银优选灵活配置混合A'}, {'code': '481015', 'name': '工银主题策略混合A'}, {'code': '002844', 'name': '金鹰多元策略混合'}, {'code': '288001', 'name': '华夏经典混合'}, {'code': '519195', 'name': '万家品质'}, {'code': '001716', 'name': '工银新趋势灵活配置混合A'}, {'code': '519642', 'name': '银河智造混合'}, {'code': '001997', 'name': '工银新趋势灵活配置混合C'}, {'code': '519181', 'name': '万家和谐增长混合'}, {'code': '000547', 'name': '建信健康民生混合'}, {'code': '000431', 'name': '鹏华品牌传承混合'}, {'code': '001959', 'name': '华商乐享互联灵活配置混合A'}, {'code': '375010', 'name': '上投摩根中国优势混合'}, {'code': '001039', 'name': '嘉实先进制造股票'}, {'code': '002213', 'name': '中海顺鑫灵活配置混合'}, {'code': '001018', 'name': '易方达新经济混合'}, {'code': '002132', 'name': '广发鑫享混合'}, {'code': '001366', 'name': '金鹰产业整合混合'}, {'code': '002291', 'name': '诺安安鑫灵活配置混合'}, {'code': '000803', 'name': '工银研究精选股票'}, {'code': '165313', 'name': '建信优势动力混合(LOF)'}]

pool = fund_ranking_summary()
print(pool)
print(len(pool))
# data = linear_regression_fund_filter(pool)
# for i in data:
#     print(f"{i['name']}\t{i['R_Square']}\t{i['slope']}\t{i['intercept']}")

