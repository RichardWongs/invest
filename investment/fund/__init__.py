# encoding: utf-8
import logging
from datetime import date, datetime, timedelta
from .fundresults import get_fund
from .fundrank import get_fund_detail_list, fund_ranking_summary, fund_performance_calc
from monitor import Linear_Regression


def linear_regression_fund_filter(pool, days=120):
    data = get_fund_detail_list(pool, start_date=date.today()-timedelta(days=days))
    for i in data:
        networthdata = [{'day': i[0], 'close': float(i[1]), 'applies': float(i[2])} for i in i['networthdata']]
        r = Linear_Regression(networthdata)
        i['R_Square'] = r['R_Square']
        i['slope'] = r['slope']
        i['intercept'] = r['intercept']
        del i['networthdata']
    logging.warning(sorted(data, key=lambda x: x['3y'], reverse=True))
    return sorted(data, key=lambda x: x['3y'], reverse=True)


finally_funds = [{'code': '000336', 'name': '农银研究精选混合', 'manager': '赵诣', 'fundScale': '50.61亿', 2017: 3.19, 2018: -36.61, 2019: 55.94, 2020: 154.88, 2021: 51.87, '3y': 458.28, '5y': 264.36}, {'code': '540008', 'name': '汇丰晋信低碳先锋股票A', 'manager': '陆彬', 'fundScale': '108.63亿', 2017: -3.64, 2018: -36.68, 2019: 45.87, 2020: 134.41, 2021: 46.87, '3y': 405.63, '5y': 169.72}, {'code': '400015', 'name': '东方新能源汽车混合', 'manager': '李瑞', 'fundScale': '201.37亿', 2017: -4.21, 2018: -20.21, 2019: 27.42, 2020: 116.3, 2021: 66.77, '3y': 365.02, '5y': 149.06}, {'code': '001643', 'name': '汇丰晋信智造先锋股票A', 'manager': '陆彬', 'fundScale': '23.07亿', 2017: 7.45, 2018: -27.16, 2019: 73.88, 2020: 128.65, 2021: 46.12, '3y': 459.73, '5y': 341.56}, {'code': '001644', 'name': '汇丰晋信智造先锋股票C', 'manager': '陆彬', 'fundScale': '13.51亿', 2017: 7.06, 2018: -27.52, 2019: 73.12, 2020: 127.52, 2021: 45.46, '3y': 451.77, '5y': 331.54}, {'code': '001245', 'name': '工银生态环境股票', 'manager': '何肖颉', 'fundScale': '46.38亿', 2017: -12.23, 2018: -30.56, 2019: 48.07, 2020: 122.51, 2021: 66.18, '3y': 440.55, '5y': 217.29}, {'code': '001704', 'name': '国投瑞银进宝灵活配置混合', 'manager': '施成', 'fundScale': '32.39亿', 2017: 5.88, 2018: -24.41, 2019: 85.51, 2020: 92.43, 2021: 73.48, '3y': 496.37, '5y': 373.91}, {'code': '398051', 'name': '中海环保新能源混合', 'manager': '左剑', 'fundScale': '23.06亿', 2017: 18.78, 2018: -21.35, 2019: 29.83, 2020: 109.07, 2021: 56.75, '3y': 327.12, '5y': 245.43}, {'code': '001298', 'name': '金鹰民族新兴混合', 'manager': '韩广哲', 'fundScale': '10.54亿', 2017: 7.76, 2018: -22.71, 2019: 44.92, 2020: 88.62, 2021: 88.99, '3y': 393.61, '5y': 324.75}, {'code': '000828', 'name': '泰达转型机遇股票A', 'manager': '王鹏', 'fundScale': '41.79亿', 2017: 12.1, 2018: -24.1, 2019: 71.23, 2020: 104.9, 2021: 72.03, '3y': 489.82, '5y': 338.53}, {'code': '001156', 'name': '申万菱信新能源汽车混合', 'manager': '周小波', 'fundScale': '47.41亿', 2017: 13.36, 2018: -25.41, 2019: 48.06, 2020: 110.76, 2021: 49.32, '3y': 382.17, '5y': 288.86}, {'code': '000689', 'name': '前海开源新经济混合A', 'manager': '崔宸龙', 'fundScale': '63.08亿', 2017: 11.65, 2018: -18.63, 2019: 20.73, 2020: 60.15, 2021: 115.36, '3y': 307.99, '5y': 226.81}, {'code': '002083', 'name': '新华鑫动力灵活配置混合A', 'manager': '刘彬', 'fundScale': '21.76亿', 2017: 0.1, 2018: -30.98, 2019: 51.52, 2020: 121.43, 2021: 54.87, '3y': 392.59, '5y': 258.65}, {'code': '002084', 'name': '新华鑫动力灵活配置混合C', 'manager': '刘彬', 'fundScale': '12.98亿', 2017: 0.1, 2018: -31.14, 2019: 51.59, 2020: 121.13, 2021: 54.73, '3y': 390.95, '5y': 257.19}, {'code': '090018', 'name': '大成新锐产业混合', 'manager': '韩创', 'fundScale': '130.97亿', 2017: -0.82, 2018: -14.65, 2019: 47.43, 2020: 79.41, 2021: 79.55, '3y': 370.78, '5y': 260.49}, {'code': '000409', 'name': '鹏华环保产业股票', 'manager': '孟昊', 'fundScale': '36.04亿', 2017: 17.36, 2018: -19.57, 2019: 34.55, 2020: 116.68, 2021: 44.66, '3y': 327.73, '5y': 280.5}, {'code': '550009', 'name': '信诚中小盘混合', 'manager': '孙浩中', 'fundScale': '4.95亿', 2017: 7.75, 2018: -28.61, 2019: 75.48, 2020: 86.24, 2021: 63.06, '3y': 413.96, '5y': 275.94}, {'code': '001476', 'name': '中银智能制造股票A', 'manager': '王伟', 'fundScale': '16.27亿', 2017: 13.71, 2018: -38.98, 2019: 53.69, 2020: 109.09, 2021: 50.25, '3y': 373.39, '5y': 214.97}, {'code': '001569', 'name': '泰信国策驱动灵活配置混合', 'manager': '吴秉韬', 'fundScale': '2.70亿', 2017: -9.36, 2018: -31.77, 2019: 63.26, 2020: 89.53, 2021: 57.08, '3y': 371.24, '5y': 183.07}, {'code': '400032', 'name': '东方主题精选混合', 'manager': '蒋茜', 'fundScale': '13.36亿', 2017: -1.7, 2018: -34.74, 2019: 35.68, 2020: 108.42, 2021: 52.56, '3y': 309.83, '5y': 154.18}, {'code': '001951', 'name': '金鹰改革红利混合', 'manager': '韩广哲', 'fundScale': '48.07亿', 2017: 4.91, 2018: -25.44, 2019: 30.81, 2020: 99.28, 2021: 59.64, '3y': 306.48, '5y': 222.5}, {'code': '210008', 'name': '金鹰策略配置混合', 'manager': '韩广哲', 'fundScale': '12.47亿', 2017: 10.65, 2018: -16.39, 2019: 26.22, 2020: 99.83, 2021: 53.4, '3y': 272.58, '5y': 201.36}, {'code': '001300', 'name': '大成睿景灵活配置混合A', 'manager': '韩创', 'fundScale': '28.11亿', 2017: 9.08, 2018: -28.88, 2019: 43.97, 2020: 77.59, 2021: 75.17, '3y': 343.16, '5y': 227.63}, {'code': '000126', 'name': '招商安润混合', 'manager': '任琳娜', 'fundScale': '11.17亿', 2017: 1.59, 2018: 0.59, 2019: 33.9, 2020: 97.9, 2021: 56.95, '3y': 316.31, '5y': 321.63}, {'code': '700003', 'name': '平安策略先锋混合', 'manager': '神爱前', 'fundScale': '6.58亿', 2017: 10.72, 2018: -28.79, 2019: 75.33, 2020: 67.25, 2021: 80.1, '3y': 416.36, '5y': 286.38}, {'code': '001301', 'name': '大成睿景灵活配置混合C', 'manager': '韩创', 'fundScale': '25.27亿', 2017: 8.09, 2018: -29.42, 2019: 42.78, 2020: 76.31, 2021: 74.0, '3y': 332.49, '5y': 214.85}, {'code': '001822', 'name': '华商智能生活灵活配置混合', 'manager': '高兵', 'fundScale': '5.82亿', 2017: -7.64, 2018: -5.72, 2019: 34.97, 2020: 75.53, 2021: 74.29, '3y': 309.21, '5y': 239.7}, {'code': '481010', 'name': '工银中小盘混合', 'manager': '黄安乐', 'fundScale': '24.70亿', 2017: -11.49, 2018: -25.89, 2019: 61.21, 2020: 134.73, 2021: 24.03, '3y': 363.54, '5y': 192.27}, {'code': '002669', 'name': '华商万众创新混合', 'manager': '梁皓', 'fundScale': '23.04亿', 2017: -19.06, 2018: -21.27, 2019: 68.81, 2020: 116.67, 2021: 38.42, '3y': 387.46, '5y': 218.08}, {'code': '210003', 'name': '金鹰行业优势混合', 'manager': '倪超', 'fundScale': '7.24亿', 2017: 18.98, 2018: -18.4, 2019: 42.83, 2020: 80.37, 2021: 62.84, '3y': 318.0, '5y': 251.72}, {'code': '165516', 'name': '信诚周期轮动混合(LOF)', 'manager': '张弘', 'fundScale': '31.89亿', 2017: 13.45, 2018: -23.3, 2019: 64.45, 2020: 90.66, 2021: 37.42, '3y': 304.83, '5y': 199.8}, {'code': '001716', 'name': '工银新趋势灵活配置混合A', 'manager': '何肖颉', 'fundScale': '5.54亿', 2017: 17.88, 2018: -9.25, 2019: 25.8, 2020: 121.31, 2021: 31.83, '3y': 269.07, '5y': 289.19}, {'code': '000729', 'name': '建信中小盘先锋股票A', 'manager': '周智硕', 'fundScale': '9.47亿', 2017: 7.14, 2018: -28.07, 2019: 29.19, 2020: 81.21, 2021: 64.37, '3y': 274.73, '5y': 175.15}, {'code': '001702', 'name': '东方创新科技混合', 'manager': '蒋茜', 'fundScale': '9.81亿', 2017: 4.76, 2018: -29.94, 2019: 56.03, 2020: 112.38, 2021: 36.55, '3y': 342.78, '5y': 203.79}, {'code': '001933', 'name': '华商新兴活力混合', 'manager': '高兵', 'fundScale': '2.09亿', 2017: 6.73, 2018: -29.66, 2019: 34.78, 2020: 71.36, 2021: 74.61, '3y': 278.37, '5y': 192.92}, {'code': '001997', 'name': '工银新趋势灵活配置混合C', 'manager': '何肖颉', 'fundScale': '1.81亿', 2017: 13.37, 2018: -9.96, 2019: 25.12, 2020: 119.84, 2021: 31.1, '3y': 262.03, '5y': 264.15}, {'code': '001858', 'name': '建信鑫利灵活配置混合', 'manager': '陶灿', 'fundScale': '4.21亿', 2017: 2.38, 2018: -21.24, 2019: 34.92, 2020: 104.45, 2021: 41.34, '3y': 280.26, '5y': 213.45}, {'code': '162202', 'name': '泰达宏利周期混合', 'manager': '张勋', 'fundScale': '4.52亿', 2017: 10.41, 2018: -11.6, 2019: 47.81, 2020: 68.76, 2021: 56.52, '3y': 278.93, '5y': 193.94}, {'code': '001616', 'name': '嘉实环保低碳股票', 'manager': '姚志鹏', 'fundScale': '56.39亿', 2017: 33.13, 2018: -32.95, 2019: 53.37, 2020: 113.67, 2021: 24.62, '3y': 318.01, '5y': 252.16}, {'code': '519126', 'name': '浦银安盛新经济结构混合A', 'manager': '蒋佳良', 'fundScale': '37.69亿', 2017: -0.43, 2018: -35.0, 2019: 62.63, 2020: 87.55, 2021: 44.89, '3y': 326.27, '5y': 170.44}, {'code': '000592', 'name': '建信改革红利股票', 'manager': '陶灿', 'fundScale': '6.70亿', 2017: 26.84, 2018: -33.64, 2019: 60.75, 2020: 101.88, 2021: 37.7, '3y': 317.25, '5y': 250.9}, {'code': '519702', 'name': '交银趋势混合A', 'manager': '杨金金', 'fundScale': '78.18亿', 2017: 21.76, 2018: -16.47, 2019: 46.16, 2020: 61.53, 2021: 74.7, '3y': 301.49, '5y': 279.33}, {'code': '000462', 'name': '农银主题轮动混合', 'manager': '张燕', 'fundScale': '5.64亿', 2017: 46.68, 2018: -43.34, 2019: 54.25, 2020: 93.94, 2021: 44.37, '3y': 322.75, '5y': 227.16}, {'code': '040015', 'name': '华安动态灵活配置混合A', 'manager': '蒋璆', 'fundScale': '9.80亿', 2017: 13.2, 2018: -18.89, 2019: 68.59, 2020: 53.02, 2021: 71.34, '3y': 317.9, '5y': 185.15}, {'code': '002168', 'name': '嘉实智能汽车股票', 'manager': '姚志鹏', 'fundScale': '54.69亿', 2017: 20.16, 2018: -24.83, 2019: 65.62, 2020: 93.91, 2021: 32.05, '3y': 336.18, '5y': 268.5}, {'code': '000739', 'name': '平安新鑫先锋A', 'manager': '张晓泉', 'fundScale': '1.13亿', 2017: 17.58, 2018: -34.21, 2019: 46.9, 2020: 68.16, 2021: 57.7, '3y': 273.22, '5y': 172.39}, {'code': '001279', 'name': '中海积极增利混合', 'manager': '左剑', 'fundScale': '3.38亿', 2017: 17.58, 2018: -30.01, 2019: 66.91, 2020: 64.18, 2021: 64.65, '3y': 330.13, '5y': 244.78}, {'code': '550015', 'name': '中信保诚至远动力混合A', 'manager': '王睿', 'fundScale': '48.18亿', 2017: 2.0, 2018: -1.89, 2019: 13.1, 2020: 110.44, 2021: 30.6, '3y': 215.7, '5y': 209.52}, {'code': '000603', 'name': '易方达创新驱动灵活配置混合', 'manager': '贾健', 'fundScale': '58.14亿', 2017: -0.22, 2018: -24.62, 2019: 41.11, 2020: 73.04, 2021: 54.81, '3y': 273.09, '5y': 161.39}, {'code': '001515', 'name': '平安新鑫先锋C', 'manager': '张晓泉', 'fundScale': '0.80亿', 2017: 17.13, 2018: -34.44, 2019: 46.34, 2020: 67.57, 2021: 57.15, '3y': 268.92, '5y': 167.41}, {'code': '000924', 'name': '宝盈先进制造混合A', 'manager': '张仲维', 'fundScale': '13.05亿', 2017: -2.01, 2018: -12.02, 2019: 71.05, 2020: 77.34, 2021: 42.76, '3y': 296.82, '5y': 218.28}, {'code': '530001', 'name': '建信恒久价值混合', 'manager': '陶灿', 'fundScale': '13.36亿', 2017: 5.24, 2018: -16.03, 2019: 48.98, 2020: 92.86, 2021: 22.66, '3y': 222.61, '5y': 127.54}, {'code': '167002', 'name': '平安鼎越混合(LOF)', 'manager': '张俊生', 'fundScale': '1.71亿', 2017: -5.13, 2018: -16.92, 2019: 50.56, 2020: 61.91, 2021: 62.7, '3y': 284.92, '5y': 209.97}, {'code': '003624', 'name': '创金合信资源股票发起式A', 'manager': '李游', 'fundScale': '6.39亿', 2017: 26.76, 2018: -34.23, 2019: 33.78, 2020: 88.24, 2021: 30.42, '3y': 228.34, '5y': 150.08}, {'code': '550016', 'name': '中信保诚至远动力混合C', 'manager': '王睿', 'fundScale': '6.52亿', 2017: 6.04, 2018: 39.08, 2019: 12.84, 2020: 109.72, 2021: 30.19, '3y': 212.91, '5y': 324.83}, {'code': '003625', 'name': '创金合信资源股票发起式C', 'manager': '李游', 'fundScale': '6.37亿', 2017: 25.21, 2018: -34.72, 2019: 34.24, 2020: 87.31, 2021: 29.83, '3y': 226.21, '5y': 143.65}, {'code': '610006', 'name': '信达澳银产业升级混合', 'manager': '曾国富', 'fundScale': '8.45亿', 2017: -5.28, 2018: -22.24, 2019: 53.23, 2020: 72.65, 2021: 55.78, '3y': 296.84, '5y': 154.3}, {'code': '001740', 'name': '光大中国制造2025混合', 'manager': '魏晓雪', 'fundScale': '13.79亿', 2017: 39.92, 2018: -28.05, 2019: 39.48, 2020: 73.95, 2021: 32.37, '3y': 213.24, '5y': 188.37}, {'code': '001410', 'name': '信达澳银新能源产业股票', 'manager': '冯明远', 'fundScale': '148.10亿', 2017: 39.27, 2018: -15.81, 2019: 94.11, 2020: 59.88, 2021: 51.92, '3y': 366.39, '5y': 407.43}, {'code': '001054', 'name': '工银新金融股票A', 'manager': '鄢耀', 'fundScale': '91.05亿', 2017: 11.99, 2018: -20.28, 2019: 54.3, 2020: 103.97, 2021: 29.04, '3y': 291.82, '5y': 232.18}, {'code': '270028', 'name': '广发制造业精选混合A', 'manager': '李巍', 'fundScale': '14.63亿', 2017: 16.54, 2018: -35.87, 2019: 68.18, 2020: 90.95, 2021: 30.94, '3y': 309.79, '5y': 199.71}, {'code': '002256', 'name': '金信行业优选混合发起式', 'manager': '孔学兵', 'fundScale': '1.14亿', 2017: 0.2, 2018: -34.75, 2019: 58.07, 2020: 79.08, 2021: 54.69, '3y': 320.9, '5y': 162.81}, {'code': '519095', 'name': '新华行业周期轮换混合', 'manager': '刘彬', 'fundScale': '3.32亿', 2017: 0.64, 2018: -16.35, 2019: 49.72, 2020: 84.12, 2021: 31.41, '3y': 259.21, '5y': 176.2}, {'code': '519002', 'name': '华安安信消费混合A', 'manager': '王斌', 'fundScale': '25.01亿', 2017: 5.93, 2018: -18.72, 2019: 76.75, 2020: 88.91, 2021: 34.73, '3y': 343.57, '5y': 210.81}, {'code': '001808', 'name': '银华互联网主题灵活配置混合', 'manager': '王浩', 'fundScale': '1.28亿', 2017: 17.31, 2018: -30.95, 2019: 60.93, 2020: 96.63, 2021: 32.71, '3y': 314.65, '5y': 216.09}, {'code': '398021', 'name': '中海能源策略混合', 'manager': '姚晨曦', 'fundScale': '16.32亿', 2017: 31.66, 2018: -26.23, 2019: 21.88, 2020: 45.44, 2021: 77.43, '3y': 214.68, '5y': 145.48}, {'code': '519196', 'name': '万家新兴蓝筹灵活配置混合', 'manager': '莫海波', 'fundScale': '17.81亿', 2017: 31.15, 2018: -14.06, 2019: 41.91, 2020: 82.3, 2021: 27.47, '3y': 215.38, '5y': 151.17}, {'code': '000756', 'name': '建信潜力新蓝筹股票', 'manager': '周智硕', 'fundScale': '1.19亿', 2017: 15.17, 2018: -26.8, 2019: 32.28, 2020: 65.21, 2021: 52.38, '3y': 227.67, '5y': 170.61}, {'code': '200015', 'name': '长城优化升级混合A', 'manager': '周诗博', 'fundScale': '3.26亿', 2017: 19.41, 2018: -18.16, 2019: 45.38, 2020: 58.58, 2021: 60.79, '3y': 267.93, '5y': 231.55}, {'code': '377240', 'name': '上投摩根新兴动力混合A', 'manager': '杜猛', 'fundScale': '72.54亿', 2017: 42.21, 2018: -35.65, 2019: 70.27, 2020: 78.24, 2021: 38.08, '3y': 304.94, '5y': 257.58}, {'code': '001701', 'name': '中融产业升级混合', 'manager': '甘传琦', 'fundScale': '2.20亿', 2017: 22.31, 2018: -28.39, 2019: 55.24, 2020: 78.76, 2021: 35.01, '3y': 257.21, '5y': 199.43}, {'code': '001487', 'name': '宝盈优势产业混合A', 'manager': '肖肖', 'fundScale': '21.93亿', 2017: 29.57, 2018: -22.13, 2019: 63.06, 2020: 33.84, 2021: 92.98, '3y': 316.02, '5y': 276.64}, {'code': '000601', 'name': '华宝创新优选混合', 'manager': '代云锋', 'fundScale': '19.87亿', 2017: 17.76, 2018: -17.6, 2019: 72.42, 2020: 94.84, 2021: 26.11, '3y': 317.12, '5y': 264.98}, {'code': '001158', 'name': '工银新材料新能源股票', 'manager': '张剑峰', 'fundScale': '25.62亿', 2017: 6.96, 2018: -28.32, 2019: 42.72, 2020: 83.58, 2021: 34.42, '3y': 250.19, '5y': 154.16}, {'code': '002170', 'name': '东吴移动互联混合C', 'manager': '刘元海', 'fundScale': '0.03亿', 2017: 11.57, 2018: -29.91, 2019: 29.97, 2020: 67.75, 2021: 52.08, '3y': 221.08, '5y': 148.85}, {'code': '519089', 'name': '新华优选成长混合', 'manager': '栾超', 'fundScale': '5.50亿', 2017: -3.76, 2018: -3.32, 2019: 43.77, 2020: 66.04, 2021: 41.51, '3y': 207.34, '5y': 129.33}, {'code': '002340', 'name': '富国价值优势混合', 'manager': '孙彬', 'fundScale': '46.86亿', 2017: 28.79, 2018: -27.75, 2019: 70.9, 2020: 86.83, 2021: 30.27, '3y': 280.19, '5y': 273.89}, {'code': '610004', 'name': '信达澳银中小盘混合', 'manager': '曾国富', 'fundScale': '10.11亿', 2017: 5.35, 2018: -15.15, 2019: 62.06, 2020: 61.94, 2021: 54.17, '3y': 299.35, '5y': 248.83}, {'code': '001323', 'name': '东吴移动互联混合A', 'manager': '刘元海', 'fundScale': '0.82亿', 2017: 11.93, 2018: -29.69, 2019: 30.05, 2020: 66.13, 2021: 52.31, '3y': 218.75, '5y': 148.81}, {'code': '519909', 'name': '华安安顺混合', 'manager': '高钥群', 'fundScale': '14.08亿', 2017: 12.38, 2018: -11.12, 2019: 28.08, 2020: 83.93, 2021: 33.9, '3y': 211.2, '5y': 209.56}, {'code': '001809', 'name': '中信建投智信物联网A', 'manager': '周紫光', 'fundScale': '3.46亿', 2017: 13.76, 2018: -30.34, 2019: 71.39, 2020: 54.97, 2021: 47.31, '3y': 290.86, '5y': 206.01}, {'code': '001366', 'name': '金鹰产业整合混合', 'manager': '杨晓斌', 'fundScale': '2.55亿', 2017: 4.29, 2018: -29.69, 2019: 48.08, 2020: 91.73, 2021: 30.71, '3y': 259.93, '5y': 157.94}, {'code': '202027', 'name': '南方高端装备灵活配置混合A', 'manager': '张磊', 'fundScale': '14.99亿', 2017: 22.83, 2018: -19.56, 2019: 54.37, 2020: 72.42, 2021: 43.18, '3y': 273.4, '5y': 237.15}, {'code': '001811', 'name': '中欧明睿新常态混合A', 'manager': '周应波', 'fundScale': '88.46亿', 2017: 35.98, 2018: -11.03, 2019: 56.51, 2020: 57.08, 2021: 56.2, '3y': 261.47, '5y': 305.51}, {'code': '001827', 'name': '富国研究优选沪港深混合', 'manager': '厉叶淼', 'fundScale': '1.55亿', 2017: 24.21, 2018: -25.89, 2019: 43.17, 2020: 78.4, 2021: 37.03, '3y': 237.46, '5y': 213.77}, {'code': '660015', 'name': '农银行业轮动混合', 'manager': '邢军亮', 'fundScale': '2.78亿', 2017: 24.56, 2018: -25.39, 2019: 41.99, 2020: 70.96, 2021: 42.86, '3y': 238.11, '5y': 201.92}, {'code': '000242', 'name': '景顺长城策略精选灵活配置混合', 'manager': '张靖', 'fundScale': '14.22亿', 2017: 6.18, 2018: -13.61, 2019: 44.03, 2020: 63.21, 2021: 47.62, '3y': 243.22, '5y': 131.02}, {'code': '002213', 'name': '中海顺鑫灵活配置混合', 'manager': '邱红丽', 'fundScale': '1.03亿', 2017: 3.3, 2018: -20.86, 2019: 52.68, 2020: 77.23, 2021: 31.89, '3y': 250.59, '5y': 183.28}, {'code': '001718', 'name': '工银物流产业股票', 'manager': '张宇帆', 'fundScale': '15.45亿', 2017: 21.82, 2018: -14.78, 2019: 50.09, 2020: 76.37, 2021: 35.23, '3y': 265.65, '5y': 260.18}, {'code': '001387', 'name': '中融新经济混合A', 'manager': '甘传琦', 'fundScale': '2.11亿', 2017: 122.48, 2018: -14.95, 2019: 50.67, 2020: 72.72, 2021: 34.23, '3y': 240.64, '5y': 451.8}, {'code': '519091', 'name': '新华泛资源优势混合', 'manager': '栾超', 'fundScale': '11.29亿', 2017: 18.57, 2018: -9.95, 2019: 40.26, 2020: 67.65, 2021: 39.67, '3y': 225.49, '5y': 255.32}, {'code': '001388', 'name': '中融新经济混合C', 'manager': '甘传琦', 'fundScale': '0.76亿', 2017: 11.64, 2018: -18.36, 2019: 50.28, 2020: 78.12, 2021: 33.96, '3y': 244.43, '5y': 213.97}, {'code': '000124', 'name': '华宝服务优选混合', 'manager': '代云锋', 'fundScale': '8.43亿', 2017: 5.71, 2018: -20.0, 2019: 45.64, 2020: 85.58, 2021: 28.23, '3y': 233.73, '5y': 163.77}, {'code': '540003', 'name': '汇丰晋信动态策略混合A', 'manager': '陆彬', 'fundScale': '77.97亿', 2017: 19.18, 2018: -17.32, 2019: 44.65, 2020: 71.75, 2021: 40.56, '3y': 243.08, '5y': 207.97}, {'code': '166019', 'name': '中欧价值智选混合A', 'manager': '袁维德', 'fundScale': '103.56亿', 2017: -4.8, 2018: -6.63, 2019: 46.32, 2020: 60.94, 2021: 47.93, '3y': 247.3, '5y': 198.79}, {'code': '001887', 'name': '中欧价值智选混合E', 'manager': '袁维德', 'fundScale': '24.29亿', 2017: -4.88, 2018: -6.37, 2019: 46.54, 2020: 60.92, 2021: 47.93, '3y': 247.8, '5y': 199.87}, {'code': '673060', 'name': '西部利得景瑞灵活配置混合A', 'manager': '陈保国', 'fundScale': '4.39亿', 2017: -2.72, 2018: -18.72, 2019: 72.26, 2020: 63.38, 2021: 53.91, '3y': 330.21, '5y': 226.43}, {'code': '310358', 'name': '申万菱信新经济混合', 'manager': '付娟', 'fundScale': '25.87亿', 2017: 40.89, 2018: -14.24, 2019: 31.58, 2020: 49.17, 2021: 34.08, '3y': 161.12, '5y': 119.79}, {'code': '000547', 'name': '建信健康民生混合', 'manager': '姜锋', 'fundScale': '7.56亿', 2017: 9.52, 2018: -23.89, 2019: 68.27, 2020: 65.8, 2021: 40.86, '3y': 284.18, '5y': 213.5}, {'code': '519195', 'name': '万家品质', 'manager': '莫海波', 'fundScale': '10.03亿', 2017: 31.55, 2018: -16.62, 2019: 47.74, 2020: 70.71, 2021: 27.29, '3y': 176.14, '5y': 152.06}, {'code': '001471', 'name': '融通新能源灵活配置混合', 'manager': '彭炜', 'fundScale': '6.73亿', 2017: 5.75, 2018: -15.79, 2019: 57.36, 2020: 60.58, 2021: 46.93, '3y': 261.14, '5y': 196.58}, {'code': '000431', 'name': '鹏华品牌传承混合', 'manager': '孟昊', 'fundScale': '6.40亿', 2017: 43.01, 2018: -26.08, 2019: 64.06, 2020: 87.81, 2021: 27.13, '3y': 296.18, '5y': 286.95}, {'code': '240022', 'name': '华宝资源优选混合A', 'manager': '蔡目荣', 'fundScale': '19.11亿', 2017: 24.56, 2018: -17.14, 2019: 31.18, 2020: 60.23, 2021: 43.37, '3y': 197.82, '5y': 167.06}, {'code': '163807', 'name': '中银优选灵活配置混合A', 'manager': '王伟', 'fundScale': '13.42亿', 2017: 28.58, 2018: -11.14, 2019: 55.4, 2020: 48.13, 2021: 15.81, '3y': 122.95, '5y': 102.52}, {'code': '375010', 'name': '上投摩根中国优势混合', 'manager': '杜猛', 'fundScale': '27.42亿', 2017: 26.18, 2018: -8.78, 2019: 57.81, 2020: 57.79, 2021: 35.73, '3y': 229.24, '5y': 149.03}, {'code': '040035', 'name': '华安逆向策略混合A', 'manager': '崔莹', 'fundScale': '58.97亿', 2017: 1.1, 2018: -20.33, 2019: 65.53, 2020: 81.0, 2021: 28.6, '3y': 283.99, '5y': 184.78}, {'code': '002281', 'name': '建信裕利灵活配置混合', 'manager': '江映德', 'fundScale': '0.96亿', 2017: 2.78, 2018: -17.06, 2019: 29.76, 2020: 64.51, 2021: 44.88, '3y': 206.55, '5y': 162.61}, {'code': '001018', 'name': '易方达新经济混合', 'manager': '陈皓', 'fundScale': '31.07亿', 2017: 31.57, 2018: -25.11, 2019: 63.34, 2020: 68.0, 2021: 33.67, '3y': 250.59, '5y': 244.34}, {'code': '003304', 'name': '前海开源沪港深核心资源混合A', 'manager': '吴国清', 'fundScale': '2.86亿', 2017: 12.45, 2018: -10.89, 2019: 31.86, 2020: 46.81, 2021: 53.55, '3y': 202.58, '5y': 188.57}, {'code': '003305', 'name': '前海开源沪港深核心资源混合C', 'manager': '吴国清', 'fundScale': '1.68亿', 2017: 11.14, 2018: -10.03, 2019: 31.63, 2020: 46.68, 2021: 53.38, '3y': 201.45, '5y': 186.9}, {'code': '310368', 'name': '申万菱信竞争优势混合', 'manager': '廖明兵', 'fundScale': '1.21亿', 2017: 21.78, 2018: -16.83, 2019: 43.0, 2020: 57.2, 2021: 50.8, '3y': 231.3, '5y': 106.35}, {'code': '001070', 'name': '建信信息产业股票', 'manager': '邵卓', 'fundScale': '6.76亿', 2017: 18.59, 2018: -30.14, 2019: 63.83, 2020: 70.55, 2021: 34.93, '3y': 270.95, '5y': 193.31}, {'code': '377530', 'name': '上投摩根行业轮动混合A', 'manager': '孙芳', 'fundScale': '13.32亿', 2017: 31.96, 2018: -27.25, 2019: 56.89, 2020: 72.47, 2021: 33.27, '3y': 246.55, '5y': 173.29}, {'code': '000308', 'name': '建信创新中国混合', 'manager': '邵卓', 'fundScale': '2.69亿', 2017: 13.6, 2018: -20.98, 2019: 49.44, 2020: 64.07, 2021: 39.75, '3y': 239.22, '5y': 191.05}, {'code': '550002', 'name': '中信保诚精萃成长混合', 'manager': '王睿', 'fundScale': '20.22亿', 2017: 13.65, 2018: -14.42, 2019: 18.71, 2020: 41.91, 2021: 38.18, '3y': 119.56, '5y': 61.72}, {'code': '000039', 'name': '农银高增长混合', 'manager': '张燕', 'fundScale': '2.65亿', 2017: 9.18, 2018: -25.55, 2019: 44.54, 2020: 56.07, 2021: 42.63, '3y': 208.24, '5y': 141.14}, {'code': '370024', 'name': '上投摩根核心优选混合', 'manager': '孙芳', 'fundScale': '18.27亿', 2017: 38.9, 2018: -32.18, 2019: 61.25, 2020: 78.26, 2021: 27.42, '3y': 227.63, '5y': 197.55}, {'code': '000698', 'name': '宝盈科技30混合', 'manager': '张仲维', 'fundScale': '14.11亿', 2017: 8.21, 2018: -26.16, 2019: 71.2, 2020: 56.53, 2021: 38.49, '3y': 263.09, '5y': 172.66}, {'code': '160421', 'name': '华安智增精选混合', 'manager': '王春', 'fundScale': '1.54亿', 2017: -1.35, 2018: -21.15, 2019: 75.75, 2020: 54.97, 2021: 45.07, '3y': 279.11, '5y': 192.35}, {'code': '690011', 'name': '民生加银积极成长混合发起式', 'manager': '金耀', 'fundScale': '3.25亿', 2017: 9.04, 2018: -16.15, 2019: 48.75, 2020: 69.77, 2021: 27.99, '3y': 222.11, '5y': 185.64}, {'code': '519158', 'name': '新华趋势领航混合', 'manager': '栾超', 'fundScale': '4.52亿', 2017: 5.1, 2018: -17.51, 2019: 57.34, 2020: 52.61, 2021: 39.13, '3y': 228.38, '5y': 167.19}, {'code': '000985', 'name': '嘉实逆向策略股票', 'manager': '曲盛伟', 'fundScale': '9.37亿', 2017: 17.59, 2018: -33.95, 2019: 58.1, 2020: 58.05, 2021: 37.81, '3y': 248.46, '5y': 158.27}, {'code': '001220', 'name': '民生加银研究精选混合', 'manager': '蔡晓', 'fundScale': '3.00亿', 2017: 3.55, 2018: -25.97, 2019: 48.01, 2020: 79.63, 2021: 22.68, '3y': 223.06, '5y': 141.16}, {'code': '001000', 'name': '中欧明睿新起点混合', 'manager': '葛兰', 'fundScale': '39.23亿', 2017: 22.09, 2018: -41.18, 2019: 72.73, 2020: 82.46, 2021: 22.21, '3y': 255.03, '5y': 160.45}, {'code': '000404', 'name': '易方达新兴成长灵活配置', 'manager': '刘武', 'fundScale': '47.47亿', 2017: 15.19, 2018: -32.54, 2019: 89.87, 2020: 59.17, 2021: 28.0, '3y': 262.79, '5y': 173.01}, {'code': '001072', 'name': '华安智能装备主题股票A', 'manager': '李欣', 'fundScale': '9.20亿', 2017: 15.38, 2018: -24.6, 2019: 70.9, 2020: 56.89, 2021: 35.87, '3y': 253.98, '5y': 178.47}, {'code': '162208', 'name': '泰达宏利首选企业股票', 'manager': '张勋', 'fundScale': '6.22亿', 2017: 20.0, 2018: -20.78, 2019: 43.64, 2020: 45.24, 2021: 24.13, '3y': 154.08, '5y': 80.66}, {'code': '160919', 'name': '大成产业升级股票(LOF)', 'manager': '李林益', 'fundScale': '3.23亿', 2017: 11.47, 2018: -8.88, 2019: 54.01, 2020: 62.95, 2021: 34.47, '3y': 240.32, '5y': 176.49}, {'code': '257070', 'name': '国联安优选行业混合', 'manager': '潘明', 'fundScale': '13.58亿', 2017: 2.5, 2018: -27.79, 2019: 85.97, 2020: 66.73, 2021: 29.96, '3y': 284.7, '5y': 158.98}, {'code': '050010', 'name': '博时特许价值混合A', 'manager': '曾鹏', 'fundScale': '6.35亿', 2017: 10.59, 2018: -24.31, 2019: 85.61, 2020: 70.81, 2021: 21.68, '3y': 280.39, '5y': 177.75}, {'code': '460001', 'name': '华泰柏瑞盛世中国混合', 'manager': '牛勇', 'fundScale': '22.62亿', 2017: 18.2, 2018: -9.27, 2019: 39.44, 2020: 68.28, 2021: 5.63, '3y': 106.4, '5y': 60.2}, {'code': '630016', 'name': '华商价值共享混合发起式', 'manager': '何奇峰', 'fundScale': '1.92亿', 2017: 10.49, 2018: -27.64, 2019: 55.73, 2020: 75.58, 2021: 23.94, '3y': 224.08, '5y': 123.06}, {'code': '001677', 'name': '中银战略新兴产业股票A', 'manager': '钱亚风云', 'fundScale': '4.98亿', 2017: 27.49, 2018: -24.34, 2019: 57.6, 2020: 66.16, 2021: 30.87, '3y': 229.29, '5y': 215.16}]

etf_list = [{"name": "创成长", "code": 159967}, {"name": "质量ETF", "code": 515910}, {"name": "上证50", "code": 510050}, {"name": "科创50", "code": 588000}, {"name": "光伏ETF", "code": 515790}, {"name": "医疗ETF", "code": 510050}, {"name": "生物医药ETF", "code": 161726}, {"name": "有色金属ETF", "code": 512400}, {"name": "家电ETF", "code": 159996}, {"name": "酒ETF", "code": 512690}, {"name": "农业ETF", "code": 159825}, {"name": "钢铁ETF", "code": 515210}, {"name": "煤炭ETF", "code": 515220}, {"name": "银行ETF", "code": 512800}, {"name": "证券ETF", "code": 159841}, {"name": "房地产ETF", "code": 512200}, {"name": "恒生互联ETF", "code": 513330}, {"name": "5G ETF", "code": 515050}, {"name": "军工ETF", "code": 512660}, {"name": "芯片ETF", "code": 159995}, {"name": "化工ETF", "code": 159870}, {'name': '深创100', 'code': 159721}, {"name": "新能源汽车ETF", "code": 516390}, {"name": "光伏ETF", "code": 515790}, {"name": "医疗创新ETF", "code": 516820}, {"name": "恒生科技30ETF", "code": 513010}, {"name": "恒生医疗ETF", "code": 513060}, {'name': "碳中和50ETF", "code": 516070}]


def get_fund_kline(code, start_date=str(date.today() - timedelta(180)), end_date=str(date.today())):
    data = get_fund(code, start_date=start_date, end_date=end_date)
    for i in data:
        i['close'] = i['unit_close']
        i['last_close'] = i['last_unit_close']
        i['open'] = i['last_unit_close']
        i['high'] = max(i['close'], i['last_close'])
        i['low'] = min(i['close'], i['last_close'])
        i['volume'] = 0
        del i['cumulative_close']
        del i['unit_close']
        del i['last_cumulative_close']
        del i['last_unit_close']
        del i['ema50_unit_close']
        del i['ema150_unit_close']
        del i['ema50_cumulative_close']
        del i['ema150_cumulative_close']
    return data



