# encoding: utf-8
import logging
import pickle
import time
import json
import redis
import requests
from RPS.RPS_DATA import pro
from monitor import EMA_V2, MA_V2, BooleanLine, Linear_Regression
from RPS.stock_pool import STOCK_LIST


def RedisConn():
    client = redis.Redis(host="192.168.124.20", port=6379, db=0)
    return client


class SecurityException(BaseException):
    pass


def get_stock_kline_with_indicators(code, is_index=False, period=101, limit=120):
    time.sleep(0.5)
    assert period in (1, 5, 15, 30, 60, 101, 102, 103)
    if is_index:
        if code.startswith('3'):
            secid = f'0.{code}'
        elif code.startswith('0'):
            secid = f'1.{code}'
        elif code.startswith('H') or code.startswith('9'):
            secid = f'2.{code}'
        else:
            return None
    else:
        if str(code)[0] in ('0', '1', '3'):
            secid = f'0.{code}'
        else:
            secid = f'1.{code}'
    url = f"http://67.push2his.eastmoney.com/api/qt/stock/kline/get"
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36'
    }
    params = {
        'cb': "jQuery11240671737283431526_1624931273440",
        'secid': secid,
        'ut': 'fa5fd1943c7b386f172d6893dbfba10b',
        'fields1': 'f1,f2,f3,f4,f5,f6',
        'fields2': 'f51,f52,f53,f54,f55,f56,f57,f58,f59,f60,f61',
        'klt': period,
        'fqt': 0,
        'end': '20500101',
        'lmt': limit,
        '_': f'{int(time.time()) * 1000}'
    }
    try:
        r = requests.get(url, headers=headers, params=params).text
        r = r.split('(')[1].split(')')[0]
        r = json.loads(r)
        if 'data' in r.keys():
            if isinstance(r['data'], dict) and 'klines' in r['data'].keys():
                r = r['data']['klines']
                r = [i.split(',') for i in r]
                new_data = []
                # new_data = {}
                for i in r:
                    i = {'day': i[0], 'open': float(i[1]), 'close': float(i[2]),
                         'high': float(i[3]), 'low': float(i[4]), 'VOL': int(i[5]),
                         'volume': float(i[6]), 'applies': float(i[8])}
                    new_data.append(i)
                    # new_data[i['day'].replace('-', '')] = i
                return new_data
    except SecurityException() as e:
        print(e)
        return None


def get_benchmark():
    # 获取业绩基准 年&月
    weeks = 53
    logging.warning("查询指数基准...")
    benchmark, benchmark_month = 0, 0
    for index_code in ['399006', '399300', '399905', '000016']:
        index_data = get_stock_kline_with_indicators(index_code, is_index=True, period=102, limit=120)
        index_yield = round((index_data[-1]['close'] - index_data[-weeks]['close']) / index_data[-weeks]['close'] * 100, 2)
        index_month_yield = round((index_data[-1]['close'] - index_data[-5]['close']) / index_data[-5]['close'] * 100,
                                  2)
        if index_yield > benchmark:
            benchmark = index_yield
        if index_month_yield > benchmark_month:
            benchmark_month = index_month_yield
    logging.warning(f"52周涨幅: {benchmark}\t月涨幅: {benchmark_month}")
    return benchmark, benchmark_month


def select_whole_market_stock():
    df = pro.stock_basic(exchange='', list_status='L', fields='ts_code,symbol,name,industry,list_date')
    codes = df.ts_code.values
    names = df.name.values
    industrys = df.industry.values
    stock_list = []
    for code, name, industry in zip(codes, names, industrys):
        tmp = {'code': code, 'name': name, 'industry': industry}
        stock_list.append(tmp)
    return stock_list


def save_whole_market_data_to_redis():
    result = {}
    counter = 0
    client = RedisConn()
    for i in STOCK_LIST:
        counter += 1
        print(i, counter)
        code = i['code'].split('.')[0]
        data = get_stock_kline_with_indicators(code, period=102, limit=120)
        tmp = {'code': code, 'name': i['name'], 'industry': i['industry'], 'kline': data}
        result[code] = tmp
        client.set(f"stock:weekly:{code}", json.dumps(tmp))


def save_market_data_from_redis():
    filename = "weekly_kline.bin"
    with open(filename, 'wb') as f:
        klines = []
        client = RedisConn()
        keys = client.keys("stock:weekly:*")
        for k in keys:
            data = client.get(k).decode()
            data = json.loads(data)
            if not data['kline']:
                print(data['code'])
                continue
            data['kline'] = EMA_V2(EMA_V2(data['kline'], days=10), days=30)
            klines.append(data)
        f.write(pickle.dumps(klines))


def read_weekly_kline():
    weeks = 53
    target = []
    with open("weekly_kline.bin", 'rb') as f:
        content = f.read()
        content = pickle.loads(content)
        counter = 1
        benchmark, month_benchmark = get_benchmark()
        for i in content:
            kline = WeekVolumeCalc(i['kline'])
            if len(kline) >= weeks:
                stock_year_applies = round((kline[-1]["close"] - kline[-weeks]['close']) / kline[-weeks]['close'] * 100, 2)
                # stock_month_applies = round((kline[-1]["close"] - kline[-5]['close']) / kline[-5]['close'] * 100, 2)
                if stock_year_applies >= benchmark:  # and stock_month_applies >= month_benchmark:
                    if kline[-1]['close'] > kline[-1]['ema30'] > kline[-2]['ema30']:
                        # kline = BooleanLine(kline)
                        # if kline[-1]["BBW"] > kline[-2]['BBW'] >= kline[-3]['BBW']:
                        # i['kline'] = kline[-1]
                        # print(f"{counter}\t年涨幅:{stock_year_applies}\t{i}")
                        counter += 1
                        target.append(i)
    return target


def read_monthly_kline(month):
    with open("monthly_kline.bin", 'rb') as f:
        content = f.read()
    content = pickle.loads(content)
    counter = 1
    result = []
    for i in content:
        if month in i['kline'].keys():
            result.append({'code': i['code'], 'name': i['name'], 'volume': i["kline"][month]["volume"]})
            counter += 1
    result = sorted(result, key=lambda x: x['volume'], reverse=True)
    return result


def VolumeStatistical(month):
    data = read_monthly_kline(month=month)
    totalVolume = sum([i['volume'] for i in data])
    topCount = int(len(data)*0.05)
    topCountVolume = sum([i['volume'] for i in data[:topCount]])
    topCountStock = [i['name'] for i in data[:topCount]]
    logging.warning(f"日期: {month}\t全市场总成交量: {totalVolume}\t成交量前5%个股总成交量: {topCountVolume}\t成交量占比: {round(topCountVolume/totalVolume, 2)}\t{len(topCountStock)}\t{topCountStock}")


def WeekVolumeCalc(kline: list, N=10):
    for i in range(len(kline)):
        if i > N:
            tenth_volume = []
            for j in range(i-1, i-(N+1), -1):
                tenth_volume.append(kline[j]['volume'])
            kline[i]['10th_largest'] = max(tenth_volume)
            kline[i]['10th_minimum'] = min(tenth_volume)
            kline[i]['avg_volume'] = sum(tenth_volume) / len(tenth_volume)
            kline[i]['volume_ratio'] = round(kline[i]['volume'] / kline[i]['avg_volume'], 2)
    return kline


def weekly_liner_regression():
    # 使用线性回归函数查询个股周K数据
    weeks = 53
    target = []
    with open("weekly_kline.bin", 'rb') as f:
        content = f.read()
        content = pickle.loads(content)
        benchmark, month_benchmark = get_benchmark()
        for i in content:
            if len(i['kline']) >= weeks:
                kline = EMA_V2(EMA_V2(i['kline'], 5), 10)
                stock_year_applies = round((kline[-1]["close"] - kline[-weeks]['close']) / kline[-weeks]['close'] * 100, 2)
                if stock_year_applies >= benchmark:
                    lr = Linear_Regression(kline[-8:], key="ema10")
                    i['R_Square'], i['slope'], i['intercept'] = lr['R_Square'], lr['slope'], lr['intercept']
                    i['src'] = [i['ema5'] for i in kline[-8:]]
                    i['kline'] = i['kline'][-1]
                    if i['slope'] > 0 and i['R_Square'] > 0.8:
                        target.append(i)
    return sorted(target, key=lambda x: x['R_Square'], reverse=True)


if __name__ == "__main__":
    # save_whole_market_data_to_redis()
    # save_market_data_from_redis()
    pool = [{'code': '688680', 'name': '海优新材'}, {'code': '002756', 'name': '永兴材料'}, {'code': '688981', 'name': '中芯国际'}, {'code': '603213', 'name': '镇洋发展'}, {'code': '688621', 'name': '阳光诺和'}, {'code': '688663', 'name': '新风光'}, {'code': '688257', 'name': '新锐股份'}, {'code': '301129', 'name': '瑞纳智能'}, {'code': '301092', 'name': '争光股份'}, {'code': '688798', 'name': '艾为电子'}, {'code': '688789', 'name': '宏华数科'}, {'code': '688766', 'name': '普冉股份'}, {'code': '688711', 'name': '宏微科技'}, {'code': '688626', 'name': '翔宇医疗'}, {'code': '688596', 'name': '正帆科技'}, {'code': '688578', 'name': '艾力斯'}, {'code': '688559', 'name': '海目星'}, {'code': '688521', 'name': '芯原股份'}, {'code': '688518', 'name': '联赢激光'}, {'code': '688516', 'name': '奥特维'}, {'code': '688360', 'name': '德马科技'}, {'code': '688329', 'name': '艾隆科技'}, {'code': '688319', 'name': '欧林生物'}, {'code': '688305', 'name': '科德数控'}, {'code': '688222', 'name': '成都先导'}, {'code': '688202', 'name': '美迪西'}, {'code': '688180', 'name': '君实生物'}, {'code': '688169', 'name': '石头科技'}, {'code': '688155', 'name': '先惠技术'}, {'code': '688113', 'name': '联测科技'}, {'code': '688092', 'name': '爱科科技'}, {'code': '688059', 'name': '华锐精密'}, {'code': '688037', 'name': '芯源微'}, {'code': '688030', 'name': '山石网科'}, {'code': '605555', 'name': '德昌股份'}, {'code': '605266', 'name': '健之佳'}, {'code': '605186', 'name': '健麾信息'}, {'code': '605050', 'name': '福然德'}, {'code': '605006', 'name': '山东玻纤'}, {'code': '603982', 'name': '泉峰汽车'}, {'code': '603939', 'name': '益丰药房'}, {'code': '603915', 'name': '国茂股份'}, {'code': '603906', 'name': '龙蟠科技'}, {'code': '603901', 'name': '永创智能'}, {'code': '603898', 'name': '好莱客'}, {'code': '603890', 'name': '春秋电子'}, {'code': '603883', 'name': '老百姓'}, {'code': '603825', 'name': '华扬联众'}, {'code': '603818', 'name': '曲美家居'}, {'code': '603799', 'name': '华友钴业'}, {'code': '603730', 'name': '岱美股份'}, {'code': '603722', 'name': '阿科力'}, {'code': '603707', 'name': '健友股份'}, {'code': '603693', 'name': '江苏新能'}, {'code': '603690', 'name': '至纯科技'}, {'code': '603520', 'name': '司太立'}, {'code': '603517', 'name': '绝味食品'}, {'code': '603501', 'name': '韦尔股份'}, {'code': '603486', 'name': '科沃斯'}, {'code': '603466', 'name': '风语筑'}, {'code': '603369', 'name': '今世缘'}, {'code': '603358', 'name': '华达科技'}, {'code': '603345', 'name': '安井食品'}, {'code': '603323', 'name': '苏农银行'}, {'code': '603290', 'name': '斯达半导'}, {'code': '603288', 'name': '海天味业'}, {'code': '603259', 'name': '药明康德'}, {'code': '603256', 'name': '宏和科技'}, {'code': '603220', 'name': '中贝通信'}, {'code': '603179', 'name': '新泉股份'}, {'code': '603127', 'name': '昭衍新药'}, {'code': '603100', 'name': '川仪股份'}, {'code': '603020', 'name': '爱普股份'}, {'code': '603010', 'name': '万盛股份'}, {'code': '603005', 'name': '晶方科技'}, {'code': '601939', 'name': '建设银行'}, {'code': '601918', 'name': '新集能源'}, {'code': '601888', 'name': '中国中免'}, {'code': '601816', 'name': '京沪高铁'}, {'code': '601800', 'name': '中国交建'}, {'code': '601799', 'name': '星宇股份'}, {'code': '601688', 'name': '华泰证券'}, {'code': '601678', 'name': '滨化股份'}, {'code': '601665', 'name': '齐鲁银行'}, {'code': '601633', 'name': '长城汽车'}, {'code': '601618', 'name': '中国中冶'}, {'code': '601601', 'name': '中国太保'}, {'code': '601398', 'name': '工商银行'}, {'code': '601390', 'name': '中国中铁'}, {'code': '601377', 'name': '兴业证券'}, {'code': '601328', 'name': '交通银行'}, {'code': '601298', 'name': '青岛港'}, {'code': '601238', 'name': '广汽集团'}, {'code': '601233', 'name': '桐昆股份'}, {'code': '601211', 'name': '国泰君安'}, {'code': '601200', 'name': '上海环境'}, {'code': '601186', 'name': '中国铁建'}, {'code': '601169', 'name': '北京银行'}, {'code': '601156', 'name': '东航物流'}, {'code': '601138', 'name': '工业富联'}, {'code': '601117', 'name': '中国化学'}, {'code': '601111', 'name': '中国国航'}, {'code': '601100', 'name': '恒立液压'}, {'code': '601021', 'name': '春秋航空'}, {'code': '601009', 'name': '南京银行'}, {'code': '600986', 'name': '浙文互联'}, {'code': '600985', 'name': '淮北矿业'}, {'code': '600973', 'name': '宝胜股份'}, {'code': '600919', 'name': '江苏银行'}, {'code': '600905', 'name': '三峡能源'}, {'code': '600885', 'name': '宏发股份'}, {'code': '600882', 'name': '妙可蓝多'}, {'code': '600859', 'name': '王府井'}, {'code': '600850', 'name': '电科数字'}, {'code': '600845', 'name': '宝信软件'}, {'code': '600821', 'name': '金开新能'}, {'code': '600779', 'name': '水井坊'}, {'code': '600760', 'name': '中航沈飞'}, {'code': '600690', 'name': '海尔智家'}, {'code': '600673', 'name': '东阳光'}, {'code': '600642', 'name': '申能股份'}, {'code': '600641', 'name': '万业企业'}, {'code': '600612', 'name': '老凤祥'}, {'code': '600597', 'name': '光明乳业'}, {'code': '600588', 'name': '用友网络'}, {'code': '600563', 'name': '法拉电子'}, {'code': '600546', 'name': '山煤国际'}, {'code': '600460', 'name': '士兰微'}, {'code': '600456', 'name': '宝钛股份'}, {'code': '600409', 'name': '三友化工'}, {'code': '600406', 'name': '国电南瑞'}, {'code': '600399', 'name': '抚顺特钢'}, {'code': '600379', 'name': '宝光股份'}, {'code': '600372', 'name': '中航电子'}, {'code': '600350', 'name': '山东高速'}, {'code': '600348', 'name': '华阳股份'}, {'code': '600329', 'name': '中新药业'}, {'code': '600316', 'name': '洪都航空'}, {'code': '600277', 'name': '亿利洁能'}, {'code': '600271', 'name': '航天信息'}, {'code': '600259', 'name': '广晟有色'}, {'code': '600180', 'name': '瑞茂通'}, {'code': '600170', 'name': '上海建工'}, {'code': '600153', 'name': '建发股份'}, {'code': '600138', 'name': '中青旅'}, {'code': '600115', 'name': '中国东航'}, {'code': '600104', 'name': '上汽集团'}, {'code': '600096', 'name': '云天化'}, {'code': '600060', 'name': '海信视像'}, {'code': '600038', 'name': '中直股份'}, {'code': '600029', 'name': '南方航空'}, {'code': '600019', 'name': '宝钢股份'}, {'code': '600018', 'name': '上港集团'}, {'code': '600010', 'name': '包钢股份'}, {'code': '600008', 'name': '首创环保'}, {'code': '300538', 'name': '同益股份'}, {'code': '300316', 'name': '晶盛机电'}, {'code': '003043', 'name': '华亚智能'}, {'code': '002938', 'name': '鹏鼎控股'}, {'code': '002930', 'name': '宏川智慧'}, {'code': '002925', 'name': '盈趣科技'}, {'code': '002876', 'name': '三利谱'}, {'code': '002870', 'name': '香山股份'}, {'code': '002833', 'name': '弘亚数控'}, {'code': '002739', 'name': '万达电影'}, {'code': '002727', 'name': '一心堂'}, {'code': '002706', 'name': '良信股份'}, {'code': '002701', 'name': '奥瑞金'}, {'code': '002612', 'name': '朗姿股份'}, {'code': '002568', 'name': '百润股份'}, {'code': '002563', 'name': '森马服饰'}, {'code': '002539', 'name': '云图控股'}, {'code': '002538', 'name': '司尔特'}, {'code': '002517', 'name': '恺英网络'}, {'code': '002466', 'name': '天齐锂业'}, {'code': '002459', 'name': '晶澳科技'}, {'code': '002422', 'name': '科伦药业'}, {'code': '002375', 'name': '亚厦股份'}, {'code': '002354', 'name': '天神娱乐'}, {'code': '002335', 'name': '科华数据'}, {'code': '002318', 'name': '久立特材'}, {'code': '002312', 'name': '川发龙蟒'}, {'code': '002203', 'name': '海亮股份'}, {'code': '002179', 'name': '中航光电'}, {'code': '002156', 'name': '通富微电'}, {'code': '002154', 'name': '报喜鸟'}, {'code': '002044', 'name': '美年健康'}, {'code': '002041', 'name': '登海种业'}, {'code': '002027', 'name': '分众传媒'}, {'code': '002007', 'name': '华兰生物'}, {'code': '001965', 'name': '招商公路'}, {'code': '000959', 'name': '首钢股份'}, {'code': '000938', 'name': '紫光股份'}, {'code': '000913', 'name': '钱江摩托'}, {'code': '000906', 'name': '浙商中拓'}, {'code': '000887', 'name': '中鼎股份'}, {'code': '000858', 'name': '五粮液'}, {'code': '000785', 'name': '居然之家'}, {'code': '000661', 'name': '长春高新'}, {'code': '000656', 'name': '金科股份'}, {'code': '000596', 'name': '古井贡酒'}, {'code': '000547', 'name': '航天发展'}, {'code': '000488', 'name': '晨鸣纸业'}, {'code': '000425', 'name': '徐工机械'}, {'code': '000422', 'name': '湖北宜化'}, {'code': '000400', 'name': '许继电气'}, {'code': '000333', 'name': '美的集团'}, {'code': '000066', 'name': '中国长城'}, {'code': '000045', 'name': '深纺织A'}, {'code': '000012', 'name': '南玻A'}, {'code': '688800', 'name': '瑞可达'}, {'code': '688682', 'name': '霍莱沃'}, {'code': '688667', 'name': '菱电电控'}, {'code': '688617', 'name': '惠泰医疗'}, {'code': '688595', 'name': '芯海科技'}, {'code': '688556', 'name': '高测股份'}, {'code': '688536', 'name': '思瑞浦'}, {'code': '688533', 'name': '上声电子'}, {'code': '688499', 'name': '利元亨'}, {'code': '688385', 'name': '复旦微电'}, {'code': '688366', 'name': '昊海生科'}, {'code': '688303', 'name': '大全能源'}, {'code': '688269', 'name': '凯立新材'}, {'code': '688239', 'name': '航宇科技'}, {'code': '688201', 'name': '信安世纪'}, {'code': '688188', 'name': '柏楚电子'}, {'code': '688186', 'name': '广大特材'}, {'code': '688161', 'name': '威高骨科'}, {'code': '688116', 'name': '天奈科技'}, {'code': '688111', 'name': '金山办公'}, {'code': '688093', 'name': '世华科技'}, {'code': '688087', 'name': '英科再生'}, {'code': '688065', 'name': '凯赛生物'}, {'code': '688033', 'name': '天宜上佳'}, {'code': '688017', 'name': '绿的谐波'}, {'code': '688016', 'name': '心脉医疗'}, {'code': '605339', 'name': '南侨食品'}, {'code': '605338', 'name': '巴比食品'}, {'code': '605166', 'name': '聚合顺'}, {'code': '605117', 'name': '德业股份'}, {'code': '605007', 'name': '五洲特纸'}, {'code': '603936', 'name': '博敏电子'}, {'code': '603916', 'name': '苏博特'}, {'code': '603899', 'name': '晨光文具'}, {'code': '603868', 'name': '飞科电器'}, {'code': '603859', 'name': '能科科技'}, {'code': '603806', 'name': '福斯特'}, {'code': '603727', 'name': '博迈科'}, {'code': '603659', 'name': '璞泰来'}, {'code': '603599', 'name': '广信股份'}, {'code': '603587', 'name': '地素时尚'}, {'code': '603505', 'name': '金石资源'}, {'code': '603456', 'name': '九洲药业'}, {'code': '603396', 'name': '金辰股份'}, {'code': '603393', 'name': '新天然气'}, {'code': '603379', 'name': '三美股份'}, {'code': '603355', 'name': '莱克电气'}, {'code': '603338', 'name': '浙江鼎力'}, {'code': '603337', 'name': '杰克股份'}, {'code': '603305', 'name': '旭升股份'}, {'code': '603267', 'name': '鸿远电子'}, {'code': '603228', 'name': '景旺电子'}, {'code': '603225', 'name': '新凤鸣'}, {'code': '603195', 'name': '公牛集团'}, {'code': '603155', 'name': '新亚强'}, {'code': '603136', 'name': '天目湖'}, {'code': '603129', 'name': '春风动力'}, {'code': '603115', 'name': '海星股份'}, {'code': '603113', 'name': '金能科技'}, {'code': '603108', 'name': '润达医疗'}, {'code': '603039', 'name': '泛微网络'}, {'code': '601998', 'name': '中信银行'}, {'code': '601995', 'name': '中金公司'}, {'code': '601985', 'name': '中国核电'}, {'code': '601868', 'name': '中国能建'}, {'code': '601857', 'name': '中国石油'}, {'code': '601838', 'name': '成都银行'}, {'code': '601818', 'name': '光大银行'}, {'code': '601669', 'name': '中国电建'}, {'code': '601658', 'name': '邮储银行'}, {'code': '601628', 'name': '中国人寿'}, {'code': '601615', 'name': '明阳智能'}, {'code': '601336', 'name': '新华保险'}, {'code': '601333', 'name': '广深铁路'}, {'code': '601288', 'name': '农业银行'}, {'code': '601166', 'name': '兴业银行'}, {'code': '601155', 'name': '新城控股'}, {'code': '601077', 'name': '渝农商行'}, {'code': '601016', 'name': '节能风电'}, {'code': '601012', 'name': '隆基股份'}, {'code': '601006', 'name': '大秦铁路'}, {'code': '601001', 'name': '晋控煤业'}, {'code': '600966', 'name': '博汇纸业'}, {'code': '600958', 'name': '东方证券'}, {'code': '600918', 'name': '中泰证券'}, {'code': '600887', 'name': '伊利股份'}, {'code': '600880', 'name': '博瑞传播'}, {'code': '600837', 'name': '海通证券'}, {'code': '600809', 'name': '山西汾酒'}, {'code': '600803', 'name': '新奥股份'}, {'code': '600764', 'name': '中国海防'}, {'code': '600749', 'name': '西藏旅游'}, {'code': '600741', 'name': '华域汽车'}, {'code': '600705', 'name': '中航产融'}, {'code': '600703', 'name': '三安光电'}, {'code': '600699', 'name': '均胜电子'}, {'code': '600660', 'name': '福耀玻璃'}, {'code': '600655', 'name': '豫园股份'}, {'code': '600619', 'name': '海立股份'}, {'code': '600600', 'name': '青岛啤酒'}, {'code': '600587', 'name': '新华医疗'}, {'code': '600570', 'name': '恒生电子'}, {'code': '600567', 'name': '山鹰国际'}, {'code': '600536', 'name': '中国软件'}, {'code': '600496', 'name': '精工钢构'}, {'code': '600481', 'name': '双良节能'}, {'code': '600378', 'name': '昊华科技'}, {'code': '600360', 'name': '华微电子'}, {'code': '600201', 'name': '生物股份'}, {'code': '600160', 'name': '巨化股份'}, {'code': '600116', 'name': '三峡水利'}, {'code': '600110', 'name': '诺德股份'}, {'code': '600105', 'name': '永鼎股份'}, {'code': '600089', 'name': '特变电工'}, {'code': '600048', 'name': '保利发展'}, {'code': '600039', 'name': '四川路桥'}, {'code': '600031', 'name': '三一重工'}, {'code': '600030', 'name': '中信证券'}, {'code': '600028', 'name': '中国石化'}, {'code': '600012', 'name': '皖通高速'}, {'code': '301080', 'name': '百普赛斯'}, {'code': '301062', 'name': '上海艾录'}, {'code': '301021', 'name': '英诺激光'}, {'code': '301015', 'name': '百洋医药'}, {'code': '300973', 'name': '立高食品'}, {'code': '300917', 'name': '特发服务'}, {'code': '300871', 'name': '回盛生物'}, {'code': '300833', 'name': '浩洋股份'}, {'code': '300824', 'name': '北鼎股份'}, {'code': '300788', 'name': '中信出版'}, {'code': '300776', 'name': '帝尔激光'}, {'code': '300763', 'name': '锦浪科技'}, {'code': '300762', 'name': '上海瀚讯'}, {'code': '300751', 'name': '迈为股份'}, {'code': '300745', 'name': '欣锐科技'}, {'code': '300740', 'name': '水羊股份'}, {'code': '300724', 'name': '捷佳伟创'}, {'code': '300687', 'name': '赛意信息'}, {'code': '300682', 'name': '朗新科技'}, {'code': '300680', 'name': '隆盛科技'}, {'code': '300674', 'name': '宇信科技'}, {'code': '300636', 'name': '同和药业'}, {'code': '300633', 'name': '开立医疗'}, {'code': '300627', 'name': '华测导航'}, {'code': '300587', 'name': '天铁股份'}, {'code': '300566', 'name': '激智科技'}, {'code': '300474', 'name': '景嘉微'}, {'code': '300450', 'name': '先导智能'}, {'code': '300447', 'name': '全信股份'}, {'code': '300428', 'name': '立中集团'}, {'code': '300406', 'name': '九强生物'}, {'code': '300398', 'name': '飞凯材料'}, {'code': '300395', 'name': '菲利华'}, {'code': '300363', 'name': '博腾股份'}, {'code': '300294', 'name': '博雅生物'}, {'code': '300274', 'name': '阳光电源'}, {'code': '300166', 'name': '东方国信'}, {'code': '300143', 'name': '盈康生命'}, {'code': '300133', 'name': '华策影视'}, {'code': '300122', 'name': '智飞生物'}, {'code': '300101', 'name': '振芯科技'}, {'code': '300075', 'name': '数字政通'}, {'code': '300009', 'name': '安科生物'}, {'code': '003031', 'name': '中瓷电子'}, {'code': '002935', 'name': '天奥电子'}, {'code': '002920', 'name': '德赛西威'}, {'code': '002919', 'name': '名臣健康'}, {'code': '002884', 'name': '凌霄泵业'}, {'code': '002881', 'name': '美格智能'}, {'code': '002867', 'name': '周大生'}, {'code': '002832', 'name': '比音勒芬'}, {'code': '002824', 'name': '和胜股份'}, {'code': '002797', 'name': '第一创业'}, {'code': '002790', 'name': '瑞尔特'}, {'code': '002778', 'name': '中晟高科'}, {'code': '002765', 'name': '蓝黛科技'}, {'code': '002747', 'name': '埃斯顿'}, {'code': '002732', 'name': '燕塘乳业'}, {'code': '002687', 'name': '乔治白'}, {'code': '002651', 'name': '利君股份'}, {'code': '002645', 'name': '华宏科技'}, {'code': '002615', 'name': '哈尔斯'}, {'code': '002609', 'name': '捷顺科技'}, {'code': '002597', 'name': '金禾实业'}, {'code': '002557', 'name': '洽洽食品'}, {'code': '002405', 'name': '四维图新'}, {'code': '002390', 'name': '信邦制药'}, {'code': '002371', 'name': '北方华创'}, {'code': '002368', 'name': '太极股份'}, {'code': '002345', 'name': '潮宏基'}, {'code': '002268', 'name': '卫士通'}, {'code': '002266', 'name': '浙富控股'}, {'code': '002185', 'name': '华天科技'}, {'code': '002180', 'name': '纳思达'}, {'code': '002142', 'name': '宁波银行'}, {'code': '002068', 'name': '黑猫股份'}, {'code': '002003', 'name': '伟星股份'}, {'code': '002001', 'name': '新和成'}, {'code': '000983', 'name': '山西焦煤'}, {'code': '000930', 'name': '中粮科技'}, {'code': '000776', 'name': '广发证券'}, {'code': '000768', 'name': '中航西飞'}, {'code': '000762', 'name': '西藏矿业'}, {'code': '000725', 'name': '京东方A'}, {'code': '000683', 'name': '远兴能源'}, {'code': '000682', 'name': '东方电子'}, {'code': '000681', 'name': '视觉中国'}, {'code': '000636', 'name': '风华高科'}, {'code': '000568', 'name': '泸州老窖'}, {'code': '000560', 'name': '我爱我家'}, {'code': '000301', 'name': '东方盛虹'}, {'code': '000157', 'name': '中联重科'}, {'code': '000089', 'name': '深圳机场'}, {'code': '688793', 'name': '倍轻松'}, {'code': '688733', 'name': '壹石通'}, {'code': '688696', 'name': '极米科技'}, {'code': '688690', 'name': '纳微科技'}, {'code': '688677', 'name': '海泰新光'}, {'code': '688661', 'name': '和林微纳'}, {'code': '688639', 'name': '华恒生物'}, {'code': '688599', 'name': '天合光能'}, {'code': '688589', 'name': '力合微'}, {'code': '688586', 'name': '江航装备'}, {'code': '688580', 'name': '伟思医疗'}, {'code': '688568', 'name': '中科星图'}, {'code': '688558', 'name': '国盛智科'}, {'code': '688526', 'name': '科前生物'}, {'code': '688508', 'name': '芯朋微'}, {'code': '688390', 'name': '固德威'}, {'code': '688369', 'name': '致远互联'}, {'code': '688356', 'name': '键凯科技'}, {'code': '688299', 'name': '长阳科技'}, {'code': '688296', 'name': '和达科技'}, {'code': '688268', 'name': '华特气体'}, {'code': '688216', 'name': '气派科技'}, {'code': '688181', 'name': '八亿时空'}, {'code': '688179', 'name': '阿拉丁'}, {'code': '688177', 'name': '百奥泰'}, {'code': '688133', 'name': '泰坦科技'}, {'code': '688099', 'name': '晶晨股份'}, {'code': '688066', 'name': '航天宏图'}, {'code': '688050', 'name': '爱博医疗'}, {'code': '688029', 'name': '南微医学'}, {'code': '688028', 'name': '沃尔德'}, {'code': '688012', 'name': '中微公司'}, {'code': '688005', 'name': '容百科技'}, {'code': '605499', 'name': '东鹏饮料'}, {'code': '605305', 'name': '中际联合'}, {'code': '605155', 'name': '西大门'}, {'code': '605136', 'name': '丽人丽妆'}, {'code': '605123', 'name': '派克新材'}, {'code': '605098', 'name': '行动教育'}, {'code': '605089', 'name': '味知香'}, {'code': '603997', 'name': '继峰股份'}, {'code': '603986', 'name': '兆易创新'}, {'code': '603979', 'name': '金诚信'}, {'code': '603956', 'name': '威派格'}, {'code': '603938', 'name': '三孚股份'}, {'code': '603908', 'name': '牧高笛'}, {'code': '603893', 'name': '瑞芯微'}, {'code': '603889', 'name': '新澳股份'}, {'code': '603885', 'name': '吉祥航空'}, {'code': '603855', 'name': '华荣股份'}, {'code': '603848', 'name': '好太太'}, {'code': '603833', 'name': '欧派家居'}, {'code': '603816', 'name': '顾家家居'}, {'code': '603809', 'name': '豪能股份'}, {'code': '603713', 'name': '密尔克卫'}, {'code': '603712', 'name': '七一二'}, {'code': '603667', 'name': '五洲新春'}, {'code': '603663', 'name': '三祥新材'}, {'code': '603613', 'name': '国联股份'}, {'code': '603612', 'name': '索通发展'}, {'code': '603605', 'name': '珀莱雅'}, {'code': '603596', 'name': '伯特利'}, {'code': '603589', 'name': '口子窖'}, {'code': '603588', 'name': '高能环境'}, {'code': '603579', 'name': '荣泰健康'}, {'code': '603568', 'name': '伟明环保'}, {'code': '603567', 'name': '珍宝岛'}, {'code': '603515', 'name': '欧普照明'}, {'code': '603489', 'name': '八方股份'}, {'code': '603392', 'name': '万泰生物'}, {'code': '603365', 'name': '水星家纺'}, {'code': '603297', 'name': '永新光学'}, {'code': '603198', 'name': '迎驾贡酒'}, {'code': '603197', 'name': '保隆科技'}, {'code': '603180', 'name': '金牌厨柜'}, {'code': '603043', 'name': '广州酒家'}, {'code': '603019', 'name': '中科曙光'}, {'code': '603008', 'name': '喜临门'}, {'code': '603001', 'name': '奥康国际'}, {'code': '601952', 'name': '苏垦农发'}, {'code': '601898', 'name': '中煤能源'}, {'code': '601878', 'name': '浙商证券'}, {'code': '601702', 'name': '华峰铝业'}, {'code': '601699', 'name': '潞安环能'}, {'code': '601231', 'name': '环旭电子'}, {'code': '601229', 'name': '上海银行'}, {'code': '601139', 'name': '深圳燃气'}, {'code': '601003', 'name': '柳钢股份'}, {'code': '600989', 'name': '宝丰能源'}, {'code': '600967', 'name': '内蒙一机'}, {'code': '600963', 'name': '岳阳林纸'}, {'code': '600933', 'name': '爱柯迪'}, {'code': '600916', 'name': '中国黄金'}, {'code': '600893', 'name': '航发动力'}, {'code': '600884', 'name': '杉杉股份'}, {'code': '600867', 'name': '通化东宝'}, {'code': '600820', 'name': '隧道股份'}, {'code': '600733', 'name': '北汽蓝谷'}, {'code': '600711', 'name': '盛屯矿业'}, {'code': '600688', 'name': '上海石化'}, {'code': '600584', 'name': '长电科技'}, {'code': '600556', 'name': '天下秀'}, {'code': '600502', 'name': '安徽建工'}, {'code': '600487', 'name': '亨通光电'}, {'code': '600483', 'name': '福能股份'}, {'code': '600461', 'name': '洪城环境'}, {'code': '600426', 'name': '华鲁恒升'}, {'code': '600398', 'name': '海澜之家'}, {'code': '600346', 'name': '恒力石化'}, {'code': '600323', 'name': '瀚蓝环境'}, {'code': '600285', 'name': '羚锐制药'}, {'code': '600197', 'name': '伊力特'}, {'code': '600183', 'name': '生益科技'}, {'code': '600163', 'name': '中闽能源'}, {'code': '600161', 'name': '天坛生物'}, {'code': '600157', 'name': '永泰能源'}, {'code': '600025', 'name': '华能水电'}, {'code': '301035', 'name': '润丰股份'}, {'code': '301011', 'name': '华立科技'}, {'code': '300982', 'name': '苏文电能'}, {'code': '300979', 'name': '华利集团'}, {'code': '300919', 'name': '中伟股份'}, {'code': '300911', 'name': '亿田智能'}, {'code': '300893', 'name': '松原股份'}, {'code': '300866', 'name': '安克创新'}, {'code': '300811', 'name': '铂科新材'}, {'code': '300791', 'name': '仙乐健康'}, {'code': '300772', 'name': '运达股份'}, {'code': '300770', 'name': '新媒股份'}, {'code': '300769', 'name': '德方纳米'}, {'code': '300759', 'name': '康龙化成'}, {'code': '300750', 'name': '宁德时代'}, {'code': '300737', 'name': '科顺股份'}, {'code': '300725', 'name': '药石科技'}, {'code': '300709', 'name': '精研科技'}, {'code': '300679', 'name': '电连技术'}, {'code': '300616', 'name': '尚品宅配'}, {'code': '300573', 'name': '兴齐眼药'}, {'code': '300502', 'name': '新易盛'}, {'code': '300496', 'name': '中科创达'}, {'code': '300480', 'name': '光力科技'}, {'code': '300470', 'name': '中密控股'}, {'code': '300465', 'name': '高伟达'}, {'code': '300438', 'name': '鹏辉能源'}, {'code': '300413', 'name': '芒果超媒'}, {'code': '300371', 'name': '汇中股份'}, {'code': '300346', 'name': '南大光电'}, {'code': '300331', 'name': '苏大维格'}, {'code': '300280', 'name': '紫天科技'}, {'code': '300268', 'name': '佳沃食品'}, {'code': '300260', 'name': '新莱应材'}, {'code': '300253', 'name': '卫宁健康'}, {'code': '300219', 'name': '鸿利智汇'}, {'code': '300207', 'name': '欣旺达'}, {'code': '300196', 'name': '长海股份'}, {'code': '300182', 'name': '捷成股份'}, {'code': '300171', 'name': '东富龙'}, {'code': '300168', 'name': '万达信息'}, {'code': '300124', 'name': '汇川技术'}, {'code': '300073', 'name': '当升科技'}, {'code': '300035', 'name': '中科电气'}, {'code': '300014', 'name': '亿纬锂能'}, {'code': '300012', 'name': '华测检测'}, {'code': '003022', 'name': '联泓新科'}, {'code': '003013', 'name': '地铁设计'}, {'code': '002953', 'name': '日丰股份'}, {'code': '002949', 'name': '华阳国际'}, {'code': '002859', 'name': '洁美科技'}, {'code': '002853', 'name': '皮阿诺'}, {'code': '002815', 'name': '崇达技术'}, {'code': '002791', 'name': '坚朗五金'}, {'code': '002777', 'name': '久远银海'}, {'code': '002745', 'name': '木林森'}, {'code': '002690', 'name': '美亚光电'}, {'code': '002572', 'name': '索菲亚'}, {'code': '002553', 'name': '南方轴承'}, {'code': '002541', 'name': '鸿路钢构'}, {'code': '002532', 'name': '天山铝业'}, {'code': '002484', 'name': '江海股份'}, {'code': '002475', 'name': '立讯精密'}, {'code': '002472', 'name': '双环传动'}, {'code': '002444', 'name': '巨星科技'}, {'code': '002438', 'name': '江苏神通'}, {'code': '002419', 'name': '天虹股份'}, {'code': '002414', 'name': '高德红外'}, {'code': '002409', 'name': '雅克科技'}, {'code': '002408', 'name': '齐翔腾达'}, {'code': '002396', 'name': '星网锐捷'}, {'code': '002372', 'name': '伟星新材'}, {'code': '002361', 'name': '神剑股份'}, {'code': '002332', 'name': '仙琚制药'}, {'code': '002327', 'name': '富安娜'}, {'code': '002286', 'name': '保龄宝'}, {'code': '002277', 'name': '友阿股份'}, {'code': '002250', 'name': '联化科技'}, {'code': '002139', 'name': '拓邦股份'}, {'code': '002088', 'name': '鲁阳节能'}, {'code': '002078', 'name': '太阳纸业'}, {'code': '002042', 'name': '华孚时尚'}, {'code': '001979', 'name': '招商蛇口'}, {'code': '001914', 'name': '招商积余'}, {'code': '000818', 'name': '航锦科技'}, {'code': '000723', 'name': '美锦能源'}, {'code': '000703', 'name': '恒逸石化'}, {'code': '000672', 'name': '上峰水泥'}, {'code': '688779', 'name': '长远锂科'}, {'code': '688777', 'name': '中控技术'}, {'code': '688698', 'name': '伟创电气'}, {'code': '688622', 'name': '禾信仪器'}, {'code': '688608', 'name': '恒玄科技'}, {'code': '688601', 'name': '力芯微'}, {'code': '688519', 'name': '南亚新材'}, {'code': '688398', 'name': '赛特新材'}, {'code': '688396', 'name': '华润微'}, {'code': '688363', 'name': '华熙生物'}, {'code': '688300', 'name': '联瑞新材'}, {'code': '688196', 'name': '卓越新能'}, {'code': '688139', 'name': '海尔生物'}, {'code': '688131', 'name': '皓元医药'}, {'code': '688056', 'name': '莱伯泰科'}, {'code': '605376', 'name': '博迁新材'}, {'code': '605337', 'name': '李子园'}, {'code': '605080', 'name': '浙江自然'}, {'code': '605003', 'name': '众望布艺'}, {'code': '603987', 'name': '康德莱'}, {'code': '603578', 'name': '三星新材'}, {'code': '603308', 'name': '应流股份'}, {'code': '603277', 'name': '银都股份'}, {'code': '603260', 'name': '合盛硅业'}, {'code': '601668', 'name': '中国建筑'}, {'code': '601339', 'name': '百隆东方'}, {'code': '601225', 'name': '陕西煤业'}, {'code': '600970', 'name': '中材国际'}, {'code': '600862', 'name': '中航高科'}, {'code': '600610', 'name': '中毅达'}, {'code': '600517', 'name': '国网英大'}, {'code': '600380', 'name': '健康元'}, {'code': '600315', 'name': '上海家化'}, {'code': '600219', 'name': '南山铝业'}, {'code': '600196', 'name': '复星医药'}, {'code': '600114', 'name': '东睦股份'}, {'code': '600066', 'name': '宇通客车'}, {'code': '600057', 'name': '厦门象屿'}, {'code': '301088', 'name': '戎美股份'}, {'code': '301061', 'name': '匠心家居'}, {'code': '301050', 'name': '雷电微力'}, {'code': '301031', 'name': '中熔电气'}, {'code': '301030', 'name': '仕净科技'}, {'code': '301029', 'name': '怡合达'}, {'code': '301018', 'name': '申菱环境'}, {'code': '300957', 'name': '贝泰妮'}, {'code': '300951', 'name': '博硕科技'}, {'code': '300915', 'name': '海融科技'}, {'code': '300908', 'name': '仲景食品'}, {'code': '300894', 'name': '火星人'}, {'code': '300861', 'name': '美畅股份'}, {'code': '300850', 'name': '新强联'}, {'code': '300835', 'name': '龙磁科技'}, {'code': '300806', 'name': '斯迪克'}, {'code': '300793', 'name': '佳禾智能'}, {'code': '300785', 'name': '值得买'}, {'code': '300768', 'name': '迪普科技'}, {'code': '300757', 'name': '罗博特科'}, {'code': '300738', 'name': '奥飞数据'}, {'code': '300681', 'name': '英搏尔'}, {'code': '300677', 'name': '英科医疗'}, {'code': '300662', 'name': '科锐国际'}, {'code': '300661', 'name': '圣邦股份'}, {'code': '300620', 'name': '光库科技'}, {'code': '300617', 'name': '安靠智电'}, {'code': '300590', 'name': '移为通信'}, {'code': '300577', 'name': '开润股份'}, {'code': '300529', 'name': '健帆生物'}, {'code': '300505', 'name': '川金诺'}, {'code': '300463', 'name': '迈克生物'}, {'code': '300451', 'name': '创业慧康'}, {'code': '300408', 'name': '三环集团'}, {'code': '300404', 'name': '博济医药'}, {'code': '300382', 'name': '斯莱克'}, {'code': '300357', 'name': '我武生物'}, {'code': '300296', 'name': '利亚德'}, {'code': '300223', 'name': '北京君正'}, {'code': '300218', 'name': '安利股份'}, {'code': '300119', 'name': '瑞普生物'}, {'code': '300114', 'name': '中航电测'}, {'code': '300037', 'name': '新宙邦'}, {'code': '300036', 'name': '超图软件'}, {'code': '300034', 'name': '钢研高纳'}, {'code': '300033', 'name': '同花顺'}, {'code': '300031', 'name': '宝通科技'}, {'code': '300007', 'name': '汉威科技'}, {'code': '003025', 'name': '思进智能'}, {'code': '002961', 'name': '瑞达期货'}, {'code': '002960', 'name': '青鸟消防'}, {'code': '002946', 'name': '新乳业'}, {'code': '002922', 'name': '伊戈尔'}, {'code': '002918', 'name': '蒙娜丽莎'}, {'code': '002906', 'name': '华阳集团'}, {'code': '002860', 'name': '星帅尔'}, {'code': '002850', 'name': '科达利'}, {'code': '002831', 'name': '裕同科技'}, {'code': '002821', 'name': '凯莱英'}, {'code': '002709', 'name': '天赐材料'}, {'code': '002595', 'name': '豪迈科技'}, {'code': '002559', 'name': '亚威股份'}, {'code': '002520', 'name': '日发精机'}, {'code': '002493', 'name': '荣盛石化'}, {'code': '002465', 'name': '海格通信'}, {'code': '002460', 'name': '赣锋锂业'}, {'code': '002434', 'name': '万里扬'}, {'code': '002410', 'name': '广联达'}, {'code': '002353', 'name': '杰瑞股份'}, {'code': '002304', 'name': '洋河股份'}, {'code': '002281', 'name': '光迅科技'}, {'code': '002271', 'name': '东方雨虹'}, {'code': '002241', 'name': '歌尔股份'}, {'code': '002230', 'name': '科大讯飞'}, {'code': '002206', 'name': '海利得'}, {'code': '002183', 'name': '怡亚通'}, {'code': '002149', 'name': '西部材料'}, {'code': '002035', 'name': '华帝股份'}, {'code': '002032', 'name': '苏泊尔'}, {'code': '002015', 'name': '协鑫能科'}, {'code': '001215', 'name': '千味央厨'}, {'code': '000977', 'name': '浪潮信息'}, {'code': '000928', 'name': '中钢国际'}, {'code': '000830', 'name': '鲁西化工'}, {'code': '000811', 'name': '冰轮环境'}, {'code': '000786', 'name': '北新建材'}, {'code': '000651', 'name': '格力电器'}, {'code': '000526', 'name': '学大教育'}, {'code': '000507', 'name': '珠海港'}, {'code': '000100', 'name': 'TCL科技'}, {'code': '000062', 'name': '深圳华强'}, {'code': '000035', 'name': '中国天楹'}, {'code': '689009', 'name': '九号公司'}, {'code': '688700', 'name': '东威科技'}, {'code': '688636', 'name': '智明达'}, {'code': '688598', 'name': '金博股份'}, {'code': '688330', 'name': '宏力达'}, {'code': '688315', 'name': '诺禾致源'}, {'code': '688311', 'name': '盟升电子'}, {'code': '688233', 'name': '神工股份'}, {'code': '688208', 'name': '道通科技'}, {'code': '688166', 'name': '博瑞医药'}, {'code': '688078', 'name': '龙软科技'}, {'code': '688076', 'name': '诺泰生物'}, {'code': '688036', 'name': '传音控股'}, {'code': '688018', 'name': '乐鑫科技'}, {'code': '605336', 'name': '帅丰电器'}, {'code': '605289', 'name': '罗曼股份'}, {'code': '605268', 'name': '王力安防'}, {'code': '605180', 'name': '华生科技'}, {'code': '603882', 'name': '金域医学'}, {'code': '603801', 'name': '志邦家居'}, {'code': '603733', 'name': '仙鹤股份'}, {'code': '603658', 'name': '安图生物'}, {'code': '603558', 'name': '健盛集团'}, {'code': '603236', 'name': '移远通信'}, {'code': '603232', 'name': '格尔软件'}, {'code': '603229', 'name': '奥翔药业'}, {'code': '603105', 'name': '芯能科技'}, {'code': '603035', 'name': '常熟汽饰'}, {'code': '601677', 'name': '明泰铝业'}, {'code': '601666', 'name': '平煤股份'}, {'code': '601577', 'name': '长沙银行'}, {'code': '601311', 'name': '骆驼股份'}, {'code': '601015', 'name': '陕西黑猫'}, {'code': '600999', 'name': '招商证券'}, {'code': '600998', 'name': '九州通'}, {'code': '600817', 'name': '宇通重工'}, {'code': '600740', 'name': '山西焦化'}, {'code': '600728', 'name': '佳都科技'}, {'code': '600674', 'name': '川投能源'}, {'code': '600529', 'name': '山东药玻'}, {'code': '600516', 'name': '方大炭素'}, {'code': '600499', 'name': '科达制造'}, {'code': '600438', 'name': '通威股份'}, {'code': '600216', 'name': '浙江医药'}, {'code': '600176', 'name': '中国巨石'}, {'code': '600123', 'name': '兰花科创'}, {'code': '600063', 'name': '皖维高新'}, {'code': '301071', 'name': '力量钻石'}, {'code': '301055', 'name': '张小泉'}, {'code': '301002', 'name': '崧盛股份'}, {'code': '300994', 'name': '久祺股份'}, {'code': '300977', 'name': '深圳瑞捷'}, {'code': '300967', 'name': '晓鸣股份'}, {'code': '300953', 'name': '震裕科技'}, {'code': '300887', 'name': '谱尼测试'}, {'code': '300837', 'name': '浙矿股份'}, {'code': '300790', 'name': '宇瞳光学'}, {'code': '300786', 'name': '国林科技'}, {'code': '300747', 'name': '锐科激光'}, {'code': '300726', 'name': '宏达电子'}, {'code': '300718', 'name': '长盛轴承'}, {'code': '300705', 'name': '九典制药'}, {'code': '300699', 'name': '光威复材'}, {'code': '300685', 'name': '艾德生物'}, {'code': '300648', 'name': '星云股份'}, {'code': '300630', 'name': '普利制药'}, {'code': '300628', 'name': '亿联网络'}, {'code': '300618', 'name': '寒锐钴业'}, {'code': '300596', 'name': '利安隆'}, {'code': '300595', 'name': '欧普康视'}, {'code': '300501', 'name': '海顺新材'}, {'code': '300482', 'name': '万孚生物'}, {'code': '300476', 'name': '胜宏科技'}, {'code': '300458', 'name': '全志科技'}, {'code': '300416', 'name': '苏试试验'}, {'code': '300383', 'name': '光环新网'}, {'code': '300319', 'name': '麦捷科技'}, {'code': '300250', 'name': '初灵信息'}, {'code': '300226', 'name': '上海钢联'}, {'code': '300217', 'name': '东方电热'}, {'code': '300212', 'name': '易华录'}, {'code': '300146', 'name': '汤臣倍健'}, {'code': '300138', 'name': '晨光生物'}, {'code': '300019', 'name': '硅宝科技'}, {'code': '300015', 'name': '爱尔眼科'}, {'code': '002979', 'name': '雷赛智能'}, {'code': '002978', 'name': '安宁股份'}, {'code': '002901', 'name': '大博医疗'}, {'code': '002851', 'name': '麦格米特'}, {'code': '002839', 'name': '张家港行'}, {'code': '002837', 'name': '英维克'}, {'code': '002812', 'name': '恩捷股份'}, {'code': '002659', 'name': '凯文教育'}, {'code': '002643', 'name': '万润股份'}, {'code': '002601', 'name': '龙佰集团'}, {'code': '002533', 'name': '金杯电工'}, {'code': '002497', 'name': '雅化集团'}, {'code': '002483', 'name': '润邦股份'}, {'code': '002453', 'name': '华软科技'}, {'code': '002430', 'name': '杭氧股份'}, {'code': '002416', 'name': '爱施德'}, {'code': '002402', 'name': '和而泰'}, {'code': '002384', 'name': '东山精密'}, {'code': '002330', 'name': '得利斯'}, {'code': '002294', 'name': '信立泰'}, {'code': '002287', 'name': '奇正藏药'}, {'code': '002284', 'name': '亚太股份'}, {'code': '002270', 'name': '华明装备'}, {'code': '002262', 'name': '恩华药业'}, {'code': '002258', 'name': '利尔化学'}, {'code': '002245', 'name': '蔚蓝锂芯'}, {'code': '002240', 'name': '盛新锂能'}, {'code': '002170', 'name': '芭田股份'}, {'code': '002129', 'name': '中环股份'}, {'code': '002119', 'name': '康强电子'}, {'code': '002060', 'name': '粤水电'}, {'code': '002050', 'name': '三花智控'}, {'code': '002049', 'name': '紫光国微'}, {'code': '002026', 'name': '山东威达'}, {'code': '002025', 'name': '航天电器'}, {'code': '002011', 'name': '盾安环境'}, {'code': '002010', 'name': '传化智联'}, {'code': '002009', 'name': '天奇股份'}, {'code': '002008', 'name': '大族激光'}, {'code': '000932', 'name': '华菱钢铁'}, {'code': '000875', 'name': '吉电股份'}, {'code': '000738', 'name': '航发控制'}, {'code': '000657', 'name': '中钨高新'}, {'code': '000567', 'name': '海德股份'}, {'code': '000513', 'name': '丽珠集团'}, {'code': '000155', 'name': '川能动力'}, {'code': '000063', 'name': '中兴通讯'}, {'code': '000026', 'name': '飞亚达'}, {'code': '000009', 'name': '中国宝安'}, {'code': '688551', 'name': '科威尔'}, {'code': '688550', 'name': '瑞联新材'}, {'code': '688085', 'name': '三友医疗'}, {'code': '605358', 'name': '立昂微'}, {'code': '600765', 'name': '中航重机'}, {'code': '300896', 'name': '爱美客'}, {'code': '300696', 'name': '爱乐达'}, {'code': '300655', 'name': '晶瑞电材'}, {'code': '300613', 'name': '富瀚微'}, {'code': '300604', 'name': '长川科技'}, {'code': '300251', 'name': '光线传媒'}, {'code': '300232', 'name': '洲明科技'}, {'code': '300144', 'name': '宋城演艺'}, {'code': '003032', 'name': '传智教育'}, {'code': '002988', 'name': '豪美新材'}, {'code': '002985', 'name': '北摩高科'}, {'code': '002915', 'name': '中欣氟材'}, {'code': '002913', 'name': '奥士康'}, {'code': '002895', 'name': '川恒股份'}, {'code': '002805', 'name': '丰元股份'}, {'code': '002677', 'name': '浙江美大'}, {'code': '002637', 'name': '赞宇科技'}, {'code': '002549', 'name': '凯美特气'}, {'code': '002518', 'name': '科士达'}, {'code': '002283', 'name': '天润工业'}, {'code': '002064', 'name': '华峰化学'}, {'code': '002013', 'name': '中航机电'}, {'code': '000893', 'name': '亚钾国际'}, {'code': '000733', 'name': '振华科技'}, {'code': '000498', 'name': '山东路桥'}, {'code': '688686', 'name': '奥普特'}, {'code': '688389', 'name': '普门科技'}, {'code': '688200', 'name': '华峰测控'}, {'code': '688083', 'name': '中望软件'}, {'code': '688007', 'name': '光峰科技'}, {'code': '603985', 'name': '恒润股份'}, {'code': '603919', 'name': '金徽酒'}, {'code': '603688', 'name': '石英股份'}, {'code': '603383', 'name': '顶点软件'}, {'code': '603156', 'name': '养元饮品'}, {'code': '603128', 'name': '华贸物流'}, {'code': '601728', 'name': '中国电信'}, {'code': '601168', 'name': '西部矿业'}, {'code': '601088', 'name': '中国神华'}, {'code': '600873', 'name': '梅花生物'}, {'code': '600869', 'name': '远东股份'}, {'code': '600590', 'name': '泰豪科技'}, {'code': '600519', 'name': '贵州茅台'}, {'code': '600395', 'name': '盘江股份'}, {'code': '600298', 'name': '安琪酵母'}, {'code': '600171', 'name': '上海贝岭'}, {'code': '600036', 'name': '招商银行'}, {'code': '300715', 'name': '凯伦股份'}, {'code': '300688', 'name': '创业黑马'}, {'code': '300593', 'name': '新雷能'}, {'code': '300481', 'name': '濮阳惠成'}, {'code': '300347', 'name': '泰格医药'}, {'code': '300244', 'name': '迪安诊断'}, {'code': '300162', 'name': '雷曼光电'}, {'code': '300088', 'name': '长信科技'}, {'code': '002818', 'name': '富森美'}, {'code': '002683', 'name': '宏大爆破'}, {'code': '002648', 'name': '卫星化学'}, {'code': '002461', 'name': '珠江啤酒'}, {'code': '002415', 'name': '海康威视'}, {'code': '002392', 'name': '北京利尔'}, {'code': '002391', 'name': '长青股份'}, {'code': '002293', 'name': '罗莱生活'}, {'code': '002273', 'name': '水晶光电'}, {'code': '002254', 'name': '泰和新材'}, {'code': '002234', 'name': '民和股份'}, {'code': '002191', 'name': '劲嘉股份'}, {'code': '002152', 'name': '广电运通'}, {'code': '002117', 'name': '东港股份'}, {'code': '002028', 'name': '思源电气'}, {'code': '000933', 'name': '神火股份'}, {'code': '000915', 'name': '华特达因'}, {'code': '000799', 'name': '酒鬼酒'}, {'code': '000789', 'name': '万年青'}, {'code': '000090', 'name': '天健集团'}, {'code': '688707', 'name': '振华新材'}, {'code': '688368', 'name': '晶丰明源'}, {'code': '688301', 'name': '奕瑞科技'}, {'code': '688122', 'name': '西部超导'}, {'code': '688063', 'name': '派能科技'}, {'code': '605369', 'name': '拱东医疗'}, {'code': '605111', 'name': '新洁能'}, {'code': '603719', 'name': '良品铺子'}, {'code': '603617', 'name': '君禾股份'}, {'code': '603606', 'name': '东方电缆'}, {'code': '603444', 'name': '吉比特'}, {'code': '603359', 'name': '东珠生态'}, {'code': '603324', 'name': '盛剑环境'}, {'code': '603186', 'name': '华正新材'}, {'code': '603131', 'name': '上海沪工'}, {'code': '601689', 'name': '拓普集团'}, {'code': '601609', 'name': '金田铜业'}, {'code': '600976', 'name': '健民集团'}, {'code': '600746', 'name': '江苏索普'}, {'code': '600702', 'name': '舍得酒业'}, {'code': '600367', 'name': '红星发展'}, {'code': '600050', 'name': '中国联通'}, {'code': '300980', 'name': '祥源新材'}, {'code': '300873', 'name': '海晨股份'}, {'code': '300802', 'name': '矩子科技'}, {'code': '300782', 'name': '卓胜微'}, {'code': '300755', 'name': '华致酒行'}, {'code': '300723', 'name': '一品红'}, {'code': '300601', 'name': '康泰生物'}, {'code': '300379', 'name': '东方通'}, {'code': '300358', 'name': '楚天科技'}, {'code': '300327', 'name': '中颖电子'}, {'code': '300285', 'name': '国瓷材料'}, {'code': '003016', 'name': '欣贺股份'}, {'code': '002873', 'name': '新天药业'}, {'code': '000976', 'name': '华铁股份'}, {'code': '000739', 'name': '普洛药业'}, {'code': '688668', 'name': '鼎通科技'}, {'code': '688308', 'name': '欧科亿'}, {'code': '603610', 'name': '麒盛科技'}, {'code': '603298', 'name': '杭叉集团'}, {'code': '603279', 'name': '景津环保'}, {'code': '603185', 'name': '上机数控'}, {'code': '601865', 'name': '福莱特'}, {'code': '601128', 'name': '常熟银行'}, {'code': '600926', 'name': '杭州银行'}, {'code': '600901', 'name': '江苏租赁'}, {'code': '600511', 'name': '国药股份'}, {'code': '600256', 'name': '广汇能源'}, {'code': '600111', 'name': '北方稀土'}, {'code': '300821', 'name': '东岳硅材'}, {'code': '300748', 'name': '金力永磁'}, {'code': '300582', 'name': '英飞特'}, {'code': '300508', 'name': '维宏股份'}, {'code': '300443', 'name': '金雷股份'}, {'code': '002436', 'name': '兴森科技'}, {'code': '000534', 'name': '万泽股份'}, {'code': '000001', 'name': '平安银行'}, {'code': '688665', 'name': '四方光电'}, {'code': '688388', 'name': '嘉元科技'}, {'code': '688100', 'name': '威胜信息'}, {'code': '603877', 'name': '太平鸟'}, {'code': '603386', 'name': '广东骏亚'}, {'code': '601965', 'name': '中国汽研'}, {'code': '600330', 'name': '天通股份'}, {'code': '600258', 'name': '首旅酒店'}, {'code': '300760', 'name': '迈瑞医疗'}, {'code': '300653', 'name': '正海生物'}, {'code': '300639', 'name': '凯普生物'}, {'code': '300623', 'name': '捷捷微电'}, {'code': '300580', 'name': '贝斯特'}, {'code': '300568', 'name': '星源材质'}, {'code': '300487', 'name': '蓝晓科技'}, {'code': '002968', 'name': '新大正'}, {'code': '002508', 'name': '老板电器'}, {'code': '002080', 'name': '中材科技'}, {'code': '002048', 'name': '宁波华翔'}, {'code': '000848', 'name': '承德露露'}, {'code': '000403', 'name': '派林生物'}, {'code': '688670', 'name': '金迪克'}, {'code': '688383', 'name': '新益昌'}, {'code': '688357', 'name': '建龙微纳'}, {'code': '603995', 'name': '甬金股份'}, {'code': '601882', 'name': '海天精工'}, {'code': '601208', 'name': '东材科技'}, {'code': '600309', 'name': '万华化学'}, {'code': '300855', 'name': '图南股份'}, {'code': '300571', 'name': '平治信息'}, {'code': '300504', 'name': '天邑股份'}, {'code': '300258', 'name': '精锻科技'}, {'code': '300121', 'name': '阳谷华泰'}, {'code': '002810', 'name': '山东赫达'}, {'code': '000902', 'name': '新洋丰'}, {'code': '605168', 'name': '三人行'}, {'code': '603535', 'name': '嘉诚国际'}, {'code': '300825', 'name': '阿尔特'}, {'code': '003006', 'name': '百亚股份'}, {'code': '601899', 'name': '紫金矿业'}, {'code': '600436', 'name': '片仔癀'}, {'code': '600141', 'name': '兴发集团'}, {'code': '300900', 'name': '广联航空'}, {'code': '300852', 'name': '四会富仕'}, {'code': '300638', 'name': '广和通'}, {'code': '300373', 'name': '扬杰科技'}, {'code': '300083', 'name': '创世纪'}, {'code': '300059', 'name': '东方财富'}, {'code': '688272', 'name': '富吉瑞'}, {'code': '603077', 'name': '和邦生物'}, {'code': '600763', 'name': '通策医疗'}, {'code': '300708', 'name': '聚灿光电'}, {'code': '300263', 'name': '隆华科技'}, {'code': '002407', 'name': '多氟多'}, {'code': '002138', 'name': '顺络电子'}, {'code': '002132', 'name': '恒星科技'}, {'code': '688772', 'name': '珠海冠宇'}, {'code': '000988', 'name': '华工科技'}, {'code': '601636', 'name': '旗滨集团'}, {'code': '000708', 'name': '中信特钢'}]
    client = RedisConn()
    for i in pool:
        kline = get_stock_kline_with_indicators(i['code'], limit=250)
        i['kline'] = EMA_V2(EMA_V2(EMA_V2(kline, 50), 150), 200)
        client.set(f"stock:daily:{i['code']}", json.dumps(i))

