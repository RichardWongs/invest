# encoding: utf-8
# 动量模型核心教程  资料来源: 简放
import json
import os
import time
import logging
from datetime import date, timedelta
import numpy as np
import pandas as pd
import tushare as ts
from momentum import STOCK_LIST
pro = ts.pro_api("b625f0b90069039346d199aa3c0d5bc53fd47212437337b45ba87487")
begin_date = int(str(date.today() - timedelta(days=180)).replace('-', ''))
today = int(str(date.today()).replace('-', ''))
day = 180   # 上市时间满半年
rps_day = 20


def get_stock_list():
    # 获取沪深股市股票列表, 剔除上市不满一年的次新股
    df = pro.stock_basic(exchange='', list_status='L',
                         fields='ts_code,symbol,name,industry,list_date')  # fields='ts_code,symbol,name,area,industry,'
    df = df[df['list_date'].apply(int).values < begin_date]
    # 获取当前所有非新股次新股代码和名称
    codes = df.ts_code.values
    names = df.name.values
    industrys = df.industry.values
    list_dates = df.list_date.values
    stock_list = []
    for code, name, industry, list_date in zip(codes, names, industrys, list_dates):
        tmp = {'code': code, 'name': name, 'industry': industry, 'list_date': list_date}
        stock_list.append(tmp)
    return stock_list


def get_data(code, start=begin_date, end=today):
    # 按照日期范围获取股票交易日期,收盘价
    time.sleep(0.1)
    df = pro.daily(ts_code=code, start_date=start, end_date=end, fields='trade_date,close')
    # 将交易日期设置为索引值
    df.index = pd.to_datetime(df.trade_date)
    df = df.sort_index()
    return df.close


def get_all_data(stock_list):
    # 构建一个空的 dataframe 用来装数据, 获取列表中所有股票指定范围内的收盘价格
    data = pd.DataFrame()
    count = 0
    filename = f'daily_price.csv'
    if filename in os.listdir(os.curdir):
        os.remove(filename)
    for i in stock_list:
        code = i.get('code')
        data[code] = get_data(code)
        print(code, i.get('name'), count)
        count += 1
    data.to_csv(filename, encoding='utf-8')


# 计算收益率
def cal_ret(df, w=5):
    # w:周5;月20;半年：120; 一年250
    df = df / df.shift(w) - 1
    return df.iloc[w:, :].fillna(0)


# 计算RPS
def get_RPS(ser):
    df = pd.DataFrame(ser.sort_values(ascending=False))
    df['n'] = range(1, len(df) + 1)
    df['rps'] = (1 - df['n'] / len(df)) * 100
    return df


# 计算每个交易日所有股票滚动w日的RPS
def all_RPS(data):
    dates = data.index
    # dates = (data.index).strftime('%Y%m%d')
    RPS = {}
    for i in range(len(data)):
        RPS[dates[i]] = pd.DataFrame(get_RPS(data.iloc[i]).values, columns=['收益率', '排名', 'RPS'],
                                     index=get_RPS(data.iloc[i]).index)
    return RPS


# 获取所有股票在某个期间的RPS值
def all_data(rps, ret):
    df = pd.DataFrame(np.NaN, columns=ret.columns, index=ret.index)
    for date in ret.index:
        date = date.strftime('%Y%m%d')
        d = rps[date]
        for c in d.index:
            df.loc[date, c] = d.loc[c, 'RPS']
    return df


def fill_in_data(df, filename="RPS.csv"):
    rps_df = pd.DataFrame()
    if filename in os.listdir(os.curdir):
        os.remove(filename)
    for k, v in df.items():
        print(k)
        for code, rps in zip(v.index, v.values):
            rps_df.loc[code, 'NAME'] = [i.get('name') for i in STOCK_LIST if i.get('code') == code][0]
            rps_df.loc[code, 'INDUSTRY'] = [i.get('industry') for i in STOCK_LIST if i.get('code') == code][0]
            rps_df.loc[code, 'LIST_DATE'] = [i.get('list_date') for i in STOCK_LIST if i.get('code') == code][0]
            rps_df.loc[code, k] = round(float(rps[-1]), 2)
    rps_df.to_csv(filename, encoding='utf-8')


def create_RPS_file():
    stocks = get_stock_list()  # 获取全市场股票列表
    get_all_data(stocks)  # 获取行情数据并写入csv文件
    data = pd.read_csv(f'daily_price.csv', encoding='utf-8', index_col='trade_date')
    data.index = pd.to_datetime(data.index, format='%Y%m%d', errors='ignore')
    ret = cal_ret(data, w=rps_day)
    rps = all_RPS(ret)
    fill_in_data(rps, filename=f'RPS{rps_day}.csv')  # 计算个股20日RPS值并写入rps文件


def get_fund_holdings(quarter, year=date.today().year):
    # 基金持股
    return [{'code': '688981', 'name': '中芯国际'}, {'code': '688819', 'name': '天能股份'}, {'code': '688788', 'name': '科思科技'}, {'code': '688777', 'name': '中控技术'}, {'code': '688699', 'name': '明微电子'}, {'code': '688698', 'name': '伟创电气'}, {'code': '688696', 'name': '极米科技'}, {'code': '688689', 'name': '银河微电'}, {'code': '688687', 'name': '凯因科技'}, {'code': '688686', 'name': '奥普特'}, {'code': '688680', 'name': '海优新材'}, {'code': '688678', 'name': '福立旺'}, {'code': '688677', 'name': '海泰新光'}, {'code': '688676', 'name': '金盘科技'}, {'code': '688669', 'name': '聚石化学'}, {'code': '688668', 'name': '鼎通科技'}, {'code': '688667', 'name': '菱电电控'}, {'code': '688665', 'name': '四方光电'}, {'code': '688662', 'name': '富信科技'}, {'code': '688661', 'name': '和林微纳'}, {'code': '688659', 'name': '元琛科技'}, {'code': '688656', 'name': '浩欧博'}, {'code': '688636', 'name': '智明达'}, {'code': '688633', 'name': '星球石墨'}, {'code': '688630', 'name': '芯碁微装'}, {'code': '688628', 'name': '优利德'}, {'code': '688626', 'name': '翔宇医疗'}, {'code': '688619', 'name': '罗普特'}, {'code': '688618', 'name': '三旺通信'}, {'code': '688617', 'name': '惠泰医疗'}, {'code': '688616', 'name': '西力科技'}, {'code': '688609', 'name': '九联科技'}, {'code': '688608', 'name': '恒玄科技'}, {'code': '688607', 'name': '康众医疗'}, {'code': '688606', 'name': '奥泰生物'}, {'code': '688599', 'name': '天合光能'}, {'code': '688598', 'name': '金博股份'}, {'code': '688595', 'name': '芯海科技'}, {'code': '688586', 'name': '江航装备'}, {'code': '688580', 'name': '伟思医疗'}, {'code': '688578', 'name': '艾力斯'}, {'code': '688568', 'name': '中科星图'}, {'code': '688567', 'name': '孚能科技'}, {'code': '688561', 'name': '奇安信'}, {'code': '688559', 'name': '海目星'}, {'code': '688558', 'name': '国盛智科'}, {'code': '688551', 'name': '科威尔'}, {'code': '688536', 'name': '思瑞浦'}, {'code': '688526', 'name': '科前生物'}, {'code': '688521', 'name': '芯原股份'}, {'code': '688519', 'name': '南亚新材'}, {'code': '688516', 'name': '奥特维'}, {'code': '688510', 'name': '航亚科技'}, {'code': '688508', 'name': '芯朋微'}, {'code': '688468', 'name': '科美诊断'}, {'code': '688456', 'name': '有研粉材'}, {'code': '688408', 'name': '中信博'}, {'code': '688396', 'name': '华润微'}, {'code': '688390', 'name': '固德威'}, {'code': '688389', 'name': '普门科技'}, {'code': '688388', 'name': '嘉元科技'}, {'code': '688386', 'name': '泛亚微透'}, {'code': '688369', 'name': '致远互联'}, {'code': '688368', 'name': '晶丰明源'}, {'code': '688363', 'name': '华熙生物'}, {'code': '688358', 'name': '祥生医疗'}, {'code': '688357', 'name': '建龙微纳'}, {'code': '688350', 'name': '富淼科技'}, {'code': '688339', 'name': '亿华通'}, {'code': '688333', 'name': '铂力特'}, {'code': '688330', 'name': '宏力达'}, {'code': '688329', 'name': '艾隆科技'}, {'code': '688328', 'name': '深科达'}, {'code': '688321', 'name': '微芯生物'}, {'code': '688317', 'name': '之江生物'}, {'code': '688316', 'name': '青云科技'}, {'code': '688311', 'name': '盟升电子'}, {'code': '688308', 'name': '欧科亿'}, {'code': '688301', 'name': '奕瑞科技'}, {'code': '688300', 'name': '联瑞新材'}, {'code': '688299', 'name': '长阳科技'}, {'code': '688288', 'name': '鸿泉物联'}, {'code': '688286', 'name': '敏芯股份'}, {'code': '688268', 'name': '华特气体'}, {'code': '688260', 'name': '昀冢科技'}, {'code': '688229', 'name': '博睿数据'}, {'code': '688221', 'name': '前沿生物'}, {'code': '688208', 'name': '道通科技'}, {'code': '688202', 'name': '美迪西'}, {'code': '688200', 'name': '华峰测控'}, {'code': '688198', 'name': '佰仁医疗'}, {'code': '688195', 'name': '腾景科技'}, {'code': '688191', 'name': '智洋创新'}, {'code': '688189', 'name': '南新制药'}, {'code': '688188', 'name': '柏楚电子'}, {'code': '688186', 'name': '广大特材'}, {'code': '688185', 'name': '康希诺'}, {'code': '688183', 'name': '生益电子'}, {'code': '688180', 'name': '君实生物'}, {'code': '688179', 'name': '阿拉丁'}, {'code': '688169', 'name': '石头科技'}, {'code': '688166', 'name': '博瑞医药'}, {'code': '688158', 'name': '优刻得'}, {'code': '688157', 'name': '松井股份'}, {'code': '688139', 'name': '海尔生物'}, {'code': '688135', 'name': '利扬芯片'}, {'code': '688133', 'name': '泰坦科技'}, {'code': '688127', 'name': '蓝特光学'}, {'code': '688126', 'name': '沪硅产业'}, {'code': '688122', 'name': '西部超导'}, {'code': '688116', 'name': '天奈科技'}, {'code': '688111', 'name': '金山办公'}, {'code': '688109', 'name': '品茗股份'}, {'code': '688099', 'name': '晶晨股份'}, {'code': '688095', 'name': '福昕软件'}, {'code': '688093', 'name': '世华科技'}, {'code': '688092', 'name': '爱科科技'}, {'code': '688088', 'name': '虹软科技'}, {'code': '688083', 'name': '中望软件'}, {'code': '688079', 'name': '美迪凯'}, {'code': '688070', 'name': '纵横股份'}, {'code': '688066', 'name': '航天宏图'}, {'code': '688065', 'name': '凯赛生物'}, {'code': '688063', 'name': '派能科技'}, {'code': '688059', 'name': '华锐精密'}, {'code': '688058', 'name': '宝兰德'}, {'code': '688057', 'name': '金达莱'}, {'code': '688056', 'name': '莱伯泰科'}, {'code': '688050', 'name': '爱博医疗'}, {'code': '688039', 'name': '当虹科技'}, {'code': '688037', 'name': '芯源微'}, {'code': '688036', 'name': '传音控股'}, {'code': '688033', 'name': '天宜上佳'}, {'code': '688029', 'name': '南微医学'}, {'code': '688026', 'name': '洁特生物'}, {'code': '688023', 'name': '安恒信息'}, {'code': '688022', 'name': '瀚川智能'}, {'code': '688021', 'name': '奥福环保'}, {'code': '688020', 'name': '方邦股份'}, {'code': '688019', 'name': '安集科技'}, {'code': '688016', 'name': '心脉医疗'}, {'code': '688012', 'name': '中微公司'}, {'code': '688011', 'name': '新光光电'}, {'code': '688009', 'name': '中国通号'}, {'code': '688008', 'name': '澜起科技'}, {'code': '688007', 'name': '光峰科技'}, {'code': '688006', 'name': '杭可科技'}, {'code': '688005', 'name': '容百科技'}, {'code': '688002', 'name': '睿创微纳'}, {'code': '605377', 'name': '华旺科技'}, {'code': '605358', 'name': '立昂微'}, {'code': '605338', 'name': '巴比食品'}, {'code': '605337', 'name': '李子园'}, {'code': '605288', 'name': '凯迪股份'}, {'code': '605123', 'name': '派克新材'}, {'code': '605111', 'name': '新洁能'}, {'code': '605108', 'name': '同庆楼'}, {'code': '605068', 'name': '明新旭腾'}, {'code': '603997', 'name': '继峰股份'}, {'code': '603995', 'name': '甬金股份'}, {'code': '603993', 'name': '洛阳钼业'}, {'code': '603992', 'name': '松霖科技'}, {'code': '603989', 'name': '艾华集团'}, {'code': '603987', 'name': '康德莱'}, {'code': '603986', 'name': '兆易创新'}, {'code': '603985', 'name': '恒润股份'}, {'code': '603979', 'name': '金诚信'}, {'code': '603960', 'name': '克来机电'}, {'code': '603939', 'name': '益丰药房'}, {'code': '603936', 'name': '博敏电子'}, {'code': '603916', 'name': '苏博特'}, {'code': '603915', 'name': '国茂股份'}, {'code': '603906', 'name': '龙蟠科技'}, {'code': '603901', 'name': '永创智能'}, {'code': '603899', 'name': '晨光文具'}, {'code': '603898', 'name': '好莱客'}, {'code': '603896', 'name': '寿仙谷'}, {'code': '603893', 'name': '瑞芯微'}, {'code': '603886', 'name': '元祖股份'}, {'code': '603885', 'name': '吉祥航空'}, {'code': '603883', 'name': '老百姓'}, {'code': '603882', 'name': '金域医学'}, {'code': '603881', 'name': '数据港'}, {'code': '603877', 'name': '太平鸟'}, {'code': '603871', 'name': '嘉友国际'}, {'code': '603868', 'name': '飞科电器'}, {'code': '603866', 'name': '桃李面包'}, {'code': '603858', 'name': '步长制药'}, {'code': '603855', 'name': '华荣股份'}, {'code': '603833', 'name': '欧派家居'}, {'code': '603826', 'name': '坤彩科技'}, {'code': '603818', 'name': '曲美家居'}, {'code': '603816', 'name': '顾家家居'}, {'code': '603811', 'name': '诚意药业'}, {'code': '603809', 'name': '豪能股份'}, {'code': '603806', 'name': '福斯特'}, {'code': '603801', 'name': '志邦家居'}, {'code': '603799', 'name': '华友钴业'}, {'code': '603788', 'name': '宁波高发'}, {'code': '603787', 'name': '新日股份'}, {'code': '603786', 'name': '科博达'}, {'code': '603755', 'name': '日辰股份'}, {'code': '603737', 'name': '三棵树'}, {'code': '603733', 'name': '仙鹤股份'}, {'code': '603730', 'name': '岱美股份'}, {'code': '603727', 'name': '博迈科'}, {'code': '603719', 'name': '良品铺子'}, {'code': '603713', 'name': '密尔克卫'}, {'code': '603712', 'name': '七一二'}, {'code': '603708', 'name': '家家悦'}, {'code': '603707', 'name': '健友股份'}, {'code': '603700', 'name': '宁水集团'}, {'code': '603699', 'name': '纽威股份'}, {'code': '603690', 'name': '至纯科技'}, {'code': '603686', 'name': '龙马环卫'}, {'code': '603678', 'name': '火炬电子'}, {'code': '603667', 'name': '五洲新春'}, {'code': '603666', 'name': '亿嘉和'}, {'code': '603659', 'name': '璞泰来'}, {'code': '603658', 'name': '安图生物'}, {'code': '603650', 'name': '彤程新材'}, {'code': '603639', 'name': '海利尔'}, {'code': '603626', 'name': '科森科技'}, {'code': '603619', 'name': '中曼石油'}, {'code': '603613', 'name': '国联股份'}, {'code': '603612', 'name': '索通发展'}, {'code': '603606', 'name': '东方电缆'}, {'code': '603605', 'name': '珀莱雅'}, {'code': '603601', 'name': '再升科技'}, {'code': '603600', 'name': '永艺股份'}, {'code': '603599', 'name': '广信股份'}, {'code': '603596', 'name': '伯特利'}, {'code': '603589', 'name': '口子窖'}, {'code': '603588', 'name': '高能环境'}, {'code': '603587', 'name': '地素时尚'}, {'code': '603583', 'name': '捷昌驱动'}, {'code': '603579', 'name': '荣泰健康'}, {'code': '603568', 'name': '伟明环保'}, {'code': '603566', 'name': '普莱柯'}, {'code': '603565', 'name': '中谷物流'}, {'code': '603558', 'name': '健盛集团'}, {'code': '603538', 'name': '美诺华'}, {'code': '603536', 'name': '惠发食品'}, {'code': '603533', 'name': '掌阅科技'}, {'code': '603520', 'name': '司太立'}, {'code': '603518', 'name': '锦泓集团'}, {'code': '603517', 'name': '绝味食品'}, {'code': '603516', 'name': '淳中科技'}, {'code': '603515', 'name': '欧普照明'}, {'code': '603507', 'name': '振江股份'}, {'code': '603506', 'name': '南都物业'}, {'code': '603505', 'name': '金石资源'}, {'code': '603501', 'name': '韦尔股份'}, {'code': '603489', 'name': '八方股份'}, {'code': '603486', 'name': '科沃斯'}, {'code': '603456', 'name': '九洲药业'}, {'code': '603444', 'name': '吉比特'}, {'code': '603429', 'name': '集友股份'}, {'code': '603416', 'name': '信捷电气'}, {'code': '603392', 'name': '万泰生物'}, {'code': '603378', 'name': '亚士创能'}, {'code': '603369', 'name': '今世缘'}, {'code': '603368', 'name': '柳药股份'}, {'code': '603363', 'name': '傲农生物'}, {'code': '603353', 'name': '和顺石油'}, {'code': '603351', 'name': '威尔药业'}, {'code': '603348', 'name': '文灿股份'}, {'code': '603345', 'name': '安井食品'}, {'code': '603338', 'name': '浙江鼎力'}, {'code': '603337', 'name': '杰克股份'}, {'code': '603330', 'name': '上海天洋'}, {'code': '603326', 'name': '我乐家居'}, {'code': '603324', 'name': '盛剑环境'}, {'code': '603323', 'name': '苏农银行'}, {'code': '603319', 'name': '湘油泵'}, {'code': '603317', 'name': '天味食品'}, {'code': '603313', 'name': '梦百合'}, {'code': '603308', 'name': '应流股份'}, {'code': '603300', 'name': '华铁应急'}, {'code': '603298', 'name': '杭叉集团'}, {'code': '603290', 'name': '斯达半导'}, {'code': '603288', 'name': '海天味业'}, {'code': '603277', 'name': '银都股份'}, {'code': '603267', 'name': '鸿远电子'}, {'code': '603260', 'name': '合盛硅业'}, {'code': '603259', 'name': '药明康德'}, {'code': '603238', 'name': '诺邦股份'}, {'code': '603236', 'name': '移远通信'}, {'code': '603233', 'name': '大参林'}, {'code': '603232', 'name': '格尔软件'}, {'code': '603229', 'name': '奥翔药业'}, {'code': '603228', 'name': '景旺电子'}, {'code': '603225', 'name': '新凤鸣'}, {'code': '603218', 'name': '日月股份'}, {'code': '603212', 'name': '赛伍技术'}, {'code': '603208', 'name': '江山欧派'}, {'code': '603198', 'name': '迎驾贡酒'}, {'code': '603197', 'name': '保隆科技'}, {'code': '603195', 'name': '公牛集团'}, {'code': '603187', 'name': '海容冷链'}, {'code': '603186', 'name': '华正新材'}, {'code': '603185', 'name': '上机数控'}, {'code': '603181', 'name': '皇马科技'}, {'code': '603180', 'name': '金牌厨柜'}, {'code': '603179', 'name': '新泉股份'}, {'code': '603167', 'name': '渤海轮渡'}, {'code': '603161', 'name': '科华控股'}, {'code': '603160', 'name': '汇顶科技'}, {'code': '603158', 'name': '腾龙股份'}, {'code': '603156', 'name': '养元饮品'}, {'code': '603136', 'name': '天目湖'}, {'code': '603129', 'name': '春风动力'}, {'code': '603128', 'name': '华贸物流'}, {'code': '603127', 'name': '昭衍新药'}, {'code': '603113', 'name': '金能科技'}, {'code': '603108', 'name': '润达医疗'}, {'code': '603103', 'name': '横店影视'}, {'code': '603098', 'name': '森特股份'}, {'code': '603096', 'name': '新经典'}, {'code': '603086', 'name': '先达股份'}, {'code': '603077', 'name': '和邦生物'}, {'code': '603076', 'name': '乐惠国际'}, {'code': '603068', 'name': '博通集成'}, {'code': '603043', 'name': '广州酒家'}, {'code': '603039', 'name': '泛微网络'}, {'code': '603035', 'name': '常熟汽饰'}, {'code': '603027', 'name': '千禾味业'}, {'code': '603026', 'name': '石大胜华'}, {'code': '603019', 'name': '中科曙光'}, {'code': '603018', 'name': '华设集团'}, {'code': '603010', 'name': '万盛股份'}, {'code': '603008', 'name': '喜临门'}, {'code': '603005', 'name': '晶方科技'}, {'code': '601997', 'name': '贵阳银行'}, {'code': '601995', 'name': '中金公司'}, {'code': '601990', 'name': '南京证券'}, {'code': '601989', 'name': '中国重工'}, {'code': '601968', 'name': '宝钢包装'}, {'code': '601966', 'name': '玲珑轮胎'}, {'code': '601965', 'name': '中国汽研'}, {'code': '601949', 'name': '中国出版'}, {'code': '601939', 'name': '建设银行'}, {'code': '601933', 'name': '永辉超市'}, {'code': '601928', 'name': '凤凰传媒'}, {'code': '601919', 'name': '中远海控'}, {'code': '601918', 'name': '新集能源'}, {'code': '601916', 'name': '浙商银行'}, {'code': '601901', 'name': '方正证券'}, {'code': '601899', 'name': '紫金矿业'}, {'code': '601898', 'name': '中煤能源'}, {'code': '601888', 'name': '中国中免'}, {'code': '601878', 'name': '浙商证券'}, {'code': '601877', 'name': '正泰电器'}, {'code': '601865', 'name': '福莱特'}, {'code': '601860', 'name': '紫金银行'}, {'code': '601838', 'name': '成都银行'}, {'code': '601827', 'name': '三峰环境'}, {'code': '601818', 'name': '光大银行'}, {'code': '601808', 'name': '中海油服'}, {'code': '601799', 'name': '星宇股份'}, {'code': '601788', 'name': '光大证券'}, {'code': '601717', 'name': '郑煤机'}, {'code': '601699', 'name': '潞安环能'}, {'code': '601689', 'name': '拓普集团'}, {'code': '601688', 'name': '华泰证券'}, {'code': '601678', 'name': '滨化股份'}, {'code': '601677', 'name': '明泰铝业'}, {'code': '601669', 'name': '中国电建'}, {'code': '601668', 'name': '中国建筑'}, {'code': '601666', 'name': '平煤股份'}, {'code': '601658', 'name': '邮储银行'}, {'code': '601636', 'name': '旗滨集团'}, {'code': '601633', 'name': '长城汽车'}, {'code': '601615', 'name': '明阳智能'}, {'code': '601607', 'name': '上海医药'}, {'code': '601601', 'name': '中国太保'}, {'code': '601600', 'name': '中国铝业'}, {'code': '601598', 'name': '中国外运'}, {'code': '601577', 'name': '长沙银行'}, {'code': '601555', 'name': '东吴证券'}, {'code': '601390', 'name': '中国中铁'}, {'code': '601377', 'name': '兴业证券'}, {'code': '601336', 'name': '新华保险'}, {'code': '601328', 'name': '交通银行'}, {'code': '601319', 'name': '中国人保'}, {'code': '601318', 'name': '中国平安'}, {'code': '601311', 'name': '骆驼股份'}, {'code': '601298', 'name': '青岛港'}, {'code': '601233', 'name': '桐昆股份'}, {'code': '601229', 'name': '上海银行'}, {'code': '601225', 'name': '陕西煤业'}, {'code': '601222', 'name': '林洋能源'}, {'code': '601211', 'name': '国泰君安'}, {'code': '601208', 'name': '东材科技'}, {'code': '601198', 'name': '东兴证券'}, {'code': '601186', 'name': '中国铁建'}, {'code': '601169', 'name': '北京银行'}, {'code': '601168', 'name': '西部矿业'}, {'code': '601166', 'name': '兴业银行'}, {'code': '601155', 'name': '新城控股'}, {'code': '601138', 'name': '工业富联'}, {'code': '601137', 'name': '博威合金'}, {'code': '601128', 'name': '常熟银行'}, {'code': '601127', 'name': '小康股份'}, {'code': '601126', 'name': '四方股份'}, {'code': '601117', 'name': '中国化学'}, {'code': '601111', 'name': '中国国航'}, {'code': '601108', 'name': '财通证券'}, {'code': '601100', 'name': '恒立液压'}, {'code': '601098', 'name': '中南传媒'}, {'code': '601088', 'name': '中国神华'}, {'code': '601077', 'name': '渝农商行'}, {'code': '601069', 'name': '西部黄金'}, {'code': '601066', 'name': '中信建投'}, {'code': '601058', 'name': '赛轮轮胎'}, {'code': '601021', 'name': '春秋航空'}, {'code': '601015', 'name': '陕西黑猫'}, {'code': '601012', 'name': '隆基股份'}, {'code': '601009', 'name': '南京银行'}, {'code': '601006', 'name': '大秦铁路'}, {'code': '601005', 'name': '重庆钢铁'}, {'code': '601003', 'name': '柳钢股份'}, {'code': '600999', 'name': '招商证券'}, {'code': '600993', 'name': '马应龙'}, {'code': '600990', 'name': '四创电子'}, {'code': '600989', 'name': '宝丰能源'}, {'code': '600988', 'name': '赤峰黄金'}, {'code': '600987', 'name': '航民股份'}, {'code': '600985', 'name': '淮北矿业'}, {'code': '600984', 'name': '建设机械'}, {'code': '600976', 'name': '健民集团'}, {'code': '600970', 'name': '中材国际'}, {'code': '600967', 'name': '内蒙一机'}, {'code': '600966', 'name': '博汇纸业'}, {'code': '600958', 'name': '东方证券'}, {'code': '600933', 'name': '爱柯迪'}, {'code': '600926', 'name': '杭州银行'}, {'code': '600919', 'name': '江苏银行'}, {'code': '600908', 'name': '无锡银行'}, {'code': '600901', 'name': '江苏租赁'}, {'code': '600900', 'name': '长江电力'}, {'code': '600895', 'name': '张江高科'}, {'code': '600893', 'name': '航发动力'}, {'code': '600887', 'name': '伊利股份'}, {'code': '600886', 'name': '国投电力'}, {'code': '600885', 'name': '宏发股份'}, {'code': '600884', 'name': '杉杉股份'}, {'code': '600882', 'name': '妙可蓝多'}, {'code': '600873', 'name': '梅花生物'}, {'code': '600872', 'name': '中炬高新'}, {'code': '600867', 'name': '通化东宝'}, {'code': '600862', 'name': '中航高科'}, {'code': '600859', 'name': '王府井'}, {'code': '600858', 'name': '银座股份'}, {'code': '600848', 'name': '上海临港'}, {'code': '600845', 'name': '宝信软件'}, {'code': '600837', 'name': '海通证券'}, {'code': '600827', 'name': '百联股份'}, {'code': '600823', 'name': '世茂股份'}, {'code': '600820', 'name': '隧道股份'}, {'code': '600817', 'name': '宇通重工'}, {'code': '600810', 'name': '神马股份'}, {'code': '600809', 'name': '山西汾酒'}, {'code': '600808', 'name': '马钢股份'}, {'code': '600803', 'name': '新奥股份'}, {'code': '600801', 'name': '华新水泥'}, {'code': '600782', 'name': '新钢股份'}, {'code': '600779', 'name': '水井坊'}, {'code': '600773', 'name': '西藏城投'}, {'code': '600765', 'name': '中航重机'}, {'code': '600764', 'name': '中国海防'}, {'code': '600763', 'name': '通策医疗'}, {'code': '600760', 'name': '中航沈飞'}, {'code': '600754', 'name': '锦江酒店'}, {'code': '600746', 'name': '江苏索普'}, {'code': '600745', 'name': '闻泰科技'}, {'code': '600741', 'name': '华域汽车'}, {'code': '600737', 'name': '中粮糖业'}, {'code': '600733', 'name': '北汽蓝谷'}, {'code': '600732', 'name': '爱旭股份'}, {'code': '600729', 'name': '重庆百货'}, {'code': '600728', 'name': '佳都科技'}, {'code': '600727', 'name': '鲁北化工'}, {'code': '600718', 'name': '东软集团'}, {'code': '600711', 'name': '盛屯矿业'}, {'code': '600704', 'name': '物产中大'}, {'code': '600703', 'name': '三安光电'}, {'code': '600702', 'name': '舍得酒业'}, {'code': '600699', 'name': '均胜电子'}, {'code': '600690', 'name': '海尔智家'}, {'code': '600685', 'name': '中船防务'}, {'code': '600674', 'name': '川投能源'}, {'code': '600667', 'name': '太极实业'}, {'code': '600660', 'name': '福耀玻璃'}, {'code': '600649', 'name': '城投控股'}, {'code': '600642', 'name': '申能股份'}, {'code': '600623', 'name': '华谊集团'}, {'code': '600612', 'name': '老凤祥'}, {'code': '600603', 'name': '广汇物流'}, {'code': '600600', 'name': '青岛啤酒'}, {'code': '600597', 'name': '光明乳业'}, {'code': '600596', 'name': '新安股份'}, {'code': '600588', 'name': '用友网络'}, {'code': '600585', 'name': '海螺水泥'}, {'code': '600584', 'name': '长电科技'}, {'code': '600583', 'name': '海油工程'}, {'code': '600582', 'name': '天地科技'}, {'code': '600581', 'name': '八一钢铁'}, {'code': '600580', 'name': '卧龙电驱'}, {'code': '600570', 'name': '恒生电子'}, {'code': '600567', 'name': '山鹰国际'}, {'code': '600566', 'name': '济川药业'}, {'code': '600563', 'name': '法拉电子'}, {'code': '600559', 'name': '老白干酒'}, {'code': '600556', 'name': '天下秀'}, {'code': '600549', 'name': '厦门钨业'}, {'code': '600548', 'name': '深高速'}, {'code': '600547', 'name': '山东黄金'}, {'code': '600536', 'name': '中国软件'}, {'code': '600529', 'name': '山东药玻'}, {'code': '600522', 'name': '中天科技'}, {'code': '600521', 'name': '华海药业'}, {'code': '600519', 'name': '贵州茅台'}, {'code': '600516', 'name': '方大炭素'}, {'code': '600507', 'name': '方大特钢'}, {'code': '600500', 'name': '中化国际'}, {'code': '600499', 'name': '科达制造'}, {'code': '600498', 'name': '烽火通信'}, {'code': '600497', 'name': '驰宏锌锗'}, {'code': '600496', 'name': '精工钢构'}, {'code': '600489', 'name': '中金黄金'}, {'code': '600486', 'name': '扬农化工'}, {'code': '600483', 'name': '福能股份'}, {'code': '600480', 'name': '凌云股份'}, {'code': '600461', 'name': '洪城环境'}, {'code': '600460', 'name': '士兰微'}, {'code': '600459', 'name': '贵研铂业'}, {'code': '600456', 'name': '宝钛股份'}, {'code': '600446', 'name': '金证股份'}, {'code': '600438', 'name': '通威股份'}, {'code': '600436', 'name': '片仔癀'}, {'code': '600426', 'name': '华鲁恒升'}, {'code': '600418', 'name': '江淮汽车'}, {'code': '600416', 'name': '湘电股份'}, {'code': '600409', 'name': '三友化工'}, {'code': '600406', 'name': '国电南瑞'}, {'code': '600399', 'name': '抚顺特钢'}, {'code': '600398', 'name': '海澜之家'}, {'code': '600395', 'name': '盘江股份'}, {'code': '600392', 'name': '盛和资源'}, {'code': '600383', 'name': '金地集团'}, {'code': '600380', 'name': '健康元'}, {'code': '600377', 'name': '宁沪高速'}, {'code': '600373', 'name': '中文传媒'}, {'code': '600372', 'name': '中航电子'}, {'code': '600369', 'name': '西南证券'}, {'code': '600352', 'name': '浙江龙盛'}, {'code': '600350', 'name': '山东高速'}, {'code': '600346', 'name': '恒力石化'}, {'code': '600329', 'name': '中新药业'}, {'code': '600328', 'name': '中盐化工'}, {'code': '600327', 'name': '大东方'}, {'code': '600325', 'name': '华发股份'}, {'code': '600323', 'name': '瀚蓝环境'}, {'code': '600316', 'name': '洪都航空'}, {'code': '600315', 'name': '上海家化'}, {'code': '600309', 'name': '万华化学'}, {'code': '600305', 'name': '恒顺醋业'}, {'code': '600298', 'name': '安琪酵母'}, {'code': '600297', 'name': '广汇汽车'}, {'code': '600285', 'name': '羚锐制药'}, {'code': '600282', 'name': '南钢股份'}, {'code': '600276', 'name': '恒瑞医药'}, {'code': '600271', 'name': '航天信息'}, {'code': '600258', 'name': '首旅酒店'}, {'code': '600256', 'name': '广汇能源'}, {'code': '600219', 'name': '南山铝业'}, {'code': '600216', 'name': '浙江医药'}, {'code': '600206', 'name': '有研新材'}, {'code': '600201', 'name': '生物股份'}, {'code': '600196', 'name': '复星医药'}, {'code': '600195', 'name': '中牧股份'}, {'code': '600188', 'name': '兖州煤业'}, {'code': '600183', 'name': '生益科技'}, {'code': '600176', 'name': '中国巨石'}, {'code': '600171', 'name': '上海贝岭'}, {'code': '600166', 'name': '福田汽车'}, {'code': '600161', 'name': '天坛生物'}, {'code': '600158', 'name': '中体产业'}, {'code': '600155', 'name': '华创阳安'}, {'code': '600153', 'name': '建发股份'}, {'code': '600141', 'name': '兴发集团'}, {'code': '600138', 'name': '中青旅'}, {'code': '600132', 'name': '重庆啤酒'}, {'code': '600131', 'name': '国网信通'}, {'code': '600123', 'name': '兰花科创'}, {'code': '600116', 'name': '三峡水利'}, {'code': '600115', 'name': '中国东航'}, {'code': '600114', 'name': '东睦股份'}, {'code': '600111', 'name': '北方稀土'}, {'code': '600110', 'name': '诺德股份'}, {'code': '600109', 'name': '国金证券'}, {'code': '600104', 'name': '上汽集团'}, {'code': '600096', 'name': '云天化'}, {'code': '600089', 'name': '特变电工'}, {'code': '600085', 'name': '同仁堂'}, {'code': '600079', 'name': '人福医药'}, {'code': '600073', 'name': '上海梅林'}, {'code': '600068', 'name': '葛洲坝'}, {'code': '600066', 'name': '宇通客车'}, {'code': '600063', 'name': '皖维高新'}, {'code': '600061', 'name': '国投资本'}, {'code': '600060', 'name': '海信视像'}, {'code': '600057', 'name': '厦门象屿'}, {'code': '600054', 'name': '黄山旅游'}, {'code': '600050', 'name': '中国联通'}, {'code': '600048', 'name': '保利发展'}, {'code': '600039', 'name': '四川路桥'}, {'code': '600038', 'name': '中直股份'}, {'code': '600036', 'name': '招商银行'}, {'code': '600031', 'name': '三一重工'}, {'code': '600030', 'name': '中信证券'}, {'code': '600029', 'name': '南方航空'}, {'code': '600026', 'name': '中远海能'}, {'code': '600025', 'name': '华能水电'}, {'code': '600019', 'name': '宝钢股份'}, {'code': '600016', 'name': '民生银行'}, {'code': '600009', 'name': '上海机场'}, {'code': '600007', 'name': '中国国贸'}, {'code': '600000', 'name': '浦发银行'}, {'code': '430047', 'name': '诺思兰德'}, {'code': '300999', 'name': '金龙鱼'}, {'code': '300966', 'name': '共同药业'}, {'code': '300963', 'name': '中洲特材'}, {'code': '300962', 'name': '中金辐照'}, {'code': '300961', 'name': '深水海纳'}, {'code': '300958', 'name': '建工修复'}, {'code': '300957', 'name': '贝泰妮'}, {'code': '300956', 'name': '英力股份'}, {'code': '300953', 'name': '震裕科技'}, {'code': '300950', 'name': '德固特'}, {'code': '300948', 'name': '冠中生态'}, {'code': '300941', 'name': '创识科技'}, {'code': '300940', 'name': '南极光'}, {'code': '300937', 'name': '药易购'}, {'code': '300933', 'name': '中辰股份'}, {'code': '300932', 'name': '三友联众'}, {'code': '300929', 'name': '华骐环保'}, {'code': '300925', 'name': '法本信息'}, {'code': '300922', 'name': '天秦装备'}, {'code': '300920', 'name': '润阳科技'}, {'code': '300919', 'name': '中伟股份'}, {'code': '300917', 'name': '特发服务'}, {'code': '300912', 'name': '凯龙高科'}, {'code': '300911', 'name': '亿田智能'}, {'code': '300910', 'name': '瑞丰新材'}, {'code': '300908', 'name': '仲景食品'}, {'code': '300900', 'name': '广联航空'}, {'code': '300898', 'name': '熊猫乳品'}, {'code': '300896', 'name': '爱美客'}, {'code': '300894', 'name': '火星人'}, {'code': '300888', 'name': '稳健医疗'}, {'code': '300887', 'name': '谱尼测试'}, {'code': '300871', 'name': '回盛生物'}, {'code': '300866', 'name': '安克创新'}, {'code': '300861', 'name': '美畅股份'}, {'code': '300858', 'name': '科拓生物'}, {'code': '300857', 'name': '协创数据'}, {'code': '300841', 'name': '康华生物'}, {'code': '300837', 'name': '浙矿股份'}, {'code': '300833', 'name': '浩洋股份'}, {'code': '300832', 'name': '新产业'}, {'code': '300825', 'name': '阿尔特'}, {'code': '300824', 'name': '北鼎股份'}, {'code': '300816', 'name': '艾可蓝'}, {'code': '300815', 'name': '玉禾田'}, {'code': '300809', 'name': '华辰装备'}, {'code': '300795', 'name': '*ST米奥'}, {'code': '300792', 'name': '壹网壹创'}, {'code': '300791', 'name': '仙乐健康'}, {'code': '300788', 'name': '中信出版'}, {'code': '300785', 'name': '值得买'}, {'code': '300783', 'name': '三只松鼠'}, {'code': '300782', 'name': '卓胜微'}, {'code': '300777', 'name': '中简科技'}, {'code': '300776', 'name': '帝尔激光'}, {'code': '300775', 'name': '三角防务'}, {'code': '300773', 'name': '拉卡拉'}, {'code': '300772', 'name': '运达股份'}, {'code': '300770', 'name': '新媒股份'}, {'code': '300769', 'name': '德方纳米'}, {'code': '300768', 'name': '迪普科技'}, {'code': '300767', 'name': '震安科技'}, {'code': '300763', 'name': '锦浪科技'}, {'code': '300762', 'name': '上海瀚讯'}, {'code': '300761', 'name': '立华股份'}, {'code': '300760', 'name': '迈瑞医疗'}, {'code': '300759', 'name': '康龙化成'}, {'code': '300758', 'name': '七彩化学'}, {'code': '300751', 'name': '迈为股份'}, {'code': '300750', 'name': '宁德时代'}, {'code': '300748', 'name': '金力永磁'}, {'code': '300747', 'name': '锐科激光'}, {'code': '300741', 'name': '华宝股份'}, {'code': '300740', 'name': '水羊股份'}, {'code': '300738', 'name': '奥飞数据'}, {'code': '300737', 'name': '科顺股份'}, {'code': '300733', 'name': '西菱动力'}, {'code': '300726', 'name': '宏达电子'}, {'code': '300725', 'name': '药石科技'}, {'code': '300724', 'name': '捷佳伟创'}, {'code': '300715', 'name': '凯伦股份'}, {'code': '300712', 'name': '永福股份'}, {'code': '300709', 'name': '精研科技'}, {'code': '300705', 'name': '九典制药'}, {'code': '300702', 'name': '天宇股份'}, {'code': '300699', 'name': '光威复材'}, {'code': '300696', 'name': '爱乐达'}, {'code': '300687', 'name': '赛意信息'}, {'code': '300685', 'name': '艾德生物'}, {'code': '300682', 'name': '朗新科技'}, {'code': '300680', 'name': '隆盛科技'}, {'code': '300679', 'name': '电连技术'}, {'code': '300677', 'name': '英科医疗'}, {'code': '300676', 'name': '华大基因'}, {'code': '300674', 'name': '宇信科技'}, {'code': '300673', 'name': '佩蒂股份'}, {'code': '300671', 'name': '富满电子'}, {'code': '300666', 'name': '江丰电子'}, {'code': '300662', 'name': '科锐国际'}, {'code': '300661', 'name': '圣邦股份'}, {'code': '300659', 'name': '中孚信息'}, {'code': '300657', 'name': '弘信电子'}, {'code': '300653', 'name': '正海生物'}, {'code': '300651', 'name': '金陵体育'}, {'code': '300639', 'name': '凯普生物'}, {'code': '300638', 'name': '广和通'}, {'code': '300636', 'name': '同和药业'}, {'code': '300633', 'name': '开立医疗'}, {'code': '300630', 'name': '普利制药'}, {'code': '300628', 'name': '亿联网络'}, {'code': '300627', 'name': '华测导航'}, {'code': '300624', 'name': '万兴科技'}, {'code': '300623', 'name': '捷捷微电'}, {'code': '300618', 'name': '寒锐钴业'}, {'code': '300616', 'name': '尚品宅配'}, {'code': '300613', 'name': '富瀚微'}, {'code': '300601', 'name': '康泰生物'}, {'code': '300596', 'name': '利安隆'}, {'code': '300595', 'name': '欧普康视'}, {'code': '300593', 'name': '新雷能'}, {'code': '300587', 'name': '天铁股份'}, {'code': '300582', 'name': '英飞特'}, {'code': '300577', 'name': '开润股份'}, {'code': '300575', 'name': '中旗股份'}, {'code': '300573', 'name': '兴齐眼药'}, {'code': '300572', 'name': '安车检测'}, {'code': '300570', 'name': '太辰光'}, {'code': '300568', 'name': '星源材质'}, {'code': '300567', 'name': '精测电子'}, {'code': '300566', 'name': '激智科技'}, {'code': '300562', 'name': '乐心医疗'}, {'code': '300558', 'name': '贝达药业'}, {'code': '300529', 'name': '健帆生物'}, {'code': '300525', 'name': '博思软件'}, {'code': '300515', 'name': '三德科技'}, {'code': '300511', 'name': '雪榕生物'}, {'code': '300502', 'name': '新易盛'}, {'code': '300498', 'name': '温氏股份'}, {'code': '300496', 'name': '中科创达'}, {'code': '300487', 'name': '蓝晓科技'}, {'code': '300482', 'name': '万孚生物'}, {'code': '300481', 'name': '濮阳惠成'}, {'code': '300476', 'name': '胜宏科技'}, {'code': '300474', 'name': '景嘉微'}, {'code': '300470', 'name': '中密控股'}, {'code': '300463', 'name': '迈克生物'}, {'code': '300458', 'name': '全志科技'}, {'code': '300457', 'name': '赢合科技'}, {'code': '300454', 'name': '深信服'}, {'code': '300452', 'name': '山河药辅'}, {'code': '300451', 'name': '创业慧康'}, {'code': '300450', 'name': '先导智能'}, {'code': '300443', 'name': '金雷股份'}, {'code': '300439', 'name': '美康生物'}, {'code': '300438', 'name': '鹏辉能源'}, {'code': '300433', 'name': '蓝思科技'}, {'code': '300421', 'name': '力星股份'}, {'code': '300418', 'name': '昆仑万维'}, {'code': '300416', 'name': '苏试试验'}, {'code': '300415', 'name': '伊之密'}, {'code': '300413', 'name': '芒果超媒'}, {'code': '300408', 'name': '三环集团'}, {'code': '300406', 'name': '九强生物'}, {'code': '300401', 'name': '花园生物'}, {'code': '300395', 'name': '菲利华'}, {'code': '300394', 'name': '天孚通信'}, {'code': '300390', 'name': '天华超净'}, {'code': '300384', 'name': '三联虹普'}, {'code': '300383', 'name': '光环新网'}, {'code': '300382', 'name': '斯莱克'}, {'code': '300381', 'name': '溢多利'}, {'code': '300379', 'name': '东方通'}, {'code': '300378', 'name': '鼎捷软件'}, {'code': '300374', 'name': '中铁装配'}, {'code': '300373', 'name': '扬杰科技'}, {'code': '300369', 'name': '绿盟科技'}, {'code': '300363', 'name': '博腾股份'}, {'code': '300357', 'name': '我武生物'}, {'code': '300348', 'name': '长亮科技'}, {'code': '300347', 'name': '泰格医药'}, {'code': '300327', 'name': '中颖电子'}, {'code': '300316', 'name': '晶盛机电'}, {'code': '300308', 'name': '中际旭创'}, {'code': '300298', 'name': '三诺生物'}, {'code': '300294', 'name': '博雅生物'}, {'code': '300285', 'name': '国瓷材料'}, {'code': '300280', 'name': '紫天科技'}, {'code': '300274', 'name': '阳光电源'}, {'code': '300271', 'name': '华宇软件'}, {'code': '300258', 'name': '精锻科技'}, {'code': '300257', 'name': '开山股份'}, {'code': '300254', 'name': '仟源医药'}, {'code': '300253', 'name': '卫宁健康'}, {'code': '300251', 'name': '光线传媒'}, {'code': '300244', 'name': '迪安诊断'}, {'code': '300241', 'name': '瑞丰光电'}, {'code': '300232', 'name': '洲明科技'}, {'code': '300226', 'name': '上海钢联'}, {'code': '300224', 'name': '正海磁材'}, {'code': '300223', 'name': '北京君正'}, {'code': '300219', 'name': '鸿利智汇'}, {'code': '300215', 'name': '电科院'}, {'code': '300212', 'name': '易华录'}, {'code': '300207', 'name': '欣旺达'}, {'code': '300196', 'name': '长海股份'}, {'code': '300188', 'name': '美亚柏科'}, {'code': '300171', 'name': '东富龙'}, {'code': '300168', 'name': '万达信息'}, {'code': '300166', 'name': '东方国信'}, {'code': '300151', 'name': '昌红科技'}, {'code': '300149', 'name': '睿智医药'}, {'code': '300146', 'name': '汤臣倍健'}, {'code': '300144', 'name': '宋城演艺'}, {'code': '300143', 'name': '盈康生命'}, {'code': '300142', 'name': '沃森生物'}, {'code': '300138', 'name': '晨光生物'}, {'code': '300137', 'name': '先河环保'}, {'code': '300136', 'name': '信维通信'}, {'code': '300133', 'name': '华策影视'}, {'code': '300132', 'name': '青松股份'}, {'code': '300124', 'name': '汇川技术'}, {'code': '300123', 'name': '亚光科技'}, {'code': '300122', 'name': '智飞生物'}, {'code': '300121', 'name': '阳谷华泰'}, {'code': '300119', 'name': '瑞普生物'}, {'code': '300118', 'name': '东方日升'}, {'code': '300115', 'name': '长盈精密'}, {'code': '300114', 'name': '中航电测'}, {'code': '300113', 'name': '顺网科技'}, {'code': '300101', 'name': '振芯科技'}, {'code': '300088', 'name': '长信科技'}, {'code': '300087', 'name': '荃银高科'}, {'code': '300083', 'name': '创世纪'}, {'code': '300073', 'name': '当升科技'}, {'code': '300070', 'name': '碧水源'}, {'code': '300059', 'name': '东方财富'}, {'code': '300058', 'name': '蓝色光标'}, {'code': '300054', 'name': '鼎龙股份'}, {'code': '300049', 'name': '福瑞股份'}, {'code': '300037', 'name': '新宙邦'}, {'code': '300036', 'name': '超图软件'}, {'code': '300035', 'name': '中科电气'}, {'code': '300034', 'name': '钢研高纳'}, {'code': '300033', 'name': '同花顺'}, {'code': '300031', 'name': '宝通科技'}, {'code': '300019', 'name': '硅宝科技'}, {'code': '300015', 'name': '爱尔眼科'}, {'code': '300014', 'name': '亿纬锂能'}, {'code': '300012', 'name': '华测检测'}, {'code': '300009', 'name': '安科生物'}, {'code': '300007', 'name': '汉威科技'}, {'code': '300003', 'name': '乐普医疗'}, {'code': '300002', 'name': '神州泰岳'}, {'code': '300001', 'name': '特锐德'}, {'code': '06865', 'name': '福莱特玻璃'}, {'code': '06690', 'name': '海尔智家'}, {'code': '06049', 'name': '保利物业'}, {'code': '03908', 'name': '中金公司'}, {'code': '03898', 'name': '时代电气'}, {'code': '03759', 'name': '康龙化成'}, {'code': '03606', 'name': '福耀玻璃'}, {'code': '02883', 'name': '中海油田服务'}, {'code': '02333', 'name': '长城汽车'}, {'code': '01898', 'name': '中煤能源'}, {'code': '01772', 'name': '赣锋锂业'}, {'code': '01658', 'name': '邮储银行'}, {'code': '01171', 'name': '兖州煤业股份'}, {'code': '01138', 'name': '中远海能'}, {'code': '01055', 'name': '中国南方航空股份'}, {'code': '00981', 'name': '中芯国际'}, {'code': '00956', 'name': '新天绿色能源'}, {'code': '00939', 'name': '建设银行'}, {'code': '00728', 'name': '中国电信'}, {'code': '00670', 'name': '中国东方航空股份'}, {'code': '003816', 'name': '中国广核'}, {'code': '003035', 'name': '南网能源'}, {'code': '003032', 'name': '传智教育'}, {'code': '003031', 'name': '中瓷电子'}, {'code': '003028', 'name': '振邦智能'}, {'code': '003022', 'name': '联泓新科'}, {'code': '003021', 'name': '兆威机电'}, {'code': '003016', 'name': '欣贺股份'}, {'code': '003012', 'name': '东鹏控股'}, {'code': '002991', 'name': '甘源食品'}, {'code': '002989', 'name': '中天精装'}, {'code': '002985', 'name': '北摩高科'}, {'code': '002984', 'name': '森麒麟'}, {'code': '002982', 'name': '湘佳股份'}, {'code': '002970', 'name': '锐明技术'}, {'code': '002968', 'name': '新大正'}, {'code': '002967', 'name': '广电计量'}, {'code': '002966', 'name': '苏州银行'}, {'code': '002960', 'name': '青鸟消防'}, {'code': '002959', 'name': '小熊电器'}, {'code': '002956', 'name': '西麦食品'}, {'code': '002949', 'name': '华阳国际'}, {'code': '002948', 'name': '青岛银行'}, {'code': '002946', 'name': '新乳业'}, {'code': '002945', 'name': '华林证券'}, {'code': '002942', 'name': '新农股份'}, {'code': '002938', 'name': '中银证券健康产业混合'}, {'code': '002938', 'name': '鹏鼎控股'}, {'code': '002930', 'name': '宏川智慧'}, {'code': '002928', 'name': '华夏航空'}, {'code': '002926', 'name': '华西证券'}, {'code': '002925', 'name': '盈趣科技'}, {'code': '002922', 'name': '伊戈尔'}, {'code': '002920', 'name': '德赛西威'}, {'code': '002918', 'name': '蒙娜丽莎'}, {'code': '002916', 'name': '深南电路'}, {'code': '002912', 'name': '中新赛克'}, {'code': '002906', 'name': '华阳集团'}, {'code': '002895', 'name': '川恒股份'}, {'code': '002891', 'name': '中宠股份'}, {'code': '002886', 'name': '沃特股份'}, {'code': '002884', 'name': '凌霄泵业'}, {'code': '002879', 'name': '长缆科技'}, {'code': '002876', 'name': '三利谱'}, {'code': '002867', 'name': '周大生'}, {'code': '002859', 'name': '洁美科技'}, {'code': '002853', 'name': '皮阿诺'}, {'code': '002851', 'name': '麦格米特'}, {'code': '002850', 'name': '科达利'}, {'code': '002847', 'name': '盐津铺子'}, {'code': '002841', 'name': '视源股份'}, {'code': '002839', 'name': '张家港行'}, {'code': '002837', 'name': '英维克'}, {'code': '002833', 'name': '弘亚数控'}, {'code': '002832', 'name': '比音勒芬'}, {'code': '002831', 'name': '裕同科技'}, {'code': '002824', 'name': '和胜股份'}, {'code': '002823', 'name': '凯中精密'}, {'code': '002821', 'name': '凯莱英'}, {'code': '002812', 'name': '恩捷股份'}, {'code': '002810', 'name': '山东赫达'}, {'code': '002797', 'name': '第一创业'}, {'code': '002791', 'name': '坚朗五金'}, {'code': '002787', 'name': '华源控股'}, {'code': '002777', 'name': '久远银海'}, {'code': '002773', 'name': '康弘药业'}, {'code': '002768', 'name': '国恩股份'}, {'code': '002759', 'name': '天际股份'}, {'code': '002756', 'name': '永兴材料'}, {'code': '002749', 'name': '国光股份'}, {'code': '002747', 'name': '埃斯顿'}, {'code': '002745', 'name': '木林森'}, {'code': '002739', 'name': '万达电影'}, {'code': '002737', 'name': '葵花药业'}, {'code': '002736', 'name': '国信证券'}, {'code': '002734', 'name': '利民股份'}, {'code': '002727', 'name': '一心堂'}, {'code': '002726', 'name': '龙大肉食'}, {'code': '002724', 'name': '海洋王'}, {'code': '002714', 'name': '牧原股份'}, {'code': '002713', 'name': '东易日盛'}, {'code': '002709', 'name': '天赐材料'}, {'code': '002707', 'name': '众信旅游'}, {'code': '002706', 'name': '良信股份'}, {'code': '002705', 'name': '新宝股份'}, {'code': '002701', 'name': '奥瑞金'}, {'code': '002698', 'name': '博实股份'}, {'code': '002697', 'name': '红旗连锁'}, {'code': '002695', 'name': '煌上煌'}, {'code': '002677', 'name': '浙江美大'}, {'code': '002675', 'name': '东诚药业'}, {'code': '002673', 'name': '西部证券'}, {'code': '002670', 'name': '国盛金控'}, {'code': '002653', 'name': '海思科'}, {'code': '002651', 'name': '利君股份'}, {'code': '002648', 'name': '卫星石化'}, {'code': '002645', 'name': '华宏科技'}, {'code': '002643', 'name': '万润股份'}, {'code': '002637', 'name': '赞宇科技'}, {'code': '002636', 'name': '金安国纪'}, {'code': '002624', 'name': '完美世界'}, {'code': '002623', 'name': '亚玛顿'}, {'code': '002614', 'name': '奥佳华'}, {'code': '002612', 'name': '朗姿股份'}, {'code': '002610', 'name': '爱康科技'}, {'code': '002609', 'name': '捷顺科技'}, {'code': '002607', 'name': '中公教育'}, {'code': '002603', 'name': '以岭药业'}, {'code': '002601', 'name': '中银证券价值精选灵活配置混合'}, {'code': '002601', 'name': '龙佰集团'}, {'code': '002600', 'name': '领益智造'}, {'code': '002599', 'name': '盛通股份'}, {'code': '002597', 'name': '金禾实业'}, {'code': '002595', 'name': '豪迈科技'}, {'code': '002594', 'name': '比亚迪'}, {'code': '002585', 'name': '双星新材'}, {'code': '002572', 'name': '索菲亚'}, {'code': '002568', 'name': '百润股份'}, {'code': '002563', 'name': '森马服饰'}, {'code': '002562', 'name': '兄弟科技'}, {'code': '002558', 'name': '巨人网络'}, {'code': '002557', 'name': '洽洽食品'}, {'code': '002555', 'name': '三七互娱'}, {'code': '002541', 'name': '鸿路钢构'}, {'code': '002539', 'name': '云图控股'}, {'code': '002534', 'name': '杭锅股份'}, {'code': '002532', 'name': '天山铝业'}, {'code': '002531', 'name': '天顺风能'}, {'code': '002511', 'name': '中顺洁柔'}, {'code': '002508', 'name': '老板电器'}, {'code': '002507', 'name': '涪陵榨菜'}, {'code': '002497', 'name': '雅化集团'}, {'code': '002493', 'name': '荣盛石化'}, {'code': '002484', 'name': '江海股份'}, {'code': '002481', 'name': '双塔食品'}, {'code': '002475', 'name': '中邮睿利增强债券'}, {'code': '002475', 'name': '立讯精密'}, {'code': '002472', 'name': '双环传动'}, {'code': '002466', 'name': '天齐锂业'}, {'code': '002465', 'name': '海格通信'}, {'code': '002463', 'name': '沪电股份'}, {'code': '002461', 'name': '珠江啤酒'}, {'code': '002460', 'name': '赣锋锂业'}, {'code': '002459', 'name': '晶澳科技'}, {'code': '002444', 'name': '巨星科技'}, {'code': '002439', 'name': '启明星辰'}, {'code': '002438', 'name': '江苏神通'}, {'code': '002430', 'name': '杭氧股份'}, {'code': '002422', 'name': '科伦药业'}, {'code': '002419', 'name': '天虹股份'}, {'code': '002415', 'name': '海康威视'}, {'code': '002414', 'name': '高德红外'}, {'code': '002413', 'name': '雷科防务'}, {'code': '002410', 'name': '广联达'}, {'code': '002409', 'name': '雅克科技'}, {'code': '002408', 'name': '齐翔腾达'}, {'code': '002407', 'name': '多氟多'}, {'code': '002405', 'name': '四维图新'}, {'code': '002402', 'name': '和而泰'}, {'code': '002398', 'name': '垒知集团'}, {'code': '002396', 'name': '星网锐捷'}, {'code': '002390', 'name': '信邦制药'}, {'code': '002389', 'name': '航天彩虹'}, {'code': '002385', 'name': '大北农'}, {'code': '002384', 'name': '东山精密'}, {'code': '002382', 'name': '蓝帆医疗'}, {'code': '002381', 'name': '双箭股份'}, {'code': '002376', 'name': '新北洋'}, {'code': '002375', 'name': '亚厦股份'}, {'code': '002373', 'name': '千方科技'}, {'code': '002372', 'name': '伟星新材'}, {'code': '002371', 'name': '北方华创'}, {'code': '002367', 'name': '康力电梯'}, {'code': '002353', 'name': '杰瑞股份'}, {'code': '002352', 'name': '顺丰控股'}, {'code': '002343', 'name': '慈文传媒'}, {'code': '002340', 'name': '格林美'}, {'code': '002335', 'name': '科华数据'}, {'code': '002332', 'name': '仙琚制药'}, {'code': '002327', 'name': '富安娜'}, {'code': '002324', 'name': '普利特'}, {'code': '002318', 'name': '久立特材'}, {'code': '002315', 'name': '焦点科技'}, {'code': '002311', 'name': '海大集团'}, {'code': '002304', 'name': '洋河股份'}, {'code': '002301', 'name': '齐心集团'}, {'code': '002299', 'name': '圣农发展'}, {'code': '002294', 'name': '信立泰'}, {'code': '002291', 'name': '星期六'}, {'code': '002281', 'name': '光迅科技'}, {'code': '002273', 'name': '水晶光电'}, {'code': '002271', 'name': '东方雨虹'}, {'code': '002268', 'name': '卫士通'}, {'code': '002266', 'name': '浙富控股'}, {'code': '002258', 'name': '利尔化学'}, {'code': '002254', 'name': '泰和新材'}, {'code': '002252', 'name': '上海莱士'}, {'code': '002250', 'name': '联化科技'}, {'code': '002245', 'name': '蔚蓝锂芯'}, {'code': '002244', 'name': '滨江集团'}, {'code': '002242', 'name': '九阳股份'}, {'code': '002241', 'name': '歌尔股份'}, {'code': '002240', 'name': '盛新锂能'}, {'code': '002238', 'name': '天威视讯'}, {'code': '002237', 'name': '恒邦股份'}, {'code': '002236', 'name': '大华股份'}, {'code': '002233', 'name': '塔牌集团'}, {'code': '002230', 'name': '科大讯飞'}, {'code': '002223', 'name': '中邮尊享一年定开混合发起式'}, {'code': '002223', 'name': '鱼跃医疗'}, {'code': '002221', 'name': '东华能源'}, {'code': '002214', 'name': '大立科技'}, {'code': '002213', 'name': '大为股份'}, {'code': '002212', 'name': '天融信'}, {'code': '002206', 'name': '海利得'}, {'code': '002202', 'name': '金风科技'}, {'code': '002196', 'name': '方正电机'}, {'code': '002192', 'name': '融捷股份'}, {'code': '002185', 'name': '华天科技'}, {'code': '002182', 'name': '云海金属'}, {'code': '002180', 'name': '纳思达'}, {'code': '002179', 'name': '中航光电'}, {'code': '002174', 'name': '游族网络'}, {'code': '002163', 'name': '海南发展'}, {'code': '002159', 'name': '三特索道'}, {'code': '002158', 'name': '汉钟精机'}, {'code': '002157', 'name': '正邦科技'}, {'code': '002156', 'name': '通富微电'}, {'code': '002155', 'name': '湖南黄金'}, {'code': '002153', 'name': '石基信息'}, {'code': '002149', 'name': '西部材料'}, {'code': '002146', 'name': '荣盛发展'}, {'code': '002145', 'name': '中核钛白'}, {'code': '002142', 'name': '宁波银行'}, {'code': '002139', 'name': '拓邦股份'}, {'code': '002138', 'name': '顺络电子'}, {'code': '002131', 'name': '利欧股份'}, {'code': '002129', 'name': '中环股份'}, {'code': '002128', 'name': '露天煤业'}, {'code': '002127', 'name': '南极电商'}, {'code': '002126', 'name': '银轮股份'}, {'code': '002124', 'name': '天邦股份'}, {'code': '002123', 'name': '梦网科技'}, {'code': '002120', 'name': '韵达股份'}, {'code': '002111', 'name': '威海广泰'}, {'code': '002110', 'name': '三钢闽光'}, {'code': '002105', 'name': '信隆健康'}, {'code': '002092', 'name': '中泰化学'}, {'code': '002088', 'name': '鲁阳节能'}, {'code': '002081', 'name': '金螳螂'}, {'code': '002080', 'name': '中材科技'}, {'code': '002078', 'name': '太阳纸业'}, {'code': '002074', 'name': '国轩高科'}, {'code': '002064', 'name': '华峰化学'}, {'code': '002056', 'name': '横店东磁'}, {'code': '002050', 'name': '三花智控'}, {'code': '002049', 'name': '紫光国微'}, {'code': '002048', 'name': '宁波华翔'}, {'code': '002044', 'name': '美年健康'}, {'code': '002043', 'name': '兔宝宝'}, {'code': '002041', 'name': '登海种业'}, {'code': '002036', 'name': '联创电子'}, {'code': '002035', 'name': '华帝股份'}, {'code': '002034', 'name': '旺能环境'}, {'code': '002032', 'name': '苏泊尔'}, {'code': '002030', 'name': '达安基因'}, {'code': '002028', 'name': '思源电气'}, {'code': '002027', 'name': '分众传媒'}, {'code': '002026', 'name': '山东威达'}, {'code': '002025', 'name': '航天电器'}, {'code': '002019', 'name': '亿帆医药'}, {'code': '002013', 'name': '中航机电'}, {'code': '002008', 'name': '大族激光'}, {'code': '002007', 'name': '华兰生物'}, {'code': '002001', 'name': '新和成'}, {'code': '001979', 'name': '招商蛇口'}, {'code': '001914', 'name': '招商积余'}, {'code': '00168', 'name': '青岛啤酒股份'}, {'code': '000998', 'name': '隆平高科'}, {'code': '000988', 'name': '华工科技'}, {'code': '000983', 'name': '山西焦煤'}, {'code': '000977', 'name': '浪潮信息'}, {'code': '000975', 'name': '银泰黄金'}, {'code': '000963', 'name': '华东医药'}, {'code': '000961', 'name': '中南建设'}, {'code': '000960', 'name': '锡业股份'}, {'code': '000959', 'name': '首钢股份'}, {'code': '000951', 'name': '中国重汽'}, {'code': '000938', 'name': '紫光股份'}, {'code': '000933', 'name': '神火股份'}, {'code': '000932', 'name': '华菱钢铁'}, {'code': '000930', 'name': '中粮科技'}, {'code': '000923', 'name': '中邮现金驿站货币C'}, {'code': '000923', 'name': '河钢资源'}, {'code': '000921', 'name': '中邮现金驿站货币A'}, {'code': '000921', 'name': '海信家电'}, {'code': '000915', 'name': '华特达因'}, {'code': '000913', 'name': '钱江摩托'}, {'code': '000910', 'name': '大亚圣象'}, {'code': '000902', 'name': '新洋丰'}, {'code': '000898', 'name': '鞍钢股份'}, {'code': '000895', 'name': '双汇发展'}, {'code': '000893', 'name': '亚钾国际'}, {'code': '000887', 'name': '中鼎股份'}, {'code': '000860', 'name': '顺鑫农业'}, {'code': '000858', 'name': '五粮液'}, {'code': '000848', 'name': '承德露露'}, {'code': '000830', 'name': '鲁西化工'}, {'code': '000825', 'name': '太钢不锈'}, {'code': '000807', 'name': '云铝股份'}, {'code': '000800', 'name': '一汽解放'}, {'code': '000799', 'name': '酒鬼酒'}, {'code': '000786', 'name': '北新建材'}, {'code': '000785', 'name': '居然之家'}, {'code': '000783', 'name': '长江证券'}, {'code': '000778', 'name': '新兴铸管'}, {'code': '000776', 'name': '广发证券'}, {'code': '000768', 'name': '中航西飞'}, {'code': '000739', 'name': '普洛药业'}, {'code': '000738', 'name': '航发控制'}, {'code': '000733', 'name': '振华科技'}, {'code': '000729', 'name': '燕京啤酒'}, {'code': '000728', 'name': '国元证券'}, {'code': '000726', 'name': '鲁泰A'}, {'code': '000725', 'name': '京东方A'}, {'code': '000718', 'name': '苏宁环球'}, {'code': '000710', 'name': '贝瑞基因'}, {'code': '000708', 'name': '中信特钢'}, {'code': '000703', 'name': '恒逸石化'}, {'code': '000683', 'name': '远兴能源'}, {'code': '000681', 'name': '视觉中国'}, {'code': '000672', 'name': '上峰水泥'}, {'code': '000671', 'name': '阳光城'}, {'code': '000661', 'name': '长春高新'}, {'code': '000657', 'name': '中钨高新'}, {'code': '000656', 'name': '金科股份'}, {'code': '000651', 'name': '格力电器'}, {'code': '000650', 'name': '仁和药业'}, {'code': '000636', 'name': '风华高科'}, {'code': '000625', 'name': '长安汽车'}, {'code': '000615', 'name': '奥园美谷'}, {'code': '000603', 'name': '盛达资源'}, {'code': '000598', 'name': '兴蓉环境'}, {'code': '000596', 'name': '古井贡酒'}, {'code': '000591', 'name': '太阳能'}, {'code': '000582', 'name': '北部湾港'}, {'code': '000581', 'name': '威孚高科'}, {'code': '000576', 'name': '中邮货币A'}, {'code': '000576', 'name': '甘化科工'}, {'code': '000568', 'name': '泸州老窖'}, {'code': '000560', 'name': '我爱我家'}, {'code': '000550', 'name': '江铃汽车'}, {'code': '000547', 'name': '航天发展'}, {'code': '000538', 'name': '云南白药'}, {'code': '000528', 'name': '柳工'}, {'code': '000526', 'name': '学大教育'}, {'code': '000519', 'name': '中兵红箭'}, {'code': '000516', 'name': '国际医学'}, {'code': '000513', 'name': '丽珠集团'}, {'code': '000501', 'name': '鄂武商A'}, {'code': '000498', 'name': '山东路桥'}, {'code': '000488', 'name': '晨鸣纸业'}, {'code': '000429', 'name': '粤高速A'}, {'code': '000425', 'name': '徐工机械'}, {'code': '000423', 'name': '东阿阿胶'}, {'code': '000403', 'name': '派林生物'}, {'code': '000402', 'name': '金融街'}, {'code': '000401', 'name': '冀东水泥'}, {'code': '000338', 'name': '潍柴动力'}, {'code': '000333', 'name': '美的集团'}, {'code': '000301', 'name': '东方盛虹'}, {'code': '000166', 'name': '申万宏源'}, {'code': '000157', 'name': '中联重科'}, {'code': '000100', 'name': 'TCL科技'}, {'code': '000069', 'name': '华侨城A'}, {'code': '000066', 'name': '中国长城'}, {'code': '000063', 'name': '中兴通讯'}, {'code': '000050', 'name': '深天马A'}, {'code': '000049', 'name': '德赛电池'}, {'code': '000039', 'name': '中集集团'}, {'code': '000036', 'name': '华联控股'}, {'code': '000030', 'name': '富奥股份'}, {'code': '000028', 'name': '国药一致'}, {'code': '000026', 'name': '飞亚达'}, {'code': '000021', 'name': '深科技'}, {'code': '000012', 'name': '南玻A'}, {'code': '000009', 'name': '中国宝安'}, {'code': '000002', 'name': '万科A'}, {'code': '000001', 'name': '平安银行'}]
    logging.warning("查询基金持股数据")
    pool = []
    data = ts.fund_holdings(year=year, quarter=quarter)
    for i in data.values:
        code = i[7]
        name = i[3]
        fundHoldingdRatio = float(i[6])
        if fundHoldingdRatio >= 2:
            pool.append({'code': code, 'name': name})
    logging.warning(f"基金持股占比大于2%个股数量:{len(pool)}")
    return pool


def get_industry_momentum():
    df = pd.read_csv(f"RPS{rps_day}.csv", encoding='utf-8')
    fund_pool = get_fund_holdings(quarter=2)
    result = {}
    for i in range(4, len(df.columns)):
        all_data = []
        high_data = []
        for j in df.values:
            all_data.append(j[2])
            if j[i] >= 87 and j[3] < int(str(date.today() - timedelta(days=180)).replace('-', '')) \
                    and {'code': j[0].replace('.SH', '').replace('.SZ', ''), 'name': j[1]} in fund_pool:
                high_data.append(j[2])
        all_data_count = {}
        high_data_count = {}
        for j in all_data:
            all_data_count[j] = all_data.count(j)
        for j in high_data:
            high_data_count[j] = high_data.count(j)
        momentum = []
        for j in all_data_count.keys():
            if j in high_data_count.keys():
                tmp = {'industry': j,
                       'rank_count': high_data_count[j],
                       'member_count': all_data_count[j],
                       'momentum_score': round(high_data_count[j] * high_data_count[j] / all_data_count[j], 2)}
                momentum.append(tmp)
        result[df.columns[i]] = sorted(momentum, key=lambda x: x['momentum_score'], reverse=True)
    return result


def run():
    filename = "简放-动量模型.csv"
    if filename in os.listdir(os.curdir):
        os.remove(filename)
    create_RPS_file()
    data = get_industry_momentum()
    df = pd.DataFrame()
    for k, v in data.items():
        for i in v:
            df.loc[i['industry'], k] = i['momentum_score']
    df.to_csv(filename, encoding='utf-8')
    get_momentum_rank_top()


def momentum_stock_filter(industry, fund_holding):
    pool = []
    fund_holding = [i['code'] for i in fund_holding]
    df = pd.read_csv(f'RPS{rps_day}.csv', encoding='utf-8')
    for i in df.values:
        if i[2] == industry and i[-1] > 87 and i[0].split('.')[0] in fund_holding:
            pool.append({'code': i[0], 'name': i[1]})
    return pool


def get_momentum_rank_top(filename="简放-动量模型.csv"):
    industry_list = []
    fund_holding = get_fund_holdings(quarter=2)
    df = pd.read_csv(filename, encoding='utf-8')
    for i in df.values:
        if i[-1] > 1:
            industry_pool = momentum_stock_filter(industry=i[0], fund_holding=fund_holding)
            industry_list.append({'industry': i[0], df.columns[-5]: i[-5], df.columns[-4]: i[-4], df.columns[-3]: i[-3], df.columns[-2]: i[-2], df.columns[-1]: i[-1], 'industry_pool': industry_pool})
    industry_list = sorted(industry_list, key=lambda x: x[df.columns[-1]], reverse=True)
    for i in industry_list:
        print(i)


if __name__ == '__main__':
    run()

